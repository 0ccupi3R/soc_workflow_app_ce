{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"jlbKm2YByorp5hYiX_zv","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.278058","user_id":null,"author":"Florian Roth","title":"Malicious Service Install","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malicious Service Install","released":"2018-10-22T12:40:23.278056","sigma_text":"title: Malicious Service Install\ndescription: This method detects well-known keywords of malicious services in the Windows System Eventlog \nauthor: Florian Roth\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: \n          - 7045\n          - 4697\n    keywords:\n      - 'WCE SERVICE'\n      - 'WCESERVICE'\n      - 'DumpSvc'\n    quarkspwdump:\n        EventID: 16\n        HiveName: '*\\AppData\\Local\\Temp\\SAM*.dmp'\n    condition: ( selection and keywords ) or quarkspwdump\nfalsepositives:\n    - Unlikely\nlevel: high\n","git_filepath":"/windows/builtin/win_mal_creddumper.yml","hash":"54c45e10cf8e03adc836ca99056142f1cf88d9070c24c8c0f7b6f8ca9fa6f706","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"llbKm2YByorp5hYiYPyu","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.469066","user_id":null,"author":"Florian Roth","title":"Security Eventlog Cleared","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Security Eventlog Cleared","released":"2018-10-22T12:40:23.469063","sigma_text":"title: Security Eventlog Cleared\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 517\n            - 1102\n    condition: selection\nfalsepositives:\n    - Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\n    - System provisioning (system reset before the golden image creation)\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_security_eventlog_cleared.yml","hash":"ef3a8c2a9974411cf32105f9f478c53cf1db0d236ad970c1e88203fe8e609185","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"mVbKm2YByorp5hYiYPzf","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.518413","user_id":null,"author":"Florian Roth","title":"USB Device Plugged","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"USB Device Plugged","released":"2018-10-22T12:40:23.518410","sigma_text":"title: USB Device Plugged\ndescription: Detects plugged USB devices\nreferences:\n    - https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/\n    - https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: driver-framework\ndetection:\n    selection:\n        EventID: \n            - 2003  # Loading drivers\n            - 2100  # Pnp or power management\n            - 2102  # Pnp or power management\n    condition: selection\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n","git_filepath":"/windows/builtin/win_usb_device_plugged.yml","hash":"653b702c699ae891d48bbb1faedf458d7a7c94e7df71e4a5aba4ad90d42f28fc","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"mlbKm2YByorp5hYiYPzy","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.537312","user_id":null,"author":"@neu5ron","title":"Weak Encryption Enabled and Kerberoast","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Weak Encryption Enabled and Kerberoast","released":"2018-10-22T12:40:23.537309","sigma_text":"title: Weak Encryption Enabled and Kerberoast\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\nreferences:\n    - https://adsecurity.org/?p=2053\n    - https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\ndetection:\n    selection:\n        EventID: 4738\n    keywords:\n        - 'DES'\n        - 'Preauth'\n        - 'Encrypted'\n    filters:\n        - 'Enabled'\n    condition: selection and keywords and filters\nfalsepositives: \n    - Unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_alert_enable_weak_encryption.yml","hash":"1521c23a2b8bba15fd02009bac26b77bbf4c67c9a70a121ac47536dcb911ba44","author_keyword":"@neu5ron","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"plbKm2YByorp5hYiYfyW","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.700755","user_id":null,"author":"Florian Roth","title":"Interactive Logon to Server Systems","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Interactive Logon to Server Systems","released":"2018-10-22T12:40:23.700753","sigma_text":"title: Interactive Logon to Server Systems\ndescription: Detects interactive console logons to \nauthor: Florian Roth\ntags:\n    - attack.lateral_movement\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 528\n            - 529\n            - 4624\n            - 4625\n        LogonType: 2\n        ComputerName:\n            - '%ServerSystems%'\n            - '%DomainControllers%'\n    filter:\n        LogonProcessName: Advapi\n        ComputerName: '%Workstations%'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative activity via KVM or ILO board\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_interactive_logons.yml","hash":"da71c630a2b0384fe360f55e2624e6f8df3ca3a771cfcf671b7c4a25eb66b605","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"qFbKm2YByorp5hYiYfyv","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.726224","user_id":null,"author":"Florian Roth","title":"Mimikatz Use","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Mimikatz Use","released":"2018-10-22T12:40:23.726221","sigma_text":"title: Mimikatz Use\ndescription: This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)\nauthor: Florian Roth\ntags:\n    - attack.s0002\n    - attack.t1003\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\ndetection:\n    keywords:\n        - mimikatz\n        - mimilib\n        - <3 eo.oe\n        - eo.oe.kiwi\n        - privilege::debug\n        - sekurlsa::logonpasswords\n        - lsadump::sam\n        - mimidrv.sys\n    condition: keywords\nfalsepositives:\n    - Naughty administrators\n    - Penetration test\nlevel: critical\n","git_filepath":"/windows/builtin/win_alert_mimikatz_keywords.yml","hash":"af94f8988035249cc83f40a814b209640de12d1c2c0759e0c2356c3bc4620b2b","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"rVbKm2YByorp5hYiYfz_","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.805767","user_id":null,"author":"Florian Roth","title":"DNS Server Error Failed Loading the ServerLevelPluginDLL","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"DNS Server Error Failed Loading the ServerLevelPluginDLL","released":"2018-10-22T12:40:23.805764","sigma_text":"title: DNS Server Error Failed Loading the ServerLevelPluginDLL\ndescription: This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded\nstatus: experimental\ndate: 2017/05/08\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\n    - https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx\n    - https://twitter.com/gentilkiwi/status/861641945944391680\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: dns-server\ndetection:\n    selection:\n        EventID: \n            - 150\n            - 770\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n","git_filepath":"/windows/builtin/win_susp_dns_config.yml","hash":"a4091bf811822c08eb7cb1d8501d9bd95c8001bc63f0c6528de69a56674c891c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"sVbKm2YByorp5hYiYvxk","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.906542","user_id":null,"author":"Omer Faruk Celik","title":"smbexec.py Service Installation","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"smbexec.py Service Installation","released":"2018-10-22T12:40:23.906540","sigma_text":"title: smbexec.py Service Installation\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\nauthor: Omer Faruk Celik\ndate: 2018/03/20\nreferences:\n    - https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\ntags:\n    - attack.lateral_movement\n    - attack.execution\n    - attack.t1077\n    - attack.t1035\nlogsource:\n    product: windows\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'BTOBTO'\n        ServiceFileName: '*\\execute.bat'\n    condition: service_installation\nfields:\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: critical","git_filepath":"/windows/builtin/win_hack_smbexec.yml","hash":"5a9bbf953f13644912b92ed7d24270a348d110d1d57a9d32edec53df27316f26","author_keyword":"Omer Faruk Celik","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"slbKm2YByorp5hYiYvyO","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.948653","user_id":null,"author":"Florian Roth","title":"Malicious Service Installations","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Malicious Service Installations","released":"2018-10-22T12:40:23.948651","sigma_text":"title: Malicious Service Installations\ndescription: Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity\nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    malsvc_wce:\n        ServiceName: \n            - 'WCESERVICE'\n            - 'WCE SERVICE'\n    malsvc_paexec:\n        ServiceFileName: '*\\PAExec*'\n    malsvc_winexe:\n        ServiceFileName: 'winexesvc.exe*'\n    malsvc_pwdumpx:\n        ServiceFileName: '*\\DumpSvc.exe'\n    malsvc_wannacry:\n        ServiceName: 'mssecsvc2.0'\n    malsvc_persistence:\n        ServiceFileName: '* net user *'\n    malsvc_others:\n        ServiceName:\n            - 'pwdump*'\n            - 'gsecdump*'\n            - 'cachedump*'\n    condition: selection and 1 of malsvc_*\nfalsepositives: \n    - Penetration testing\nlevel: critical\n","git_filepath":"/windows/builtin/win_mal_service_installs.yml","hash":"c52268a934f23099e89473b37e61cd23b965a6b7ee52a79595a6a706ceabd3e5","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"s1bKm2YByorp5hYiYvye","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.964256","user_id":null,"author":"Florian Roth","title":"PsExec Service Start","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"PsExec Service Start","released":"2018-10-22T12:40:23.964253","sigma_text":"title: PsExec Service Start\ndescription: Detects a PsExec service start\nauthor: Florian Roth\ndate: 2018/03/13\ntags:\n    - attack.execution\n    - attack.t1035\n    - attack.s0029\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\ndetection:\n    selection:\n        EventID: 4688\n        CommandLine: 'C:\\Windows\\PSEXESVC.exe'\n    condition: 1 of them\nfalsepositives:\n    - Administrative activity\nlevel: low","git_filepath":"/windows/builtin/win_psexesvc_start.yml","hash":"5f12080ca6763e7916a080da6560a1980c9b44c93bd6a34fbbbc557d9d7ddc65","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"tlbKm2YByorp5hYiY_wV","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.074273","user_id":null,"author":"Florian Roth","title":"Suspicious PowerShell Download","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious PowerShell Download","released":"2018-10-22T12:40:24.074271","sigma_text":"title: Suspicious PowerShell Download\nstatus: experimental\ndescription: Detects suspicious PowerShell download command\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - 'System.Net.WebClient).DownloadString('\n        - 'system.net.webclient).downloadfile('\n    condition: keywords\nfalsepositives:\n    - PowerShell scripts that download content from the Internet\nlevel: medium\n","git_filepath":"/windows/powershell/powershell_suspicious_download.yml","hash":"fa32265771ee39de58def90b71a1cfba86be272eaca898c7be09737e716a5265","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"t1bKm2YByorp5hYiY_w_","_score":1,"_source":{"status":"experimental","category":null,"updated":"2018-10-22T12:40:24.125205","user_id":null,"author":"Sami Ruohonen","title":"NTFS Alternate Data Stream","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"NTFS Alternate Data Stream","released":"2018-10-22T12:40:24.125203","sigma_text":"title: NTFS Alternate Data Stream\nstatus: experimental\ndescription: Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.\nreferences:\n    - http://www.powertheshell.com/ntfsstreams/\ntags:\n    - attack.defense_evasion\n    - attack.t1096\nauthor: Sami Ruohonen\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keyword1:\n        - \"set-content\"\n    keyword2:\n        - \"-stream\"\n    condition: keyword1 and keyword2\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":null,"hash":"1d93bb7e35f31e051336fcb98fb97372ab8680d3d9f6b407de1dd84cdaec150e","author_keyword":"Sami Ruohonen","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"uFbKm2YByorp5hYiY_xS","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.144109","user_id":null,"author":"Sean Metcalf (source), Florian Roth (rule)","title":"PowerShell called from an Executable Version Mismatch","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"PowerShell called from an Executable Version Mismatch","released":"2018-10-22T12:40:24.144107","sigma_text":"title: PowerShell called from an Executable Version Mismatch\nstatus: experimental\ndescription: Detects PowerShell called from an executable by the version mismatch method\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection1:\n        EventID: 400\n        EngineVersion: \n            - '2.*'\n            - '4.*'\n            - '5.*'\n        HostVersion: '3.*'\n    condition: selection1\nfalsepositives:\n    - Penetration Tests\n    - Unknown\nlevel: high\n","git_filepath":"/windows/powershell/powershell_exe_calling_ps.yml","hash":"9bc7cfd39b409038f7dc13ee1d53c8716af07f1971388c4407ea7eb1d826ef71","author_keyword":"Sean Metcalf (source), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"vFbKm2YByorp5hYiY_yJ","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.200427","user_id":null,"author":"John Lambert (idea), Florian Roth (rule)","title":"PowerShell Credential Prompt","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"PowerShell Credential Prompt","released":"2018-10-22T12:40:24.200424","sigma_text":"title: PowerShell Credential Prompt\nstatus: experimental\ndescription: Detects PowerShell calling a credential prompt\nreferences:\n    - https://twitter.com/JohnLaTwC/status/850381440629981184\n    - https://t.co/ezOTGy1a1G\ntags:\n    - attack.execution\n    - attack.credential_access    \n    - attack.t1086\nauthor: John Lambert (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n    keyword:\n        - 'PromptForCredential'\n    condition: all of them\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/powershell/powershell_prompt_credentials.yml","hash":"4170c1fd3641d6a780f25d396d1e15badc81783f1c87d423bf309b9700f906d2","author_keyword":"John Lambert (idea), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"vVbKm2YByorp5hYiY_yU","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.211594","user_id":null,"author":"Florian Roth (rule)","title":"Suspicious PowerShell Invocations - Generic","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious PowerShell Invocations - Generic","released":"2018-10-22T12:40:24.211592","sigma_text":"title: Suspicious PowerShell Invocations - Generic\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    encoded:\n        - ' -enc '\n        - ' -EncodedCommand '\n    hidden:\n        - ' -w hidden '\n        - ' -window hidden '\n        - ' - windowstyle hidden '\n    noninteractive:\n        - ' -noni '\n        - ' -noninteractive '\n    condition: all of them\nfalsepositives:\n    - Penetration tests\n    - Very special / sneaky PowerShell scripts\nlevel: high\n","git_filepath":"/windows/powershell/powershell_suspicious_invocation_generic.yml","hash":"06dc9959edcbe9a39fe3c5f9042503ee02ed6a1d58fd3622c5b63b1cab005a83","author_keyword":"Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"w1bKm2YByorp5hYiY_zm","_score":1,"_source":{"status":"","category":12,"updated":"2018-10-22T12:40:24.292475","user_id":null,"author":"Florian Roth","title":"Antivirus Exploitation Framework Detection","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Antivirus Exploitation Framework Detection","released":"2018-10-22T12:40:24.292473","sigma_text":"title: Antivirus Exploitation Framework Detection\ndescription: Detects a highly relevant Antivirus alert that reports an exploitation framework\ndate: 2018/09/09\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.execution\n    - attack.t1203\n    - attack.command_and_control\n    - attack.t1219\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - \"*MeteTool*\"\n            - \"*Meterpreter*\"\n            - \"*Metasploit*\"\n            - \"*PowerSploit*\"\n            - \"*CobaltSrike*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/windows/malware/av_exploiting.yml","hash":"4ee68a27a343bb1b83063bc718ddf0d63c993ca1468f5fa4a118cd51520dc2c0","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"xVbKm2YByorp5hYiY_z7","_score":1,"_source":{"status":"experimental","category":13,"updated":"2018-10-22T12:40:24.313788","user_id":null,"author":"Thomas Patzke","title":"PsExec Tool Execution","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"PsExec Tool Execution","released":"2018-10-22T12:40:24.313785","sigma_text":"title: PsExec Tool Execution\nstatus: experimental\ndescription: Detects PsExec service installation and execution events (service and Sysmon)\nauthor: Thomas Patzke\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\ntags:\n    - attack.execution\n    - attack.t1035\n    - attack.s0029\nlogsource:\n    product: windows\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'PSEXESVC'\n        ServiceFileName: '*\\PSEXESVC.exe'\n    service_execution:\n        EventID: 7036\n        ServiceName: 'PSEXESVC'\n    sysmon_processcreation:\n        EventID: 1\n        Image: '*\\PSEXESVC.exe'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - unknown\nlevel: low\n","git_filepath":"/windows/other/win_tool_psexec.yml","hash":"a2a5208865fa23311e38b42145ab57db153c9d0db855917e5f0030bf33603bd4","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"xlbKm2YByorp5hYiZPwF","_score":1,"_source":{"status":"experimental","category":13,"updated":"2018-10-22T12:40:24.323959","user_id":null,"author":"Florian Roth","title":"WMI Persistence","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"WMI Persistence","released":"2018-10-22T12:40:24.323956","sigma_text":"title: WMI Persistence\nstatus: experimental\ndescription: Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)\nauthor: Florian Roth\nreferences:\n    - https://twitter.com/mattifestation/status/899646620148539397\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.t1047\nlogsource:\n    product: windows\n    service: wmi\ndetection:\n    selection:\n        EventID: 5861\n    keywords:\n        - 'ActiveScriptEventConsumer'\n        - 'CommandLineEventConsumer'\n        - 'CommandLineTemplate'\n        - 'Binding EventFilter'\n    selection2:\n        EventID: 5859\n    condition: selection and 1 of keywords or selection2\nfalsepositives:\n    - Unknown (data set is too small; further testing needed)\nlevel: high\n","git_filepath":"/windows/other/win_wmi_persistence.yml","hash":"79ea52826dea19e1ae3642f7da27abc2f1db9b109d37fe0cf1fe0d7ea178e415","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"x1bKm2YByorp5hYiZPwN","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.332414","user_id":null,"author":"Florian Roth","title":"Exploit for CVE-2017-0261","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Exploit for CVE-2017-0261","released":"2018-10-22T12:40:24.332411","sigma_text":"title: Exploit for CVE-2017-0261\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262 \nreferences:\n  - https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\nauthor: Florian Roth\ndate: 2018/02/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\FLTLDR.exe*'\n    condition: selection\nfalsepositives:\n    - Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_exploit_cve_2017_0261.yml","hash":"2c0f1ada2e154cf55cb1a3eb666f4b042e753ed68ac2931b93e3f604f9fe1872","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"ylbKm2YByorp5hYiZPwy","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.368881","user_id":null,"author":"Florian Roth","title":"Taskmgr as LOCAL_SYSTEM","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Taskmgr as LOCAL_SYSTEM","released":"2018-10-22T12:40:24.368879","sigma_text":"title: Taskmgr as LOCAL_SYSTEM\nstatus: experimental\ndescription: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM\nauthor: Florian Roth\ndate: 2018/03/18\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        User: 'NT AUTHORITY\\SYSTEM'\n        Image: '*\\taskmgr.exe'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_taskmgr_localsystem.yml","hash":"6d8c7e9d6f2e460aeae9d81afa6c09647d6b367f401c188b96c48d038d5481ab","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"zFbKm2YByorp5hYiZPxG","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.389100","user_id":null,"author":"Florian Roth, @0xrawsec","title":"Executable in ADS","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Executable in ADS","released":"2018-10-22T12:40:24.389098","sigma_text":"title: Executable in ADS\nstatus: experimental\ndescription: Detects the creation of an ADS data stream that contains an executable (non-empty imphash)\nreferences:\n    - https://twitter.com/0xrawsec/status/1002478725605273600?s=21\ntags:\n    - attack.defense_evasion\n    - attack.t1027\n    - attack.s0139\nauthor: Florian Roth, @0xrawsec\ndate: 2018/06/03\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Requirements: Sysmon config with Imphash logging activated'\ndetection:\n    selection:\n        EventID: 15\n    filter:\n        Imphash: '00000000000000000000000000000000'\n    condition: selection and not filter\nfields:\n    - TargetFilename\n    - Image\nfalsepositives:\n    - unknown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_ads_executable.yml","hash":"88468273b93323bcb2a608684d588eec659607882bddcf4dbf16164215a6f7f0","author_keyword":"Florian Roth, @0xrawsec","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"z1bKm2YByorp5hYiZPxs","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.427189","user_id":null,"author":"Nik Seetharaman","title":"Microsoft Workflow Compiler","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Workflow Compiler","released":"2018-10-22T12:40:24.427186","sigma_text":"title: Microsoft Workflow Compiler\nstatus: experimental\ndescription: Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.\ntags:\n    - attack.defense_evasion\n    - attack.execution\nauthor: Nik Seetharaman\nreferences:\n    - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # Description contains MWC even if file has been renamed.\n    selection:\n        EventID: 1\n        Image: '*\\Microsoft.Workflow.Compiler.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate MWC use (unlikely in modern enterprise environments)\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_workflow_compiler.yml","hash":"bfd23f1775f49cd064ebd53e3cbfccc84a0e00710140a29dee09ae41d75f734c","author_keyword":"Nik Seetharaman","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"0lbKm2YByorp5hYiZPys","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.491217","user_id":null,"author":"Florian Roth","title":"Droppers exploiting CVE-2017-11882","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Droppers exploiting CVE-2017-11882","released":"2018-10-22T12:40:24.491214","sigma_text":"title: Droppers exploiting CVE-2017-11882\nstatus: experimental\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe\nreferences:\n    - https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\n    - https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\nauthor: Florian Roth\ndate: 2017/11/23\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\EQNEDT32.EXE'\n    condition: selection\nfields:\n    - CommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_exploit_cve_2017_11882.yml","hash":"6f81291f4cde9cc66f52c38e3cf7579ed5466dc7f29ff0d87b7f423ebd72b503","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"31bKm2YByorp5hYiZfzy","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.816780","user_id":null,"author":"Michael Haag, Florian Roth","title":"Suspicious WMI execution","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious WMI execution","released":"2018-10-22T12:40:24.816777","sigma_text":"title: Suspicious WMI execution\nstatus: experimental\ndescription: Detects WMI executing suspicious commands\nreferences:\n    - https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/\n    - https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1\n    - https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/\nauthor: Michael Haag, Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - '*/NODE:*process call create *'\n            - '* path AntiVirusProduct get *'\n            - '* path FirewallProduct get *'\n            - '* shadowcopy delete *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.execution\n    - attack.t1047\nfalsepositives:\n    - Will need to be tuned\n    - If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine.\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_wmi_execution.yml","hash":"aa94b62fd4df274b5e77b247c50335ddcd8f157f5d84e7973ad8750b8a7bb119","author_keyword":"Michael Haag, Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"41bKm2YByorp5hYiZvw7","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.889794","user_id":null,"author":"Michael Haag","title":"WSF/JSE/JS/VBA/VBE File Execution","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"WSF/JSE/JS/VBA/VBE File Execution","released":"2018-10-22T12:40:24.889790","sigma_text":"title: WSF/JSE/JS/VBA/VBE File Execution\nstatus: experimental\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '*.jse'\n            - '*.vbe'\n            - '*.js'\n            - '*.vba'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_script_execution.yml","hash":"b7760869dfb5db9ff271d0136e769338e253a0560542e09c9f96ed735e97ecf2","author_keyword":"Michael Haag","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"5FbKm2YByorp5hYiZvxI","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.903407","user_id":null,"author":"Markus Neis","title":"Possible Process Hollowing Image Loading","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Possible Process Hollowing Image Loading","released":"2018-10-22T12:40:24.903405","sigma_text":"title: Possible Process Hollowing Image Loading \nstatus: experimental\ndescription: Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz\nreferences:\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html\nauthor: Markus Neis\ndate: 2018/01/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\notepad.exe'\n        ImageLoaded:\n            - '*\\samlib.dll'\n            - '*\\WinSCard.dll'\n    condition: selection\nfalsepositives:\n    - Very likely, needs more tuning\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_image_load.yml","hash":"c025316c39ebeb10e1b30955265fa0b2224c40dee2e1a584947facfb7d768bce","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"51bKm2YByorp5hYiZvxu","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.940849","user_id":null,"author":"Florian Roth","title":"Microsoft Binary Suspicious Communication Endpoint","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Binary Suspicious Communication Endpoint","released":"2018-10-22T12:40:24.940847","sigma_text":"title: Microsoft Binary Suspicious Communication Endpoint\nstatus: experimental\ndescription: Detects an executable in the Windows folder accessing suspicious domains\nreferences:\n    - https://twitter.com/M_haggis/status/900741347035889665\n    - https://twitter.com/M_haggis/status/1032799638213066752\nauthor: Florian Roth\ndate: 2018/08/30\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        DestinationHostname: \n            - '*dl.dropboxusercontent.com'\n            - '*.pastebin.com'\n        Image: 'C:\\Windows\\*'\n    condition: selection\nfalsepositives:\n    - 'Unknown'\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_win_binary_susp_com.yml","hash":"b26ec40d22574be34bac8acfc2b9870146cbbd047440b61df2a41708a202bfd7","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"6lbKm2YByorp5hYiZvzQ","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.038771","user_id":null,"author":"Florian Roth","title":"Windows Shell Spawning Suspicious Program","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Windows Shell Spawning Suspicious Program","released":"2018-10-22T12:40:25.038769","sigma_text":"title: Windows Shell Spawning Suspicious Program\nstatus: experimental\ndescription: Detects a suspicious child process of a Windows shell\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 2018/04/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\mshta.exe'\n            - '*\\powershell.exe'\n            - '*\\cmd.exe'\n            - '*\\rundll32.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\wmiprvse.exe'\n        Image:\n            - '*\\schtasks.exe'\n            - '*\\nslookup.exe'\n            - '*\\certutil.exe'\n            - '*\\bitsadmin.exe'\n            - '*\\mshta.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_shell_spawn_susp_program.yml","hash":"520bb3344b871ce4f30f15072da4d19b3368bcb6a1f9ba17ac9143f56dff3ab2","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"61bKm2YByorp5hYiZvzr","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.066218","user_id":null,"author":"Michael Haag","title":"MSHTA Spawning Windows Shell","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"MSHTA Spawning Windows Shell","released":"2018-10-22T12:40:25.066216","sigma_text":"title: MSHTA Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from MSHTA.\nreferences:\n    - https://www.trustedsec.com/july-2015/malicious-htas/\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mshta.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    filter:\n        CommandLine:\n            - '*/HP/HP*'\n            - '*\\HP\\HP*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1170\nfalsepositives:\n    - Printer software / driver installations\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_mshta_spawn_shell.yml","hash":"3de9c8e1ca83af9cd83af43627f736aacd25b2998edbddc3e945bf9939ef4bc0","author_keyword":"Michael Haag","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"8FbKm2YByorp5hYiZ_wh","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.119385","user_id":null,"author":"Florian Roth, juju4","title":"Suspicious Certutil Command","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Certutil Command","released":"2018-10-22T12:40:25.119383","sigma_text":"title: Suspicious Certutil Command\nstatus: experimental\ndescription: Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility\nauthor: Florian Roth, juju4\nreferences:\n    - https://twitter.com/JohnLaTwC/status/835149808817991680\n    - https://twitter.com/subTee/status/888102593838362624\n    - https://twitter.com/subTee/status/888071631528235010\n    - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\n    - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: \n            - '*certutil * -decode *'\n            - '*certutil * -decodehex *'\n            - '*certutil *-urlcache* http*'\n            - '*certutil *-urlcache* ftp*'\n            - '*certutil *-URL*'\n            - '*certutil *-ping*'\n            - '*certutil.exe * -decode *'\n            - '*certutil.exe * -decodehex *'\n            - '*certutil.exe *-urlcache* http*'\n            - '*certutil.exe *-urlcache* ftp*'\n            - '*certutil.exe *-URL*'\n            - '*certutil.exe *-ping*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.t1140\n    - attack.s0189\n    - attack.g0007\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_certutil_command.yml","hash":"8758efbcc83e1666a41f2560eaf7b9ed47fde046bf1a23c9e8ab04588443c032","author_keyword":"Florian Roth, juju4","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"81bKm2YByorp5hYiZ_xb","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.177224","user_id":null,"author":"Michael Haag (idea), Florian Roth (rule)","title":"Microsoft Binary Github Communication","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Binary Github Communication","released":"2018-10-22T12:40:25.177222","sigma_text":"title: Microsoft Binary Github Communication\nstatus: experimental\ndescription: Detects an executable in the Windows folder accessing github.com\nreferences:\n    - https://twitter.com/M_haggis/status/900741347035889665\n    - https://twitter.com/M_haggis/status/1032799638213066752\nauthor: Michael Haag (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        DestinationHostname: \n            - '*.github.com'\n            - '*.githubusercontent.com'\n        Image: 'C:\\Windows\\*'\n    condition: selection\nfalsepositives:\n    - 'Unknown'\n    - '@subTee in your network'\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_win_binary_github_com.yml","hash":"4d9619ed47a5a57815f839fc70506cd5ba0730e3d2c5b0b2faa02f2ef5a5e980","author_keyword":"Michael Haag (idea), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"9VbKm2YByorp5hYiZ_yY","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.238170","user_id":null,"author":"Florian Roth","title":"Executables Started in Suspicious Folder","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Executables Started in Suspicious Folder","released":"2018-10-22T12:40:25.238166","sigma_text":"title: Executables Started in Suspicious Folder\nstatus: experimental\ndescription: Detects process starts of binaries from a suspicious folder\nauthor: Florian Roth\ndate: 2017/10/14\nreferences:\n   - https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt\n   - https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n   selection:\n      EventID: 1\n      Image:\n         - 'C:\\PerfLogs\\*'\n         - 'C:\\$Recycle.bin\\*'\n         - 'C:\\Intel\\Logs\\*'\n         - 'C:\\Users\\Default\\*'\n         - 'C:\\Users\\Public\\*'\n         - 'C:\\Users\\NetworkService\\*'\n         - 'C:\\Windows\\Fonts\\*'\n         - 'C:\\Windows\\Debug\\*'\n         - 'C:\\Windows\\Media\\*'\n         - 'C:\\Windows\\Help\\*'\n         - 'C:\\Windows\\addins\\*'\n         - 'C:\\Windows\\repair\\*'\n         - 'C:\\Windows\\security\\*'\n         - '*\\RSA\\MachineKeys\\*'\n         - 'C:\\Windows\\system32\\config\\systemprofile\\*'\n   condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_exec_folder.yml","hash":"fbc6f5bb32bd99588686339bcd4c3aa3bf00b47429bd8565a68df41de149f6ea","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"_1bKm2YByorp5hYiaPzl","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.572062","user_id":null,"author":"Markus Neis","title":"Detection of PowerShell Execution via DLL","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Detection of PowerShell Execution via DLL","released":"2018-10-22T12:40:25.572060","sigma_text":"title: Detection of PowerShell Execution via DLL\nstatus: experimental\ndescription: Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll\nreferences:\n    - https://github.com/p3nt4/PowerShdll/blob/master/README.md\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/08/25\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image:\n            - '*\\rundll32.exe'\n    selection2:\n        EventID: 1\n        Description:\n            - '*Windows-Hostprozess (Rundll32)*'\n    selection3:\n        EventID: 1\n        CommandLine:\n            - '*Default.GetString*'\n            - '*FromBase64String*'\n    condition: (selection1 or selection2) and selection3\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_powershell_dll_execution.yml","hash":"e2398dc1b94d80096cbd2f991b01dab55b842ac35448d220af2af049231abec4","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"CFbKm2YByorp5hYiaf2g","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.758025","user_id":null,"author":"Michael Haag, Mark Woan (improvements)","title":"Net.exe Execution","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Net.exe Execution","released":"2018-10-22T12:40:25.758022","sigma_text":"title: Net.exe Execution\nstatus: experimental\ndescription: Detects execution of Net.exe, whether suspicious or benign.\nreferences:\n    - https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\nauthor: Michael Haag, Mark Woan (improvements)\ntags:\n    - attack.s0039\n    - attack.lateral_movement\n    - attack.discovery\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\net.exe'\n            - '*\\net1.exe'\n        CommandLine:\n            - '* group*'\n            - '* localgroup*'\n            - '* user*'\n            - '* view*'\n            - '* share'\n            - '* accounts*'\n            - '* use*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine.\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_susp_net_execution.yml","hash":"a4f1a058bc20e7a59b1484be19ef1a7d480bd3da9ee6129daf9cf042913ddb1e","author_keyword":"Michael Haag, Mark Woan (improvements)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"ClbKm2YByorp5hYiaf3D","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.794012","user_id":null,"author":"Markus Neis","title":"MSHTA spwaned by SVCHOST as seen in LethalHTA","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"MSHTA spwaned by SVCHOST as seen in LethalHTA","released":"2018-10-22T12:40:25.794009","sigma_text":"title: MSHTA spwaned by SVCHOST as seen in LethalHTA \nstatus: experimental\ndescription: Detects MSHTA.EXE spwaned by SVCHOST described in report\nreferences:\n    - https://codewhitesec.blogspot.com/2018/07/lethalhta.html\nauthor: Markus Neis\ndate: 2018/06/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\svchost.exe'\n        Image: '*\\mshta.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_lethalhta.yml","hash":"e0c0df7a333327ea770162df56e7f8b298c1781d9466cf138dbcec4cc9b1d329","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"DFbKm2YByorp5hYiaf3c","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.818630","user_id":null,"author":"Markus Neis / Florian Roth","title":"SquiblyTwo","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"SquiblyTwo","released":"2018-10-22T12:40:25.818628","sigma_text":"title: SquiblyTwo\nstatus: experimental\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash\nreferences:\n    - https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\n    - https://twitter.com/mattifestation/status/986280382042595328\ntags:\n    - attack.defense_evasion\n    - attack.t1047\nauthor: Markus Neis / Florian Roth\nfalsepositives:\n    - Unknown\nlevel: medium\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - 'wmic * *format:\\\"http*'\n            - \"wmic * /format:'http\"\n            - 'wmic * /format:http*'\n    selection2:\n        EventID: 1\n        Imphash:\n             - '1B1A3F43BF37B5BFE60751F2EE2F326E'\n             - '37777A96245A3C74EB217308F3546F4C'\n             - '9D87C9D67CE724033C0B40CC4CA1B206'\n        CommandLine:\n            - '* *format:\\\"http*'\n            - \"* /format:'http\"\n            - '* /format:http*'\n    condition: 1 of them\n","git_filepath":"/windows/sysmon/sysmon_bypass_squiblytwo.yml","hash":"d4c6b56aaca0f629c6dd79f4deba3a812b6ebc7426eed09cfc7d5e3310df4dd5","author_keyword":"Markus Neis / Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"DlbKm2YByorp5hYiaf3x","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.840177","user_id":null,"author":"Florian Roth","title":"Exploit for CVE-2015-1641","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Exploit for CVE-2015-1641","released":"2018-10-22T12:40:25.840175","sigma_text":"title: Exploit for CVE-2015-1641\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641\nreferences:\n  - https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/\n  - https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100\nauthor: Florian Roth\ndate: 2018/02/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\MicroScMgmt.exe '\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_exploit_cve_2015_1641.yml","hash":"fd0e9f52bd5029f3bdc71667d476dfb9a9e1c3676ba379b669be7de14d5523b0","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"EVbKm2YByorp5hYiav0w","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.902107","user_id":null,"author":"Markus Neis","title":"Malicious PowerShell Commandlet Names","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malicious PowerShell Commandlet Names","released":"2018-10-22T12:40:25.902104","sigma_text":"title: Malicious PowerShell Commandlet Names\nstatus: experimental\ndescription: Detects the creation of known powershell scripts for exploitation\nreferences:\n    - https://raw.githubusercontent.com/Neo23x0/sigma/f35c50049fa896dff91ff545cb199319172701e8/rules/windows/powershell/powershell_malicious_commandlets.yml\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/04/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename:\n            - '*\\Invoke-DllInjection.ps1'   \n            - '*\\Invoke-WmiCommand.ps1'\n            - '*\\Get-GPPPassword.ps1'\n            - '*\\Get-Keystrokes.ps1'\n            - '*\\Get-VaultCredential.ps1'\n            - '*\\Invoke-CredentialInjection.ps1'\n            - '*\\Invoke-Mimikatz.ps1'\n            - '*\\Invoke-NinjaCopy.ps1'\n            - '*\\Invoke-TokenManipulation.ps1'\n            - '*\\Out-Minidump.ps1'\n            - '*\\VolumeShadowCopyTools.ps1'\n            - '*\\Invoke-ReflectivePEInjection.ps1'\n            - '*\\Get-TimedScreenshot.ps1'\n            - '*\\Invoke-UserHunter.ps1'\n            - '*\\Find-GPOLocation.ps1'\n            - '*\\Invoke-ACLScanner.ps1'\n            - '*\\Invoke-DowngradeAccount.ps1'\n            - '*\\Get-ServiceUnquoted.ps1'\n            - '*\\Get-ServiceFilePermission.ps1'\n            - '*\\Get-ServicePermission.ps1'\n            - '*\\Invoke-ServiceAbuse.ps1'\n            - '*\\Install-ServiceBinary.ps1'\n            - '*\\Get-RegAutoLogon.ps1'\n            - '*\\Get-VulnAutoRun.ps1'\n            - '*\\Get-VulnSchTask.ps1'\n            - '*\\Get-UnattendedInstallFile.ps1'\n            - '*\\Get-WebConfig.ps1'\n            - '*\\Get-ApplicationHost.ps1'\n            - '*\\Get-RegAlwaysInstallElevated.ps1'\n            - '*\\Get-Unconstrained.ps1'\n            - '*\\Add-RegBackdoor.ps1'\n            - '*\\Add-ScrnSaveBackdoor.ps1'\n            - '*\\Gupt-Backdoor.ps1'\n            - '*\\Invoke-ADSBackdoor.ps1'\n            - '*\\Enabled-DuplicateToken.ps1'\n            - '*\\Invoke-PsUaCme.ps1'\n            - '*\\Remove-Update.ps1'\n            - '*\\Check-VM.ps1'\n            - '*\\Get-LSASecret.ps1'\n            - '*\\Get-PassHashes.ps1'\n            - '*\\Invoke-Mimikatz.ps1'\n            - '*\\Show-TargetScreen.ps1'\n            - '*\\Port-Scan.ps1'\n            - '*\\Invoke-PoshRatHttp.ps1'\n            - '*\\Invoke-PowerShellTCP.ps1'\n            - '*\\Invoke-PowerShellWMI.ps1'\n            - '*\\Add-Exfiltration.ps1'\n            - '*\\Add-Persistence.ps1'\n            - '*\\Do-Exfiltration.ps1'\n            - '*\\Start-CaptureServer.ps1'\n            - '*\\Invoke-ShellCode.ps1'\n            - '*\\Get-ChromeDump.ps1'\n            - '*\\Get-ClipboardContents.ps1'\n            - '*\\Get-FoxDump.ps1'\n            - '*\\Get-IndexedItem.ps1'\n            - '*\\Get-Screenshot.ps1'\n            - '*\\Invoke-Inveigh.ps1'\n            - '*\\Invoke-NetRipper.ps1'\n            - '*\\Invoke-EgressCheck.ps1'\n            - '*\\Invoke-PostExfil.ps1'\n            - '*\\Invoke-PSInject.ps1'\n            - '*\\Invoke-RunAs.ps1'\n            - '*\\MailRaider.ps1'\n            - '*\\New-HoneyHash.ps1'\n            - '*\\Set-MacAttribute.ps1'\n            - '*\\Invoke-DCSync.ps1'\n            - '*\\Invoke-PowerDump.ps1'\n            - '*\\Exploit-Jboss.ps1'\n            - '*\\Invoke-ThunderStruck.ps1'\n            - '*\\Invoke-VoiceTroll.ps1'\n            - '*\\Set-Wallpaper.ps1'\n            - '*\\Invoke-InveighRelay.ps1'\n            - '*\\Invoke-PsExec.ps1'\n            - '*\\Invoke-SSHCommand.ps1'\n            - '*\\Get-SecurityPackages.ps1'\n            - '*\\Install-SSP.ps1'\n            - '*\\Invoke-BackdoorLNK.ps1'\n            - '*\\PowerBreach.ps1'\n            - '*\\Get-SiteListPassword.ps1'\n            - '*\\Get-System.ps1'\n            - '*\\Invoke-BypassUAC.ps1'\n            - '*\\Invoke-Tater.ps1'\n            - '*\\Invoke-WScriptBypassUAC.ps1'\n            - '*\\PowerUp.ps1'\n            - '*\\PowerView.ps1'\n            - '*\\Get-RickAstley.ps1'\n            - '*\\Find-Fruit.ps1'\n            - '*\\HTTP-Login.ps1'\n            - '*\\Find-TrustedDocuments.ps1'\n            - '*\\Invoke-Paranoia.ps1'\n            - '*\\Invoke-WinEnum.ps1'\n            - '*\\Invoke-ARPScan.ps1'\n            - '*\\Invoke-PortScan.ps1'\n            - '*\\Invoke-ReverseDNSLookup.ps1'\n            - '*\\Invoke-SMBScanner.ps1'\n            - '*\\Invoke-Mimikittenz.ps1'\n    condition: selection\nfalsepositives:\n    - Penetration Tests\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_powershell_exploit_scripts.yml","hash":"b52b7722dd74eb6c5c64e69a3527b10cd555d7629d4ee5b34b5867e10c8d07b3","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"ElbKm2YByorp5hYiav3o","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.921704","user_id":null,"author":"Florian Roth","title":"DNS ServerLevelPluginDll Install","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"DNS ServerLevelPluginDll Install","released":"2018-10-22T12:40:25.921701","sigma_text":"title: DNS ServerLevelPluginDll Install\nstatus: experimental\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\ndate: 2017/05/08\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    dnsadmin:\n        EventID: 1\n        CommandLine: 'dnscmd.exe /config /serverlevelplugindll *'\n    dnsregmod:\n        EventID: 13\n        TargetObject: '*\\services\\DNS\\Parameters\\ServerLevelPluginDll'\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_dns_serverlevelplugindll.yml","hash":"362bb1178095bf33fb8ea1cbb7745413faef11c93a97389779ab7fbe869f6df4","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"E1bKm2YByorp5hYia_1s","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:26.219003","user_id":null,"author":"Florian Roth","title":"Suspicious Program Location with Network Connections","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Program Location with Network Connections","released":"2018-10-22T12:40:26.219000","sigma_text":"title: Suspicious Program Location with Network Connections\nstatus: experimental\ndescription: Detects programs with network connections running in suspicious files system locations\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\nauthor: Florian Roth\ndate: 2017/03/19\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 3 Network Connection events'\ndetection:\n    selection:\n        EventID: 3\n        Image: \n            - '*\\ProgramData\\*'\n            - '*\\$Recycle.bin'\n            - '*\\Users\\All Users\\*'\n            - '*\\Users\\Default\\*'\n            - '*\\Users\\Public\\*'\n            - 'C:\\Perflogs\\*'\n            - '*\\config\\systemprofile\\*'\n            - '*\\Windows\\Fonts\\*'\n            - '*\\Windows\\IME\\*'\n            - '*\\Windows\\addins\\*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high","git_filepath":"/windows/sysmon/sysmon_susp_prog_location_network_connection.yml","hash":"7edf4f98e03538876919a35e953c1516140e0976dfc532ec5c3e7009b3c19d2c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"FVbKm2YByorp5hYia_2F","_score":1,"_source":{"status":"experimental","category":9,"updated":"2018-10-22T12:40:26.244282","user_id":null,"author":"Florian Roth","title":"Program Executions in Suspicious Folders","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Program Executions in Suspicious Folders","released":"2018-10-22T12:40:26.244280","sigma_text":"title: Program Executions in Suspicious Folders\nstatus: experimental\ndescription: Detects program executions in suspicious non-program folders related to malware or hacking activity\nreferences:\n    - 'Internal Research'\ndate: 2018/01/23\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'SYSCALL'\n        exe:\n            # Temporary folder\n            - '/tmp/*'\n            # Web server \n            - '/var/www/*'              # Standard\n            - '/home/*/public_html/*'   # Per-user\n            - '/usr/local/apache2/*'    # Classical Apache\n            - '/usr/local/httpd/*'      # Old SuSE Linux 6.* Apache\n            - '/var/apache/*'           # Solaris Apache\n            - '/srv/www/*'              # SuSE Linux 9.*\n            - '/home/httpd/html/*'      # Redhat 6 or older Apache\n            - '/srv/http/*'             # ArchLinux standard\n            - '/usr/share/nginx/html/*' # ArchLinux nginx\n            # Data dirs of typically exploited services (incomplete list)\n            - '/var/lib/pgsql/data/*'\n            - '/usr/local/mysql/data/*'\n            - '/var/lib/mysql/*'\n            - '/var/vsftpd/*'\n            - '/etc/bind/*'\n            - '/var/named/*'\n    condition: selection\nfalsepositives:\n    - Admin activity (especially in /tmp folders)\n    - Crazy web applications\nlevel: medium\n","git_filepath":"/linux/auditd/lnx_auditd_susp_exe_folders.yml","hash":"11dbaab4c593b13c294e7d820a5a26dd424c968d6ac1746a3613981665776fdc","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"GFbKm2YByorp5hYia_3D","_score":1,"_source":{"status":"experimental","category":3,"updated":"2018-10-22T12:40:26.306645","user_id":null,"author":"Florian Roth","title":"Suspicious Named Error","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Named Error","released":"2018-10-22T12:40:26.306642","sigma_text":"title: Suspicious Named Error\nstatus: experimental\ndescription: Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml\nauthor: Florian Roth\ndate: 2018/02/20\nlogsource:\n    product: linux\n    service: syslog\ndetection:\n    keywords:\n        - '* dropping source port zero packet from *'\n        - '* denied AXFR from *'\n        - '* exiting (due to fatal error)*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/linux/lnx_susp_named.yml","hash":"849def7473a8730ca7ed269763487c24babf2f8dbc0ce4ba5dc88105d7163dad","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"HVbKm2YByorp5hYia_3r","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.346065","user_id":null,"author":"Florian Roth","title":"Suspicious Log Entries","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious Log Entries","released":"2018-10-22T12:40:26.346063","sigma_text":"title: Suspicious Log Entries\ndescription: Detects suspicious log entries in Linux log files\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious log lines\n        - 'entered promiscuous mode'\n        # OSSEC https://github.com/ossec/ossec-hids/blob/master/etc/rules/syslog_rules.xml\n        - 'Deactivating service'\n        - 'Oversized packet received from'  \n        - 'imuxsock begins to drop messages'      \n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/linux/lnx_shell_susp_log_entries.yml","hash":"197911e27c186b5f5bce3557263e09e6a20d4792a0a8474b650a0bf94ff72ab6","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"H1bKm2YByorp5hYia_38","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.363021","user_id":null,"author":null,"title":"Buffer Overflow Attempts","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Buffer Overflow Attempts","released":"2018-10-22T12:40:26.363018","sigma_text":"title: Buffer Overflow Attempts\ndescription: Detects buffer overflow attempts in Unix system log files\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml\nlogsource:\n    product: unix\ndetection:\n    keywords:\n        - 'attempt to execute code on stack by'\n        - 'FTP LOGIN FROM .* 0bin0sh'\n        - 'rpc.statd[\\d+]: gethostbyname error for'\n        - 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n    condition: keywords\nfalsepositives:\n    - Unkown\nlevel: high\n","git_filepath":"/linux/lnx_buffer_overflows.yml","hash":"b9a27413d6db2a9f8224e93a0c3b6ed7ff08aba9e9bf9357f830f4ff15ed9693","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"IFbKm2YByorp5hYibP0J","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.375991","user_id":null,"author":"Florian Roth","title":"Suspicious Activity in Shell Commands","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Activity in Shell Commands","released":"2018-10-22T12:40:26.375988","sigma_text":"title: Suspicious Activity in Shell Commands\ndescription: Detects suspicious shell commands used in various exploit codes (see references)\nreferences:\n    - http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html\n    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121\n    - http://pastebin.com/FtygZ1cg\n    - https://artkond.com/2017/03/23/pivoting-guide/\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious commands\n        - 'wget * - http* | perl'\n        - 'wget * - http* | sh'\n        - 'wget * - http* | bash'\n        - 'python -m SimpleHTTPServer'\n        - 'import pty; pty.spawn'\n        # Malware \n        - '*wget *; chmod +x*'\n        - '*wget *; chmod 777 *'\n        - '*cd /tmp || cd /var/run || cd /mnt*'\n        # Apache Struts in-the-wild exploit codes  \n        - 'stop;service iptables stop;'\n        - 'stop;SuSEfirewall2 stop;'\n        - 'chmod 777 2020'\n        - '\">>/etc/rc.local;'\n        - 'wget -c *;chmod 777'\n        # Metasploit framework exploit codes\n        - 'base64 -d /tmp/'\n        - ' | base64 -d'\n        - '/bin/chmod u+s'\n        - 'chmod +s /tmp/'\n        - 'chmod u+s /tmp/'\n        - '/tmp/haxhax'\n        - '/tmp/ns_sploit'\n        - 'nc -l -p '\n        - 'cp /bin/ksh '\n        - 'cp /bin/sh '\n        - ' /tmp/*.b64 '\n        - '/tmp/ysocereal.jar'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/linux/lnx_shell_susp_commands.yml","hash":"50f16b4015f68d5b6b9bb9d5670f1e32ccb13d86125b28b2167b117f8af17ce1","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"IVbKm2YByorp5hYibP0V","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.388083","user_id":null,"author":null,"title":"Multiple Failed Logins with Different Accounts from Single Source System","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Multiple Failed Logins with Different Accounts from Single Source System","released":"2018-10-22T12:40:26.388081","sigma_text":"title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nlogsource:\n    product: linux\n    service: auth\ndetection:\n    selection:\n        pam_message: \"authentication failure\"\n        pam_user: '*'\n        pam_rhost: '*'\n    timeframe: 24h \n    condition: selection | count(pam_user) by pam_rhost > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Workstations with frequently changing users \nlevel: medium\n","git_filepath":"/linux/lnx_susp_failed_logons_single_source.yml","hash":"55ca9fbc76ccc89223f54cc9102b980ac070eb2563567be80b773f0d3f6cf285","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"I1bKm2YByorp5hYibP0l","_score":1,"_source":{"status":"","category":1,"updated":"2018-10-22T12:40:26.403889","user_id":null,"author":"Thomas Patzke","title":"Ruby on Rails framework exceptions","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Ruby on Rails framework exceptions","released":"2018-10-22T12:40:26.403887","sigma_text":"title: Ruby on Rails framework exceptions\ndescription: Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - http://edgeguides.rubyonrails.org/security.html\n    - http://guides.rubyonrails.org/action_controller_overview.html\n    - https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception\n    - https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb\nlogsource:\n    category: application\n    product: ruby_on_rails\ndetection:\n    keywords:\n        - ActionController::InvalidAuthenticityToken\n        - ActionController::InvalidCrossOriginRequest\n        - ActionController::MethodNotAllowed\n        - ActionController::BadRequest\n        - ActionController::ParameterMissing\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n","git_filepath":"/application/appframework_ruby_on_rails_exceptions.yml","hash":"fc37278a20a4219a2b968eca569332e64a60b7777a2eaab62a2256817bd6c122","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"J1bKm2YByorp5hYibP1L","_score":1,"_source":{"status":"experimental","category":4,"updated":"2018-10-22T12:40:26.441843","user_id":null,"author":"Florian Roth","title":"Telegram Bot API Request","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Telegram Bot API Request","released":"2018-10-22T12:40:26.441840","sigma_text":"title: Telegram Bot API Request\nstatus: experimental\ndescription: Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind\nreferences:\n    - https://core.telegram.org/bots/faq\n    - https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/\n    - https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/\n    - https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\nauthor: Florian Roth\ndate: 2018/06/05\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - 'api.telegram.org'   # Telegram Bot API Request https://core.telegram.org/bots/faq\n    condition: selection\nfalsepositives:\n    - Legitimate use of Telegram bots in the company\nlevel: medium","git_filepath":"/network/net_susp_telegram_api.yml","hash":"cf636abe0667739ad6c7fcbf5f8708e37c3f9169cc462c613997a153ea91daa8","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"KFbKm2YByorp5hYibP1R","_score":1,"_source":{"status":"experimental","category":4,"updated":"2018-10-22T12:40:26.448784","user_id":null,"author":"Florian Roth","title":"Suspicious DNS Query with B64 Encoded String","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious DNS Query with B64 Encoded String","released":"2018-10-22T12:40:26.448781","sigma_text":"title: Suspicious DNS Query with B64 Encoded String   \nstatus: experimental\ndescription: Detects suspicious DNS queries using base64 encoding\nreferences:\n    - https://github.com/krmaxwell/dns-exfiltration\nauthor: Florian Roth\ndate: 2018/05/10\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - '*==.*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium","git_filepath":"/network/net_susp_dns_b64_queries.yml","hash":"389b4482c863caea3f620043c550e049c87aaec097cafe230238b61a14a4c54b","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"K1bKm2YByorp5hYibP1x","_score":1,"_source":{"status":"","category":4,"updated":"2018-10-22T12:40:26.479526","user_id":null,"author":"Thomas Patzke","title":"Network Scans","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Network Scans","released":"2018-10-22T12:40:26.479524","sigma_text":"title: Network Scans\ndescription: Detects many failed connection attempts to different ports or hosts\nauthor: Thomas Patzke\nlogsource:\n    category: firewall\ndetection:\n    selection:\n        action: denied\n    timeframe: 24h\n    condition:\n        - selection | count(dst_port) by src_ip > 10\n        - selection | count(dst_ip) by src_ip > 10\nfields:\n    - src_ip\n    - dst_ip\n    - dst_port\nfalsepositives:\n    - Inventarization systems\n    - Vulnerability scans\n    - Penetration testing activity\nlevel: medium\n","git_filepath":"/network/net_susp_network_scan.yml","hash":"d9d3030101ea563fdd3f15539adc431765fd43c5e0a92dc6ab2aea98e89f67b7","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"LFbKm2YByorp5hYibP15","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.488185","user_id":null,"author":"Florian Roth","title":"StoneDrill Service Install","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"StoneDrill Service Install","released":"2018-10-22T12:40:26.488183","sigma_text":"title: StoneDrill Service Install\ndescription: 'This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky'   \nauthor: Florian Roth\nreferences:\n    - https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\ntags:\n    - attack.persistence\n    - attack.g0064\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName: NtsSrv\n        ServiceFileName: '* LocalService'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n","git_filepath":"/apt/apt_stonedrill.yml","hash":"100a4ade83ce69288757337177efbdfb3621146043356374e40017559e5353fb","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"MFbKm2YByorp5hYibP3j","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.594453","user_id":null,"author":null,"title":"Turla Service Install","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Turla Service Install","released":"2018-10-22T12:40:26.594450","sigma_text":"title: Turla Service Install\ndescription: 'This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET' \nreferences:\n    - https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\ntags:\n    - attack.command_and_control\n    - attack.g0010\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName:\n            - 'srservice'\n            - 'ipvpn'\n            - 'hkmsvc' \n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/apt/apt_carbonpaper_turla.yml","hash":"63d7d685c32d477a85d145a057b8bb76a0303c7d7b2161fa0332a64a428e2dab","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"N1bKm2YByorp5hYibf1b","_score":1,"_source":{"status":"experimental","category":6,"updated":"2018-10-22T12:40:26.711655","user_id":null,"author":"Florian Roth","title":"Oracle WebLogic Exploit","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Oracle WebLogic Exploit","released":"2018-10-22T12:40:26.711652","sigma_text":"title: Oracle WebLogic Exploit\ndescription: Detects access to a webshell droped into a keytore folder on the WebLogic server\nauthor: Florian Roth\ndate: 2018/07/22\nstatus: experimental\nreferences: \n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\n    - https://twitter.com/pyn3rd/status/1020620932967223296\n    - https://github.com/LandGrey/CVE-2018-2894\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri-path: \n            - '*/config/keystore/*.js*'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.t1100\n    - attack.t1190\n    - attack.initial_access\n    - attack.persistence\n    - attack.privilege_escalation\n    - cve.2018-2894\nlevel: critical\n","git_filepath":"/web/web_cve_2018_2894_weblogic_exploit.yml","hash":"ca87008e185c0ed29895e99c580bf251a8420d70fb77f9d472e40800edab2bb9","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"OFbKm2YByorp5hYibf1o","_score":1,"_source":{"status":"","category":6,"updated":"2018-10-22T12:40:26.724922","user_id":null,"author":"Florian Roth","title":"Webshell Detection by Keyword","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Webshell Detection by Keyword","released":"2018-10-22T12:40:26.724919","sigma_text":"title: Webshell Detection by Keyword\ndescription: Detects webshells that use GET requests by keyword searches in URL strings\nauthor: Florian Roth\nlogsource:\n    category: webserver\ndetection:\n    keywords:\n        - '=whoami'\n        - '=net%20user'\n        - '=cmd%20/c%20'\n    condition: keywords\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Web sites like wikis with articles on os commands and pages that include the os commands in the URLs\n    - User searches in search boxes of the respective website\nlevel: high\n","git_filepath":"/web/web_webshell_keyword.yml","hash":"55d30e3d96c837cfc3d2c41cc0d7c23a35900a598b2f65f26cd83481c51f3414","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"PlbKm2YByorp5hYibf3Y","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.839444","user_id":null,"author":"Florian Roth","title":"Empty User Agent","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Empty User Agent","released":"2018-10-22T12:40:26.839441","sigma_text":"title: Empty User Agent\nstatus: experimental\ndescription: Detects suspicious empty user agent strings in proxy logs\nreferences:\n    - https://twitter.com/Carlos_Perez/status/883455096645931008\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Empty string - as used by Powershell's (New-Object Net.WebClient).DownloadString \n        - ''\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/proxy/proxy_empty_ua.yml","hash":"c3d5473a9395463306596a3c2a5049aeda2d45e5bdb5156ee33e6970714238d8","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"P1bKm2YByorp5hYibf38","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.862083","user_id":null,"author":"Florian Roth","title":"Exploit Framework User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Exploit Framework User Agent","released":"2018-10-22T12:40:26.862080","sigma_text":"title: Exploit Framework User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs\nreferences:\n    - https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Cobalt Strike https://www.cobaltstrike.com/help-malleable-c2\n        - 'Internet Explorer *'\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)'  # https://goo.gl/f4H5Ez\n        # Metasploit Framework - Analysis by Didier Stevens https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\n        - 'Mozilla/4.0 (compatible; Metasploit RSPEC)'\n        - 'Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)'\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N'\n        - 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'  # only use in proxy logs - not for detection in web server logs\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13'\n        # Metasploit Update by Florian Roth 08.07.2017\n        - 'Mozilla/5.0'\n        - 'Mozilla/4.0 (compatible; SPIPE/1.0'\n        # - 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)'  # too many false positives expected\n        # - 'Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko'  # too many false positives expected\n        - 'Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0'\n        - 'Sametime Community Agent'  # Unknown if prone to false positives - used in https://goo.gl/gHZkeR\n        - 'X-FORWARDED-FOR'\n        - 'DotDotPwn v2.1'\n        - 'SIPDROID'\n        # Exploits\n        - '*wordpress hash grabber*'\n        - '*exploit*'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/proxy/proxy_ua_frameworks.yml","hash":"c1512d6d980e3cee09097943215b84358cb7dce9238f8765b3344769d65cdbfa","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"RFbKm2YByorp5hYibv2E","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:27.005308","user_id":null,"author":"Markus Neis","title":"CobaltStrike Malleable Amazon browsing traffic profile","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"CobaltStrike Malleable Amazon browsing traffic profile","released":"2018-10-22T12:40:27.005306","sigma_text":"title: CobaltStrike Malleable Amazon browsing traffic profile\r\nstatus: experimental\r\ndescription: Detects Malleable Amazon Profile \r\nreferences:\r\n    - https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile\r\n    - https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100\r\nauthor: Markus Neis\r\ntags:\r\n    - attack.t1102\r\nlogsource:\r\n    category: proxy\r\ndetection:\r\n    selection1:\r\n      UserAgent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\"\r\n      HttpMethod: 'GET'\r\n      URL: '/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books'\r\n      Host: 'www.amazon.com'\r\n      Cookie: '*=csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996'\r\n    selection2:\r\n      UserAgent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\"\r\n      HttpMethod: 'POST'\r\n      URL: '/N4215/adj/amzn.us.sr.aps'\r\n      Host: 'www.amazon.com'\r\n    condition: selection1 or selection2\r\nfalsepositives:\r\n    - Unknown\r\nlevel: high\r\n","git_filepath":"/proxy/proxy_cobalt_amazon.yml","hash":"a11827f7034e90b2721bead87f1c188f8df44eb259e70672ef3e933c26e03720","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"RVbKm2YByorp5hYibv2V","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:27.028014","user_id":null,"author":"Florian Roth","title":"Suspicious User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious User Agent","released":"2018-10-22T12:40:27.028011","sigma_text":"title: Suspicious User Agent\nstatus: experimental\ndescription: Detects suspicious malformed user agent strings in proxy logs\nreferences:\n    - https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Badly scripted UA\n        - 'user-agent'  # User-Agent: User-Agent:\n        - '* (compatible;MSIE *'  # typical typo - missing space\n        - '*.0;Windows NT *'  # typical typo - missing space\n        - 'Mozilla/3.0 *'\n        - 'Mozilla/2.0 *'\n        - 'Mozilla/1.0 *'\n        - 'Mozilla *'  # missing slash\n        - ' Mozilla/*'  # leading space \n        - 'Mozila/*'  # single 'l'\n        - '_'\n        - 'CertUtil URL Agent'  # https://twitter.com/stvemillertime/status/985150675527974912\n    falsepositives:\n        UserAgent:\n            - 'Mozilla/3.0 * Acrobat *'  # Acrobat with linked content\n    condition: selection and not falsepositives\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/proxy/proxy_ua_suspicious.yml","hash":"2b296351e470188adb84d966f0f57dc12f48109e4229e1e8acee6414ed9322c4","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"RlbKm2YByorp5hYibv2u","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:27.049886","user_id":null,"author":"Florian Roth","title":"Hack Tool User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Hack Tool User Agent","released":"2018-10-22T12:40:27.049883","sigma_text":"title: Hack Tool User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings user by hack tools in proxy logs\nreferences:\n    - https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\n    - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Vulnerbility scanner and brute force tools\n        - '*(hydra)*'\n        - '* arachni/*'\n        - '* BFAC *'\n        - '* brutus *'\n        - '* cgichk *'\n        - '*core-project/1.0*'\n        - '* crimscanner/*'\n        - '*datacha0s*'\n        - '*dirbuster*'\n        - '*domino hunter*'\n        - '*dotdotpwn*'\n        - 'FHScan Core'\n        - '*floodgate*'\n        - '*get-minimal*'\n        - '*gootkit auto-rooter scanner*'\n        - '*grendel-scan*'\n        - '* inspath *'\n        - '*internet ninja*'\n        - '*jaascois*'\n        - '* zmeu *'\n        - '*masscan*'\n        - '* metis *'\n        - '*morfeus fucking scanner*'\n        - '*n-stealth*'\n        - '*nsauditor*'\n        - '*pmafind*'\n        - '*security scan*'\n        - '*springenwerk*'\n        - '*teh forest lobster*'\n        - '*toata dragostea*'\n        - '* vega/*'\n        - '*voideye*'\n        - '*webshag*'\n        - '*webvulnscan*'\n        - '* whcc/*'\n        # SQL Injection\n        - '* Havij'\n        - '*absinthe*'\n        - '*bsqlbf*'\n        - '*mysqloit*'\n        - '*pangolin*'\n        - '*sql power injector*'\n        - '*sqlmap*'\n        - '*sqlninja*'\n        - '*uil2pn*'\n        # Hack tool\n        - 'ruler'  # https://www.crowdstrike.com/blog/using-outlook-forms-lateral-movement-persistence/\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)'  # SQLi Dumper\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/proxy/proxy_ua_hacktool.yml","hash":"536ac9857676bc96018b3622106cd742b6be6868f638ee89c69dc31fa3cf9ffb","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"R1bKm2YByorp5hYibv29","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:27.066340","user_id":null,"author":"Florian Roth","title":"Windows PowerShell User Agent","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Windows PowerShell User Agent","released":"2018-10-22T12:40:27.066336","sigma_text":"title: Windows PowerShell User Agent\nstatus: experimental\ndescription: Detects Windows PowerShell Web Access\nreferences:\n    - https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent: '* WindowsPowerShell/*'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Administrative scripts that download files from the Internet\n    - Administrative scripts that retrieve certain website contents\nlevel: medium\n","git_filepath":"/proxy/proxy_powershell_ua.yml","hash":"bf1c625ee0efd6a3b9118234ad21fc47d26ac85527e7b9d4e4c4cb5907141f42","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"SFbKm2YByorp5hYibv3Y","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:27.092556","user_id":null,"author":"Florian Roth","title":"Malware User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malware User Agent","released":"2018-10-22T12:40:27.092553","sigma_text":"title: Malware User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings used by malware in proxy logs\nreferences:\n    - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\n    - http://www.botopedia.org/search?searchword=scan&searchphrase=all\n    - https://networkraptor.blogspot.com/2015/01/user-agent-strings.html\n    - https://perishablepress.com/blacklist/ua-2013.txt\n    - https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # RATs\n        - 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0'  # DargonOK\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)'  # Used by PlugX - base-lining recommended - https://community.rsa.com/thread/185439\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)'  # Used by PlugX - base-lining recommended - https://community.rsa.com/thread/185439\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)'  # Used by PlugX - old - https://goo.gl/Yfjtk5\n        - 'HttpBrowser/1.0'  # HTTPBrowser RAT\n        - '*<|>*'  # Houdini / Iniduoh / njRAT\n        - 'nsis_inetc (mozilla)'  # ZeroAccess\n        - 'Wget/1.9+cvs-stable (Red Hat modified)'  # Dyre / Upatre\n        # Ghost419 https://goo.gl/rW1yvZ\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)'\n        # Malware\n        - '*zeroup*'  # W32/Renos.Downloader\n        - 'Mozilla/5.0 (Windows NT 5.1 ; v.*'  # Kazy\n        - '* adlib/*'  # https://goo.gl/gcAHoh\n        - '* tiny'  # Trojan Downloader\n        - '* BGroom *'  # Trojan Downloader\n        - '* changhuatong'\n        - '* CholTBAgent'\n        - 'Mozilla/5.0 WinInet'\n        - 'RookIE/1.0'\n        - 'M'  # HkMain\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)'  # Egamipload - old UA - probable prone to false positives\n        - 'Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)'  # Yakes\n        - 'backdoorbot'\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)'  # Sality\n        - 'Opera/8.81 (Windows NT 6.0; U; en)'  # Sality\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)'  # Sality\n        - 'Opera'  # Trojan Keragany\n        - 'Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)'  # Fareit\n        - 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)'  # Webshell's back connect\n        - 'MSIE'  # Toby web shell\n        - '*(Charon; Inferno)'  # Loki Bot\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)'  # Fareit / Pony\n        - 'Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)'  # https://goo.gl/g43qjs\n        # Others \n        - '* pxyscand*'\n        - '* asd'\n        - '* mdms'\n        - 'sample'\n        - 'nocase'\n        - 'Moxilla'\n        - 'Win32 *'\n        - '*Microsoft Internet Explorer*'\n        - 'agent *'\n        - 'AutoIt'  # Suspicious - base-lining recommended\n        - 'IczelionDownLoad'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/proxy/proxy_ua_malware.yml","hash":"c6934ee4a4ab66769edecef3b93be462727ab4af24dbecab4dff3bcd8bf28595","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"h1bKm2YByorp5hYiX_xE","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:22.579780","user_id":null,"author":"Florian Roth","title":"Microsoft Malware Protection Engine Crash","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Malware Protection Engine Crash","released":"2018-10-22T12:40:22.579777","sigma_text":"title: Microsoft Malware Protection Engine Crash\ndescription: This rule detects a suspicious crash of the Microsoft Malware Protection Engine\ntags:\n    - attack.defense_evasion\n    - attack.t1089\n    - attack.t1211\nstatus: experimental\ndate: 2017/05/09\nreferences:\n    - https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5\n    - https://technet.microsoft.com/en-us/library/security/4022344\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        Source: 'Application Error'\n        EventID: 1000\n    selection2:\n        Source: 'Windows Error Reporting'\n        EventID: 1001\n    keywords:\n        - 'MsMpEng.exe'\n        - 'mpengine.dll'\n    condition: 1 of selection* and all of keywords\nfalsepositives:\n    - MsMpEng.exe can crash when C:\\ is full\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_msmpeng_crash.yml","hash":"c4f80214d4384a33542a7aea09e4d7cf44896729b58784841a85f68656c1d024","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"iVbKm2YByorp5hYiX_yF","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.172420","user_id":null,"author":"@neu5ron","title":"Enabled User Right in AD to Control User Objects","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Enabled User Right in AD to Control User Objects","released":"2018-10-22T12:40:23.172417","sigma_text":"title: Enabled User Right in AD to Control User Objects\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.\ntags:\n    - attack.privilege_escalation\n    - attack.t1078\nreferences:\n    - https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\ndetection:\n    selection:\n        EventID: 4704\n    keywords:\n        - 'SeEnableDelegationPrivilege'\n    condition: all of them\nfalsepositives: \n    - Unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_alert_active_directory_user_control.yml","hash":"9c436cd0aa4c479cee6192fe6be057e8dbbd339c29e5cafafa4552603f33ebf0","author_keyword":"@neu5ron","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"jFbKm2YByorp5hYiX_zM","_score":1,"_source":{"status":"stable","category":11,"updated":"2018-10-22T12:40:23.243532","user_id":null,"author":"Thomas Patzke","title":"Password Change on Directory Service Restore Mode (DSRM) Account","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Password Change on Directory Service Restore Mode (DSRM) Account","released":"2018-10-22T12:40:23.243530","sigma_text":"title: Password Change on Directory Service Restore Mode (DSRM) Account\nstatus: stable\ndescription: The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.\nreferences:\n    - https://adsecurity.org/?p=1714\nauthor: Thomas Patzke\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4794\n    condition: selection\nfalsepositives:\n    - Initial installation of a domain controller\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_dsrm_password_change.yml","hash":"f2261f74ff319d357ee9c28f5430e28922c76aa504d794b54324860b8016b57e","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"jVbKm2YByorp5hYiX_zc","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.259138","user_id":null,"author":"Dimitrios Slamaris","title":"DHCP Server Error Failed Loading the CallOut DLL","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"DHCP Server Error Failed Loading the CallOut DLL","released":"2018-10-22T12:40:23.259135","sigma_text":"title: DHCP Server Error Failed Loading the CallOut DLL\ndescription: This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded\nstatus: experimental\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n          EventID: \n            - 1031\n            - 1032\n            - 1034\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n","git_filepath":"/windows/builtin/win_susp_dhcp_config_failed.yml","hash":"e863caf7e4c42735a9adebc45ba119079ac6bd6399ec9498bb5d6931c537ab6c","author_keyword":"Dimitrios Slamaris","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"kVbKm2YByorp5hYiYPw6","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.350809","user_id":null,"author":"Florian Roth","title":"Kerberos Manipulation","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Kerberos Manipulation","released":"2018-10-22T12:40:23.350807","sigma_text":"title: Kerberos Manipulation\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\nauthor: Florian Roth\ntags:\n    - attack.credential_access\n    - attack.t1212\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n          - 675\n          - 4768\n          - 4769\n          - 4771\n        FailureCode:\n          - '0x9'\n          - '0xA'\n          - '0xB'\n          - '0xF'\n          - '0x10'\n          - '0x11'\n          - '0x13'\n          - '0x14'\n          - '0x1A'\n          - '0x1F'\n          - '0x21'\n          - '0x22'\n          - '0x23'\n          - '0x24'\n          - '0x26'\n          - '0x27'\n          - '0x28'\n          - '0x29'\n          - '0x2C'\n          - '0x2D'\n          - '0x2E'\n          - '0x2F'\n          - '0x31'\n          - '0x32'\n          - '0x3E'\n          - '0x3F'\n          - '0x40'\n          - '0x41'\n          - '0x43'\n          - '0x44'\n    condition: selection\nfalsepositives:\n    - Faulty legacy applications\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_kerberos_manipulation.yml","hash":"e7d594a5f230e22682b7c684d9e87eb246428232ed597a3180b00a323db16368","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"k1bKm2YByorp5hYiYPxu","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.404734","user_id":null,"author":"Florian Roth","title":"Rare Schtasks Creations","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Rare Schtasks Creations","released":"2018-10-22T12:40:23.404732","sigma_text":"title: Rare Schtasks Creations\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\nstatus: experimental\nauthor: Florian Roth\ntags:\n    - attack.execution\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1053\nlogsource:\n    product: windows\n    service: security\n    description: 'The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.'\ndetection:\n    selection:\n        EventID: 4698\n    timeframe: 7d\n    condition: selection | count(TaskName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n","git_filepath":"/windows/builtin/win_rare_schtasks_creations.yml","hash":"06ec800ff8fa93fd41e36229860a0200740e4d587198bc533abdba1f6495942c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"lVbKm2YByorp5hYiYPyg","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.454967","user_id":null,"author":"Florian Roth","title":"Eventlog Cleared","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Eventlog Cleared","released":"2018-10-22T12:40:23.454964","sigma_text":"title: Eventlog Cleared\nstatus: experimental\ndescription: Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution  \nauthor: Florian Roth\ndate: 2017/06/27\nreferences:\n    - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n        Source: Eventlog\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_eventlog_cleared.yml","hash":"090495eeac6d8bae590f15802a31f801addaa9ac7d6fe6c8e64039ae9f01df32","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"l1bKm2YByorp5hYiYPzA","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.487084","user_id":null,"author":"Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)","title":"Pass the Hash Activity","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Pass the Hash Activity","released":"2018-10-22T12:40:23.487080","sigma_text":"title: Pass the Hash Activity\nstatus: experimental\ndescription: 'Detects the attack technique pass the hash which is used to move laterally inside the network'\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\nauthor: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)\ntags:\n    - attack.lateral_movement\n    - attack.t1075\nlogsource:\n    product: windows\n    service: security\n    description: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\ndetection:\n    selection:\n        - EventID: 4624\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n        - EventID: 4625\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n","git_filepath":"/windows/builtin/win_pass_the_hash.yml","hash":"8a771fec895244c8be001c40555e9e0ca47d9212b9c49ac1801131c7b5351f3b","author_keyword":"Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"nFbKm2YByorp5hYiYfwR","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.567785","user_id":null,"author":"Florian Roth","title":"Account Tampering - Suspicious Failed Logon Reasons","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Account Tampering - Suspicious Failed Logon Reasons","released":"2018-10-22T12:40:23.567782","sigma_text":"title: Account Tampering - Suspicious Failed Logon Reasons\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.\nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4625\n            - 4776\n        Status:\n            - '0xC0000072'\n            - '0xC000006F'\n            - '0xC0000070'\n            - '0xC0000413'\n            - '0xC000018C'\n    condition: selection\nfalsepositives:\n    - User using a disabled account\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_failed_logon_reasons.yml","hash":"85c83787820ac9713f21090a0e135a8083cd51c3ecbbab2ffe5303ec68527c7c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"nlbKm2YByorp5hYiYfw0","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.603123","user_id":null,"author":"Florian Roth","title":"Hacktool Use","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Hacktool Use","released":"2018-10-22T12:40:23.603121","sigma_text":"title: Hacktool Use\ndescription: This method detects well-known keywords, certain field combination that appear in Windows Eventlog when certain hack tools are used\nauthor: Florian Roth\ntags:\n    - attack.discovery\n    - attack.execution\n    - attack.t1087\n    - attack.t1075\n    - attack.t1114\n    - attack.t1059\nlogsource:\n    product: windows\n    service: security\ndetection:\n    # Ruler https://github.com/sensepost/ruler\n    selection1:\n        EventID: \n          - 4776\n          - 4624\n          - 4625\n        WorkstationName: 'RULER'\n    condition: selection1\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/windows/builtin/win_alert_hacktool_use.yml","hash":"37985b0f7f684f6cbd805598c86ed8e7e20c3ee99a7a11bd7adada0fe98f78d3","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"n1bKm2YByorp5hYiYfxA","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.615368","user_id":null,"author":"Dimitrios Slamaris","title":"Possible Remote Password Change Through SAMR","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Possible Remote Password Change Through SAMR","released":"2018-10-22T12:40:23.615366","sigma_text":"title: Possible Remote Password Change Through SAMR \ndescription: Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\nauthor: Dimitrios Slamaris\ntags:\n    - attack.credential_access\n    - attack.t1212\nlogsource:\n    product: windows\n    service: security\ndetection:\n    samrpipe:\n        EventID: 5145\n        RelativeTargetName: samr\n    passwordchanged:\n        EventID: 4738\n    passwordchanged_filter:\n        PasswordLastSet: null\n    timeframe: 15s \n    condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_samr_pwset.yml","hash":"ac744cc9aabab80a9b86e680d56cedea44d9f57bbc849c95082d4986f13898c7","author_keyword":"Dimitrios Slamaris","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"oFbKm2YByorp5hYiYfxO","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.629264","user_id":null,"author":"@neu5ron","title":"Active Directory User Backdoors","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Active Directory User Backdoors","released":"2018-10-22T12:40:23.629261","sigma_text":"title: Active Directory User Backdoors\ndescription: Detects scenarios where one can control another users account without having to use their credentials via msDS-AllowedToDelegateTo and or service principal names (SPN).\nreferences:\n    - https://msdn.microsoft.com/en-us/library/cc220234.aspx\n    - https://adsecurity.org/?p=3466\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description1: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\n    description2: 'Requirements: Audit Policy : DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes'\ndetection:\n    selection1:\n        EventID: 4738\n    filter1:\n        AllowedToDelegateTo: null\n    selection2:\n        EventID: 5136\n        AttributeLDAPDisplayName: 'msDS-AllowedToDelegateTo'\n    selection3:\n        EventID: 5136\n        ObjectClass: 'user'\n        AttributeLDAPDisplayName: 'servicePrincipalName'\n    condition: (selection1 and not filter1) or selection2 or selection3\nfalsepositives: \n    - Unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_alert_ad_user_backdoors.yml","hash":"b7386f367a78cbb92a5d780f65c9c61a30c7a0a86e17b7a0c2f7160ad6cebe4a","author_keyword":"@neu5ron","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"olbKm2YByorp5hYiYfxk","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.651104","user_id":null,"author":"Markus Neis","title":"LSASS Access Detected via Attack Surface Reduction","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"LSASS Access Detected via Attack Surface Reduction","released":"2018-10-22T12:40:23.651100","sigma_text":"title: LSASS Access Detected via Attack Surface Reduction\r\ndescription: Detects Access to LSASS Process\r\nstatus: experimental\r\nreferences:\r\n    - https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter\r\nauthor: Markus Neis\r\ndate: 2018/08/26\r\ntags:\r\n    - attack.credential_access\r\n    - attack.t1003\r\n# Defender Attack Surface Reduction\r\nlogsource:\r\n    product: windows_defender\r\n    description: 'Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'\r\ndetection:\r\n    selection:\r\n        EventID: 1121\r\n        Path: '*\\lsass.exe'\r\n    condition: selection\r\nfalsepositives:\r\n    - Google Chrome GoogleUpdate.exe\r\n    - Some Taskmgr.exe related activity\r\nlevel: high\r\n","git_filepath":"/windows/builtin/win_alert_lsass_access.yml","hash":"71cc5cbc7000a797c92ac48cbe248a024c6bb219149feea45ecc23d6f3664172","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"o1bKm2YByorp5hYiYfxy","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.665356","user_id":null,"author":"Benjamin Delpy, Florian Roth","title":"Mimikatz DC Sync","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Mimikatz DC Sync","released":"2018-10-22T12:40:23.665332","sigma_text":"title: Mimikatz DC Sync\ndescription: Detects Mimikatz DC sync security events\nstatus: experimental\ndate: 2018/06/03\nauthor: Benjamin Delpy, Florian Roth\nreferences:\n    - https://twitter.com/gentilkiwi/status/1003236624925413376\n    - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\ntags:\n    - attack.credential_access\n    - attack.s0002\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4662\n        Properties: \n            - '*Replicating Directory Changes All*'\n            - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n","git_filepath":"/windows/builtin/win_dcsync.yml","hash":"2e569d6bdcf09f633fd189a632546ff63f894e209205d2a78f54c2d747950811","author_keyword":"Benjamin Delpy, Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"qlbKm2YByorp5hYiYfzI","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.751557","user_id":null,"author":"Florian Roth (rule), Tom U. @c_APT_ure (collection)","title":"Backup Catalog Deleted","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Backup Catalog Deleted","released":"2018-10-22T12:40:23.751554","sigma_text":"title: Backup Catalog Deleted\nstatus: experimental\ndescription: Detects backup catalog deletions\nreferences:\n    - https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection) \ntags:\n    - attack.defense_evasion\n    - attack.t1107\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection:\n        EventID: 524\n        Source: Backup\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_backup_delete.yml","hash":"75ed3234802d7377ad7af0f29456e9d56b6be3e8433f6097f75d34ab1504772d","author_keyword":"Florian Roth (rule), Tom U. @c_APT_ure (collection)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"rFbKm2YByorp5hYiYfz0","_score":1,"_source":{"status":"stable","category":11,"updated":"2018-10-22T12:40:23.795071","user_id":null,"author":"Florian Roth","title":"User Added to Local Administrators","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"User Added to Local Administrators","released":"2018-10-22T12:40:23.795068","sigma_text":"title: User Added to Local Administrators\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity \nstatus: stable\nauthor: Florian Roth\ntags:\n    - attack.privilege_escalation\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4732\n        GroupName: Administrators\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and not filter\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n","git_filepath":"/windows/builtin/win_user_added_to_local_administrators.yml","hash":"4eb2473af243be97a4ee1c1463c6834f3eae1492ef37c11bd692d3ae5bc37408","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"rlbKm2YByorp5hYiYvwf","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.837875","user_id":null,"author":"Florian Roth","title":"Relevant Anti-Virus Event","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Relevant Anti-Virus Event","released":"2018-10-22T12:40:23.837873","sigma_text":"title: Relevant Anti-Virus Event\ndescription: This detection method points out highly relevant Antivirus events\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: application\ndetection:\n    keywords:\n        - HTool\n        - Hacktool\n        - ASP/Backdoor\n        - JSP/Backdoor\n        - PHP/Backdoor\n        - Backdoor.ASP\n        - Backdoor.JSP\n        - Backdoor.PHP\n        - Webshell\n        - Portscan\n        - Mimikatz\n        - WinCred\n        - PlugX\n        - Korplug\n        - Pwdump\n        - Chopper\n        - WmiExec\n        - Xscan\n        - Clearlog\n        - ASPXSpy\n    filters:\n        - Keygen\n        - Crack\n    condition: keywords and not 1 of filters\nfalsepositives:\n    - Some software piracy tools (key generators, cracks) are classified as hack tools\nlevel: high\n","git_filepath":"/windows/builtin/win_av_relevant_match.yml","hash":"3076dc3d98abb6354c99c835c8aa928b01d495bbd78ee6477d6aed951af04f79","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"r1bKm2YByorp5hYiYvxG","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.875278","user_id":null,"author":"Florian Roth","title":"NTLM Logon","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"NTLM Logon","released":"2018-10-22T12:40:23.875275","sigma_text":"title: NTLM Logon\nstatus: experimental\ndescription: Detects logons using NTLM, which could be caused by a legacy source or attackers\nreferences:\n    - https://twitter.com/JohnLaTwC/status/1004895028995477505\n    - https://goo.gl/PsqrhT\nauthor: Florian Roth\ndate: 2018/06/08\ntags:\n    - attack.credential_access\n    - attack.t1208\nlogsource:\n    product: windows\n    service: ntlm\n    description: Reqiures events from Microsoft-Windows-NTLM/Operational\ndetection:\n    selection:\n        EventID: 8002\n        CallingProcessName: '*'  # We use this to avoid false positives with ID 8002 on other log sources if the logsource isn't set correctly\n    condition: selection\nfalsepositives:\n    - Legacy hosts\nlevel: low\n","git_filepath":"/windows/builtin/win_susp_ntlm_auth.yml","hash":"4488c6b212a849c92c0d6d1b45261664174988eed752248f14f2dc744b08ea16","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"sFbKm2YByorp5hYiYvxZ","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.895825","user_id":null,"author":"Florian Roth (rule), Jack Croock (method)","title":"Reconnaissance Activity","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Reconnaissance Activity","released":"2018-10-22T12:40:23.895821","sigma_text":"title: Reconnaissance Activity\nstatus: experimental\ndescription: 'Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"'\nreferences:\n    - https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\nauthor: Florian Roth (rule), Jack Croock (method)\ntags:\n    - attack.discovery\n    - attack.t1087\n    - attack.t1069\n    - attack.s0039\nlogsource:\n    product: windows\n    service: security\n    description: The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems\ndetection:\n    selection:\n        - EventID: 4661\n          ObjectType: 'SAM_USER'\n          ObjectName: 'S-1-5-21-*-500'\n          AccessMask: '0x2d'\n        - EventID: 4661\n          ObjectType: 'SAM_GROUP'\n          ObjectName: 'S-1-5-21-*-512'\n          AccessMask: '0x2d'\n    condition: selection\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_net_recon_activity.yml","hash":"4c6b331ab4b8d43ee4d6455103a0ba4cbd05b3ce7af4a2a369af7c0ea3f56e07","author_keyword":"Florian Roth (rule), Jack Croock (method)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"tFbKm2YByorp5hYiYvzI","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.000153","user_id":null,"author":"Sean Metcalf (source), Florian Roth (rule)","title":"Malicious PowerShell Commandlets","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malicious PowerShell Commandlets","released":"2018-10-22T12:40:24.000150","sigma_text":"title: Malicious PowerShell Commandlets\nstatus: experimental\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        - Invoke-DllInjection\n        - Invoke-Shellcode\n        - Invoke-WmiCommand\n        - Get-GPPPassword\n        - Get-Keystrokes\n        - Get-TimedScreenshot\n        - Get-VaultCredential\n        - Invoke-CredentialInjection\n        - Invoke-Mimikatz\n        - Invoke-NinjaCopy\n        - Invoke-TokenManipulation\n        - Out-Minidump\n        - VolumeShadowCopyTools\n        - Invoke-ReflectivePEInjection\n        - Invoke-UserHunter\n        - Find-GPOLocation\n        - Invoke-ACLScanner\n        - Invoke-DowngradeAccount\n        - Get-ServiceUnquoted\n        - Get-ServiceFilePermission\n        - Get-ServicePermission\n        - Invoke-ServiceAbuse\n        - Install-ServiceBinary\n        - Get-RegAutoLogon\n        - Get-VulnAutoRun\n        - Get-VulnSchTask\n        - Get-UnattendedInstallFile\n        - Get-WebConfig\n        - Get-ApplicationHost\n        - Get-RegAlwaysInstallElevated\n        - Get-Unconstrained\n        - Add-RegBackdoor\n        - Add-ScrnSaveBackdoor\n        - Gupt-Backdoor\n        - Invoke-ADSBackdoor\n        - Enabled-DuplicateToken\n        - Invoke-PsUaCme\n        - Remove-Update\n        - Check-VM\n        - Get-LSASecret\n        - Get-PassHashes\n        - Invoke-Mimikatz\n        - Show-TargetScreen\n        - Port-Scan\n        - Invoke-PoshRatHttp\n        - Invoke-PowerShellTCP\n        - Invoke-PowerShellWMI\n        - Add-Exfiltration\n        - Add-Persistence\n        - Do-Exfiltration\n        - Start-CaptureServer\n        - Invoke-DllInjection\n        - Invoke-ReflectivePEInjection\n        - Invoke-ShellCode\n        - Get-ChromeDump\n        - Get-ClipboardContents\n        - Get-FoxDump\n        - Get-IndexedItem\n        - Get-Keystrokes\n        - Get-Screenshot\n        - Invoke-Inveigh\n        - Invoke-NetRipper\n        - Invoke-NinjaCopy\n        - Out-Minidump\n        - Invoke-EgressCheck\n        - Invoke-PostExfil\n        - Invoke-PSInject\n        - Invoke-RunAs\n        - MailRaider\n        - New-HoneyHash\n        - Set-MacAttribute\n        - Get-VaultCredential\n        - Invoke-DCSync\n        - Invoke-Mimikatz\n        - Invoke-PowerDump\n        - Invoke-TokenManipulation\n        - Exploit-Jboss\n        - Invoke-ThunderStruck\n        - Invoke-VoiceTroll\n        - Set-Wallpaper\n        - Invoke-InveighRelay\n        - Invoke-PsExec\n        - Invoke-SSHCommand\n        - Get-SecurityPackages\n        - Install-SSP\n        - Invoke-BackdoorLNK\n        - PowerBreach\n        - Get-GPPPassword\n        - Get-SiteListPassword\n        - Get-System\n        - Invoke-BypassUAC\n        - Invoke-Tater\n        - Invoke-WScriptBypassUAC\n        - PowerUp\n        - PowerView\n        - Get-RickAstley\n        - Find-Fruit\n        - HTTP-Login\n        - Find-TrustedDocuments\n        - Invoke-Paranoia\n        - Invoke-WinEnum\n        - Invoke-ARPScan\n        - Invoke-PortScan\n        - Invoke-ReverseDNSLookup\n        - Invoke-SMBScanner\n        - Invoke-Mimikittenz\n    condition: keywords\nfalsepositives:\n    - Penetration testing\nlevel: high\n","git_filepath":"/windows/powershell/powershell_malicious_commandlets.yml","hash":"dcbdb4b9a5438f31b81abdf87350e631356819552ffab73bffb0e25243e28019","author_keyword":"Sean Metcalf (source), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"ulbKm2YByorp5hYiY_xv","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.173975","user_id":null,"author":"Sean Metcalf (source), Florian Roth (rule)","title":"Malicious PowerShell Keywords","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malicious PowerShell Keywords","released":"2018-10-22T12:40:24.173973","sigma_text":"title: Malicious PowerShell Keywords\nstatus: experimental\ndescription: Detects keywords from well-known PowerShell exploitation frameworks\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        - AdjustTokenPrivileges\n        - IMAGE_NT_OPTIONAL_HDR64_MAGIC\n        - Management.Automation.RuntimeException\n        - Microsoft.Win32.UnsafeNativeMethods\n        - ReadProcessMemory.Invoke\n        - Runtime.InteropServices\n        - SE_PRIVILEGE_ENABLED\n        - System.Security.Cryptography\n        - System.Runtime.InteropServices\n        - LSA_UNICODE_STRING\n        - MiniDumpWriteDump\n        - PAGE_EXECUTE_READ\n        - Net.Sockets.SocketFlags\n        - Reflection.Assembly\n        - SECURITY_DELEGATION\n        - TOKEN_ADJUST_PRIVILEGES\n        - TOKEN_ALL_ACCESS\n        - TOKEN_ASSIGN_PRIMARY\n        - TOKEN_DUPLICATE\n        - TOKEN_ELEVATION\n        - TOKEN_IMPERSONATE\n        - TOKEN_INFORMATION_CLASS\n        - TOKEN_PRIVILEGES\n        - TOKEN_QUERY\n        - Metasploit\n        - Mimikatz\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n","git_filepath":"/windows/powershell/powershell_malicious_keywords.yml","hash":"2c4b75d57ac0f01a007ad9448c554bbd5e6caababe6830fa87de3d4b28ed384d","author_keyword":"Sean Metcalf (source), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"v1bKm2YByorp5hYiY_yz","_score":1,"_source":{"status":"","category":12,"updated":"2018-10-22T12:40:24.242201","user_id":null,"author":"Florian Roth","title":"Antivirus Web Shell Detection","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Antivirus Web Shell Detection","released":"2018-10-22T12:40:24.242199","sigma_text":"title: Antivirus Web Shell Detection\ndescription: Detects a highly relevant Antivirus alert that reports a web shell\ndate: 2018/09/09\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.persistence\n    - attack.t1100\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - PHP/Backdoor\n            - JSP/Backdoor\n            - ASP/Backdoor\n            - Backdoor.PHP\n            - Backdoor.JSP\n            - Backdoor.ASP\n            - \"*Webshell*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/windows/malware/av_webshell.yml","hash":"7f9eb6549fd5016298596fb882b9520fce93afaa1f28ee404db02d4700878e6e","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"wFbKm2YByorp5hYiY_zE","_score":1,"_source":{"status":"","category":12,"updated":"2018-10-22T12:40:24.258511","user_id":null,"author":"Florian Roth","title":"Antivirus Exploitation Framework Detection","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Antivirus Exploitation Framework Detection","released":"2018-10-22T12:40:24.258509","sigma_text":"title: Antivirus Exploitation Framework Detection\ndescription: Detects an Antivirus alert in a highly relevant file path or with a relevant file name\ndate: 2018/09/09\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        FileName:\n            - 'C:\\Windows\\Temp\\*'\n            - 'C:\\Temp\\*'\n            - '*\\\\Client\\*'\n            - 'C:\\PerfLogs\\*'\n            - 'C:\\Users\\Public\\*'\n            - 'C:\\Users\\Default\\*'\n            - '*.ps1'\n            - '*.vbs'\n            - '*.bat'\n            - '*.chm'\n            - '*.xml'\n            - '*.txt'\n            - '*.jsp'\n            - '*.jspx'\n            - '*.asp'\n            - '*.aspx'\n            - '*.php'\n            - '*.war'\n    condition: selection\nfields:\n    - Signature\n    - User\nfalsepositives:\n    - Unlikely\nlevel: high\n","git_filepath":"/windows/malware/av_relevant_files.yml","hash":"174c24d90fdfddf6725b02b5418d4fa8980315f2d19c8be9bac930a04aa8f5f9","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"wlbKm2YByorp5hYiY_zd","_score":1,"_source":{"status":"","category":12,"updated":"2018-10-22T12:40:24.283921","user_id":null,"author":"Florian Roth","title":"Antivirus Password Dumper Detection","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Antivirus Password Dumper Detection","released":"2018-10-22T12:40:24.283918","sigma_text":"title: Antivirus Password Dumper Detection\ndescription: Detects a highly relevant Antivirus alert that reports a password dumper\ndate: 2018/09/09\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - \"*DumpCreds*\"\n            - \"*Mimikatz*\"\n            - \"*PWCrack*\"\n            - \"HTool/WCE\"\n            - \"*PSWtool*\"\n            - \"*PWDump*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/windows/malware/av_password_dumper.yml","hash":"0315768fa4e7f8b156c5427bda82cc3efed000afac821bf2306dd935d1981ce4","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"xFbKm2YByorp5hYiY_zx","_score":1,"_source":{"status":"experimental","category":13,"updated":"2018-10-22T12:40:24.304216","user_id":null,"author":"Florian Roth","title":"Rare Scheduled Task Creations","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Rare Scheduled Task Creations","released":"2018-10-22T12:40:24.304212","sigma_text":"title: Rare Scheduled Task Creations\nstatus: experimental\ndescription: This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names. \ntags:\n    - attack.t1053\n    - attack.s0111\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: taskscheduler\ndetection:\n    selection:\n        EventID: 106\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5 \nfalsepositives:\n    - Software installation\nlevel: low\n","git_filepath":"/windows/other/win_rare_schtask_creation.yml","hash":"476df58e23ad12f31c12b536b02c1e5e09329d0a3c19fbbc608b9bab13d64e6b","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"yFbKm2YByorp5hYiZPwX","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.341931","user_id":null,"author":null,"title":"Mimikatz In-Memory","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Mimikatz In-Memory","released":"2018-10-22T12:40:24.341929","sigma_text":"title: Mimikatz In-Memory\nstatus: experimental\ndescription: Detects certain DLL loads when Mimikatz gets executed\nreferences:\n    - https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/\ntags:\n    - attack.s0002\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selector:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\rundll32.exe'\n    dllload1:\n        ImageLoaded: '*\\vaultcli.dll'\n    dllload2:\n        ImageLoaded: '*\\wlanapi.dll'        \n    exclusion:\n        ImageLoaded:\n            - 'ntdsapi.dll'\n            - 'netapi32.dll'\n            - 'imm32.dll'\n            - 'samlib.dll'\n            - 'combase.dll'\n            - 'srvcli.dll'\n            - 'shcore.dll'\n            - 'ntasn1.dll'\n            - 'cryptdll.dll'\n            - 'logoncli.dll'\n    timeframe: 30s\n    condition: selector | near dllload1 and dllload2 and not exclusion\nfalsepositives:\n    - unknown\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_mimikatz_inmemory_detection.yml","hash":"b90dc674e0ee126ea792ddde5622d57b31889aa790259a606ad44b36e3b9d87e","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"zlbKm2YByorp5hYiZPxc","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.411276","user_id":null,"author":"Florian Roth","title":"Suspicious TSCON Start","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious TSCON Start","released":"2018-10-22T12:40:24.411274","sigma_text":"title: Suspicious TSCON Start\nstatus: experimental\ndescription: Detects a tscon.exe start as LOCAL SYSTEM \nreference: \n    - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\n    - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\nauthor: Florian Roth\ndate: 2018/03/17\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        User: 'NT AUTHORITY\\SYSTEM'\n        Image: '*\\tscon.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_tscon_localsystem.yml","hash":"a71bbdd96405a5007f15550cbf65bcd584896858229a742b85a32d7397c590ef","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"0VbKm2YByorp5hYiZPya","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.470702","user_id":null,"author":"Florian Roth","title":"PowerShell Download from URL","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"PowerShell Download from URL","released":"2018-10-22T12:40:24.470700","sigma_text":"title: PowerShell Download from URL\nstatus: experimental\ndescription: Detects a Powershell process that contains download commands in its command line string\nauthor: Florian Roth\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\powershell.exe'\n        CommandLine: \n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_powershell_download.yml","hash":"70022404dae265acca340fed64241d7db531fe892f15e214d9f80a16919ab2be","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"01bKm2YByorp5hYiZPy5","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.502150","user_id":null,"author":"Florian Roth, Michael Haag","title":"Activity Related to NTDS.dit Domain Hash Retrieval","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Activity Related to NTDS.dit Domain Hash Retrieval","released":"2018-10-22T12:40:24.502148","sigma_text":"title: Activity Related to NTDS.dit Domain Hash Retrieval\nstatus: experimental\ndescription: Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely \nauthor: Florian Roth, Michael Haag\nreferences:\n    - https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\n    - https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/\n    - https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/\n    - https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            # Ransomware\n            - 'vssadmin.exe Delete Shadows'\n            # Hacking \n            - 'vssadmin create shadow /for=C:'\n            - 'copy \\\\?\\GLOBALROOT\\Device\\*\\windows\\ntds\\ntds.dit'\n            - 'copy \\\\?\\GLOBALROOT\\Device\\*\\config\\SAM'\n            - 'vssadmin delete shadows /for=C:'\n            - 'reg SAVE HKLM\\SYSTEM '\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.credential_access\n    - attack.t1003\nfalsepositives:\n    - Administrative activity\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_vssadmin_ntds_activity.yml","hash":"bde9628a2968094e8679a49bf6ddebaca0221812249e3034abd9500286df7d3e","author_keyword":"Florian Roth, Michael Haag","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"1lbKm2YByorp5hYiZPzm","_score":1,"_source":{"status":"stable","category":15,"updated":"2018-10-22T12:40:24.549463","user_id":null,"author":"Thomas Patzke","title":"Password Dumper Remote Thread in LSASS","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Password Dumper Remote Thread in LSASS","released":"2018-10-22T12:40:24.549460","sigma_text":"title: Password Dumper Remote Thread in LSASS \ndescription: Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundreds of events.\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm\nstatus: stable\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        TargetImage: 'C:\\Windows\\System32\\lsass.exe'\n        StartModule: null\n    condition: selection\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_password_dumper_lsass.yml","hash":"6e1926cef24fc326041dce8e79fe7776116b15b21a5387e5d8ba823d72cc764e","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"11bKm2YByorp5hYiZPzw","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.558537","user_id":null,"author":"Florian Roth","title":"Office Macro Starts Cmd","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Office Macro Starts Cmd","released":"2018-10-22T12:40:24.558534","sigma_text":"title: Office Macro Starts Cmd\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Word or Excel \nreferences:\n    - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: \n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n        Image: '*\\cmd.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_office_macro_cmd.yml","hash":"531f716975f057d96c8f66a7400bc3d93db90e76ade05f398061254d24f5fd64","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"2FbKm2YByorp5hYiZPz7","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.570311","user_id":null,"author":"Florian Roth","title":"PowerShell Rundll32 Remote Thread Creation","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"PowerShell Rundll32 Remote Thread Creation","released":"2018-10-22T12:40:24.570308","sigma_text":"title: PowerShell Rundll32 Remote Thread Creation\nstatus: experimental\ndescription: Detects PowerShell remote thread creation in Rundll32.exe \nauthor: Florian Roth\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html\ndate: 2018/06/25\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        SourceImage: '*\\powershell.exe'\n        TargetImage: '*\\rundll32.exe'\n    condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\n    - attack.t1086\nfalsepositives:\n    - Unkown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_powershell_rundll32.yml","hash":"b8070676d7685a0181f069d621e72b670e5a2acab4f7a07c7402bc4f7a05061a","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"2VbKm2YByorp5hYiZfwG","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.581103","user_id":null,"author":"Michael Haag","title":"Bitsadmin Download","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Bitsadmin Download","released":"2018-10-22T12:40:24.581101","sigma_text":"title: Bitsadmin Download\nstatus: experimental\ndescription: Detects usage of bitsadmin downloading a file\nreferences:\n    - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n    - https://isc.sans.edu/diary/22264\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1197\n    - attack.s0190\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\bitsadmin.exe'\n        CommandLine:\n            - '/transfer'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Some legitimate apps use this, but limited.\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_bitsadmin_download.yml","hash":"eca1df441f1e8217d7cc17622a5029f89d9014b606e913d74a0d9f0bf31d37bb","author_keyword":"Michael Haag","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"2lbKm2YByorp5hYiZfwQ","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.590874","user_id":null,"author":"Florian Roth","title":"System File Execution Location Anomaly","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"System File Execution Location Anomaly","released":"2018-10-22T12:40:24.590872","sigma_text":"title: System File Execution Location Anomaly\nstatus: experimental\ndescription: Detects a Windows program executable started in a suspicious folder\nreferences:\n    - https://twitter.com/GelosSnake/status/934900723426439170\nauthor: Florian Roth\ndate: 2017/11/27\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\svchost.exe'\n            - '*\\rundll32.exe'\n            - '*\\services.exe'\n            - '*\\powershell.exe'\n            - '*\\regsvr32.exe'\n            - '*\\spoolsv.exe'\n            - '*\\lsass.exe'\n            - '*\\smss.exe'\n            - '*\\csrss.exe'\n            - '*\\conhost.exe'\n    filter:\n        Image: \n            - '*\\System32\\*'\n            - '*\\SysWow64\\*'\n    condition: selection and not filter\ntags:\n    - attack.defense_evasion\nfalsepositives:\n    - Exotic software\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_system_exe_anomaly.yml","hash":"0466738be5df4527821c157f0ecef3eedaed51ca45bbe06598f62ea7e80366f1","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"3VbKm2YByorp5hYiZfxW","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.661095","user_id":null,"author":"Florian Roth","title":"Execution in Non-Executable Folder","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Execution in Non-Executable Folder","released":"2018-10-22T12:40:24.661092","sigma_text":"title: Execution in Non-Executable Folder\nstatus: experimental\ndescription: Detects a suspicious exection from an uncommon folder\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: \n            - '*\\$Recycle.bin'\n            - '*\\Users\\All Users\\*'\n            - '*\\Users\\Default\\*'\n            - '*\\Users\\Public\\*'\n            - 'C:\\Perflogs\\*'\n            - '*\\config\\systemprofile\\*'\n            - '*\\Windows\\Fonts\\*'\n            - '*\\Windows\\IME\\*'\n            - '*\\Windows\\addins\\*'       \n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_execution_path.yml","hash":"50694844328ebc63f6c1f91028ce2c9dc062085ea24f268c22d4559c65e3fdab","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"3lbKm2YByorp5hYiZfzg","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.766880","user_id":null,"author":"Sami Ruohonen","title":"Hiding files with attrib.exe","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Hiding files with attrib.exe","released":"2018-10-22T12:40:24.766877","sigma_text":"title: Hiding files with attrib.exe\nstatus: experimental\ndescription: Detects usage of attrib.exe to hide files from users.\nauthor: Sami Ruohonen\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\attrib.exe'\n        CommandLine: '* +h *'\n    ini:\n        CommandLine: '*\\desktop.ini *'\n    intel:\n        ParentImage: '*\\cmd.exe'\n        CommandLine: '+R +H +S +A \\*.cui'\n        ParentCommandLine: 'C:\\WINDOWS\\system32\\\\*.bat'\n    condition: selection and not (ini or intel)\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1158\nfalsepositives:\n    - igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)\n    - msiexec.exe hiding desktop.ini\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_attrib_hiding_files.yml","hash":"120066968628976d587bf2d7e71150e81d0c3226624f920c8af73dc7d84c2296","author_keyword":"Sami Ruohonen","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"4FbKm2YByorp5hYiZvwE","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.834714","user_id":null,"author":"Florian Roth","title":"PowerShell Network Connections","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"PowerShell Network Connections","released":"2018-10-22T12:40:24.834711","sigma_text":"title: PowerShell Network Connections\nstatus: experimental\ndescription: \"Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')\"  \nauthor: Florian Roth\nreferences:\n    - https://www.youtube.com/watch?v=DLtJTxMWZ2o\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\powershell.exe'\n    filter:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.*'\n            - '127.0.0.1'\n        DestinationIsIpv6: 'false'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative scripts\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_powershell_network_connection.yml","hash":"c19854fbb30d748239328a27b8e53accea9b1ec01b91d71e51f3fe05f861cc26","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"4VbKm2YByorp5hYiZvwe","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.860482","user_id":null,"author":"Margaritis Dimitrios (idea), Florian Roth (rule)","title":"WScript or CScript Dropper","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"WScript or CScript Dropper","released":"2018-10-22T12:40:24.860478","sigma_text":"title: WScript or CScript Dropper\nstatus: experimental\ndescription: Detects wscript/cscript executions of scripts located in user directories\nauthor: Margaritis Dimitrios (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '* C:\\Users\\*.jse *'\n            - '* C:\\Users\\*.vbe *'\n            - '* C:\\Users\\*.js *'\n            - '* C:\\Users\\*.vba *'\n            - '* C:\\Users\\*.vbs *'\n            - '* C:\\ProgramData\\*.jse *'\n            - '* C:\\ProgramData\\*.vbe *'\n            - '* C:\\ProgramData\\*.js *'\n            - '* C:\\ProgramData\\*.vba *'\n            - '* C:\\ProgramData\\*.vbs *'\n    falsepositive:\n        ParentImage: '*\\winzip*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Winzip\n    - Other self-extractors\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_malware_script_dropper.yml","hash":"45ac9f5b2866ca0785ea3cda7207b9104a0321680f8b27a56673dee04da9071a","author_keyword":"Margaritis Dimitrios (idea), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"4lbKm2YByorp5hYiZvwx","_score":1,"_source":{"status":"","category":null,"updated":"2018-10-22T12:40:24.879928","user_id":null,"author":"Karneades","title":"Registry Persistence Mechanisms","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Registry Persistence Mechanisms","released":"2018-10-22T12:40:24.879926","sigma_text":"title: Registry Persistence Mechanisms\ndescription: Detects persistence registry keys \nreferences:\n    - https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\ndate: 2018/04/11\nauthor: Karneades\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection_reg1:\n        EventID: 13 \n        TargetObject: \n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\*\\GlobalFlag'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\ReportingMode'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\MonitorProcess'\n        EventType: 'SetValue'\n    condition: 1 of them\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.defense_evasion\n    - attack.t1183\nfalsepositives:\n    - unknown\nlevel: critical\n","git_filepath":null,"hash":"6e6833e25f8912e4a62651b9606d161f975d97756093dd38ea3822f670552f2c","author_keyword":"Karneades","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"5VbKm2YByorp5hYiZvxS","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:24.912101","user_id":null,"author":"Florian Roth","title":"Java Running with Remote Debugging","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Java Running with Remote Debugging","released":"2018-10-22T12:40:24.912099","sigma_text":"title: Java Running with Remote Debugging\ndescription: Detects a JAVA process running with remote debugging allowing more than just localhost to connect\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: '*transport=dt_socket,address=*'\n    exclusion:\n        - CommandLine: '*address=127.0.0.1*'\n        - CommandLine: '*address=localhost*'\n    condition: selection and not exclusion\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_vul_java_remote_debugging.yml","hash":"597ffd33397eb7d2dcc8b3f2ab280edbcc0c990828c8155585e4b93d5bad643c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"6VbKm2YByorp5hYiZvyG","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.964873","user_id":null,"author":"John Lambert (tech), Florian Roth (rule)","title":"Malware Shellcode in Verclsid Target Process","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malware Shellcode in Verclsid Target Process","released":"2018-10-22T12:40:24.964869","sigma_text":"title: Malware Shellcode in Verclsid Target Process\nstatus: experimental\ndescription: Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro\nreferences:\n    - https://twitter.com/JohnLaTwC/status/837743453039534080\nauthor: John Lambert (tech), Florian Roth (rule)\ndate: 2017/03/04\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: '*\\verclsid.exe'\n        GrantedAccess: '0x1FFFFF'\n    combination1:\n        CallTrace: '*|UNKNOWN(*VBE7.DLL*'\n    combination2:\n        SourceImage: '*\\Microsoft Office\\*'\n        CallTrace: '*|UNKNOWN*'\n    condition: selection and 1 of combination*\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_malware_verclsid_shellcode.yml","hash":"b5feb2d62908b7670d1d7822ddf1db719c077912752863e0062cc8a64c305f7e","author_keyword":"John Lambert (tech), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"71bKm2YByorp5hYiZ_wO","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.100920","user_id":null,"author":"Markus Neis","title":"Possible Shim Database Persistence via sdbinst.exe","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Possible Shim Database Persistence via sdbinst.exe","released":"2018-10-22T12:40:25.100917","sigma_text":"title: Possible Shim Database Persistence via sdbinst.exe \nstatus: experimental\ndescription: Detects execution of sdbinst writing to default shim database path C:\\Windows\\AppPatch\\*\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\ntags:\n    - attack.persistence\n    - attack.t1138\nauthor: Markus Neis\ndate: 2018-08-03\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n      EventID: 1\n      Image:\n      - '*\\sdbinst.exe'\n      CommandLine: \n        - '*\\AppPatch\\*}.sdb*'            \n    condition: selection\nfalsepositives:\n    - Unknown \nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_sdbinst_shim_persistence.yml","hash":"68ead2d1ec38d5299c33f3f1a9d4c7e02e3857705e3594b79cd23dc152222fb0","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"8lbKm2YByorp5hYiZ_w-","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.148000","user_id":null,"author":"Markus Neis","title":"Powershell AMSI Bypass via .NET Reflection","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Powershell AMSI Bypass via .NET Reflection","released":"2018-10-22T12:40:25.147997","sigma_text":"title: Powershell AMSI Bypass via .NET Reflection  \nstatus: experimental\ndescription: Detects Request to amsiInitFailed that can be used to disable AMSI Scanning\nreferences:\n    - https://twitter.com/mattifestation/status/735261176745988096\n    - https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/08/17\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        CommandLine:\n            - '*System.Management.Automation.AmsiUtils*'\n    selection2:\n        CommandLine:\n            - '*amsiInitFailed*'            \n    condition: selection1 and selection2\n    falsepositives:\n    - Potential Admin Activity \nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_powershell_amsi_bypass.yml","hash":"f7d7bd8d3d2b884a4909feda5c383e79d29e6426c5ff3c04dc600a5a6bdeb006","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"9FbKm2YByorp5hYiZ_x6","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.209199","user_id":null,"author":"Thomas Patzke","title":"WMI Persistence - Command Line Event Consumer","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"WMI Persistence - Command Line Event Consumer","released":"2018-10-22T12:40:25.209197","sigma_text":"title: WMI Persistence - Command Line Event Consumer\nstatus: experimental\ndescription: Detects WMI command line event consumers\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\ntags:\n    - attack.t1084\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe'\n        ImageLoaded: 'wbemcons.dll'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_wmi_persistence_commandline_event_consumer.yml","hash":"3a2aeec16c5213f6d3679ec8076b8009ca72338f2319d0a6327ccda3aaab7431","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"9lbKm2YByorp5hYiZ_zv","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.302140","user_id":null,"author":"Florian Roth","title":"Malicious Named Pipe","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Malicious Named Pipe","released":"2018-10-22T12:40:25.302137","sigma_text":"title: Malicious Named Pipe\nstatus: experimental\ndescription: Detects the creation of a named pipe used by known APT malware\nreferences:\n    - Various sources\ndate: 2017/11/06\nauthor: Florian Roth\nlogsource:\n   product: windows\n   service: sysmon\n   description: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n   selection:\n      EventID: \n         - 17\n         - 18\n      PipeName: \n         - '\\isapi_http'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg2'  # Uroburos Malware Named Pipe\n         - '\\sdlrpc'  # Cobra Trojan Named Pipe http://goo.gl/8rOZUX\n         - '\\ahexec'  # Sofacy group malware\n         - '\\winsession'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\lsassw'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\46a676ab7f179e511e30dd2dc41bd388'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\9f81f59bc58452127884ce513865ed20'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\e710f28d59aa529d6792ca6ff0ca1b34'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\rpchlp_3'  # Project Sauron https://goo.gl/eFoP4A - Technical Analysis Input\n         - '\\NamePipe_MoreWindows'  # Cloud Hopper Annex B https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf, US-CERT Alert - RedLeaves https://www.us-cert.gov/ncas/alerts/TA17-117A\n         - '\\pcheap_reuse'  # Pipe used by Equation Group malware 77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\n   condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.privelege_escalation\n    - attack.t1055\nfalsepositives:\n   - Unkown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_mal_namedpipes.yml","hash":"67ab4db9dce40eda0aab311191dcc81b89603e36721a1062342fa91b77ee6910","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"91bKm2YByorp5hYiaPwb","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.363228","user_id":null,"author":"Markus Neis","title":"Usage of Sysinternals Tools","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Usage of Sysinternals Tools","released":"2018-10-22T12:40:25.363225","sigma_text":"title: Usage of Sysinternals Tools \r\nstatus: experimental\r\ndescription: Detects the usage of Sysinternals Tools due to accepteula key beeing added to Registry \r\nreferences:\r\n    - https://twitter.com/Moti_B/status/1008587936735035392\r\ndate: 2017/08/28\r\nauthor: Markus Neis\r\nlogsource:\r\n    product: windows\r\n    service: sysmon\r\ndetection:\r\n    selection:\r\n        EventID: 13\r\n        TargetObject: '*\\EulaAccepted'\r\n    condition: selection\r\nfalsepositives:\r\n    - Legitimate use of SysInternals tools\r\n    - Programs that use the same Registry Key\r\nlevel: low\r\n","git_filepath":"/windows/sysmon/sysmon_sysinternals_eula_accepted.yml","hash":"52bc8f011f06437c7ffdbc7a871c550775f71b308423e4a35421f10e9e6e6f03","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"-FbKm2YByorp5hYiaPw9","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.403890","user_id":null,"author":"Florian Roth, Markus Neis","title":"New RUN Key Pointing to Suspicious Folder","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"New RUN Key Pointing to Suspicious Folder","released":"2018-10-22T12:40:25.403888","sigma_text":"title: New RUN Key Pointing to Suspicious Folder\nstatus: experimental\ndescription: Detects suspicious new RUN key element pointing to an executable in a suspicious folder\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\nauthor: Florian Roth, Markus Neis\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2018/25/08\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: \n          - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\*'\n          - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\*'\n        Details:\n          - 'C:\\Windows\\Temp\\*'\n          - '*\\AppData\\*'\n          - 'C:\\$Recycle.bin\\*'\n          - 'C:\\Temp\\*'\n          - 'C:\\Users\\Public\\*'\n          - 'C:\\Users\\Default\\*'\n          - 'C:\\Users\\Desktop\\*'\n    condition: selection\nfields:\n    - Image\nfalsepositives:\n    - Software with rare behaviour\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_run_key_img_folder.yml","hash":"871da6ac7c383d3fdf02b0294507f07a64ae2631809a4a1da25e473af968b90a","author_keyword":"Florian Roth, Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"-lbKm2YByorp5hYiaPxz","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.454759","user_id":null,"author":null,"title":"Mimikatz Detection LSASS Access","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Mimikatz Detection LSASS Access","released":"2018-10-22T12:40:25.454757","sigma_text":"title: Mimikatz Detection LSASS Access\nstatus: experimental\ndescription: Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION, 0x0010 PROCESS_VM_READ)\nreferences:\n    - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\ntags:\n    - attack.t1003\n    - attack.s0002\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: 'C:\\windows\\system32\\lsass.exe'\n        GrantedAccess: '0x1410'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_mimikatz_detection_lsass.yml","hash":"97a9dc97277043df431ef0f654c00fae58f305cf8bdd2d4277c55ce3bc492713","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"-1bKm2YByorp5hYiaPyL","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.479484","user_id":null,"author":"Florian Roth","title":"Microsoft Outlook Spawning Windows Shell","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Outlook Spawning Windows Shell","released":"2018-10-22T12:40:25.479482","sigma_text":"title: Microsoft Outlook Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Outlook\nreferences:\n    - https://www2.cybereason.com/asset/60:research-cobalt-kitty-attack-lifecycle\nauthor: Florian Roth\ndate: 2018/03/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\schtasks.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - False positives are possible, depends on organisation and processes\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_outlook_shell.yml","hash":"f8aacb12262552a81115ebe82e10f7be90a1f902fd885f485560e60f5354f3a6","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"_FbKm2YByorp5hYiaPym","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:25.508330","user_id":null,"author":"Florian Roth","title":"Exploit for CVE-2017-8759","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Exploit for CVE-2017-8759","released":"2018-10-22T12:40:25.508317","sigma_text":"title: Exploit for CVE-2017-8759 \ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759\nreferences:\n  - https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\n  - https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\nauthor: Florian Roth\ndate: 15.09.2017\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\csc.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_exploit_cve_2017_8759.yml","hash":"fe4e5584feca381b99fe09991786be565f118ab7343e71ecdea5e4a403264f1e","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"_VbKm2YByorp5hYiaPzB","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.536086","user_id":null,"author":"Thomas Patzke","title":"Shells Spawned by Web Servers","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Shells Spawned by Web Servers","released":"2018-10-22T12:40:25.536084","sigma_text":"title: Shells Spawned by Web Servers\nstatus: experimental\ndescription: Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\w3wp.exe'\n            - '*\\httpd.exe'\n            - '*\\nginx.exe'\n            - '*\\php-cgi.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\powershell.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1100\nfalsepositives:\n    - Particular web applications may spawn a shell process legitimately\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_webshell_spawn.yml","hash":"6f2d8a8b64610c1c206e334c03728afedc04c7be7c7c5a97242f1f5d115baee7","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"AFbKm2YByorp5hYiaP3w","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.582831","user_id":null,"author":"Thomas Patzke","title":"WMI Persistence - Script Event Consumer File Write","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"WMI Persistence - Script Event Consumer File Write","released":"2018-10-22T12:40:25.582828","sigma_text":"title: WMI Persistence - Script Event Consumer File Write\nstatus: experimental\ndescription: Detects file writes of WMI script event consumer\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\ntags:\n    - attack.t1084\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        Image: 'C:\\WINDOWS\\system32\\wbem\\scrcons.exe'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_wmi_persistence_script_event_consumer_write.yml","hash":"920ba3324520f89c807e448ca877d1e2cc38207671b7dfe0a99132a6a93504d7","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"AlbKm2YByorp5hYiaf0H","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.606382","user_id":null,"author":"Florian Roth","title":"Execution in Webserver Root Folder","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Execution in Webserver Root Folder","released":"2018-10-22T12:40:25.606380","sigma_text":"title: Execution in Webserver Root Folder\nstatus: experimental\ndescription: Detects a suspicious program execution in a web service root folder (filter out false positives)\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: \n            - '*\\wwwroot\\*'\n            - '*\\wmpub\\*'\n            - '*\\htdocs\\*'          \n    filter:\n        Image: \n            - '*bin\\*'\n            - '*\\Tools\\*'\n            - '*\\SMSComponent\\*'\n        ParentImage:\n            - '*\\services.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Various applications\n    - Tools that include ping or nslookup command invocations\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_execution_path_webserver.yml","hash":"3cab2c2fe19eb3dcd79c3e3b128c7e6853678254324f7a0f9f59dd1a1adf4872","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"A1bKm2YByorp5hYiaf0O","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:25.613637","user_id":null,"author":"Florian Roth","title":"Suspicious Driver Load from Temp","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious Driver Load from Temp","released":"2018-10-22T12:40:25.613634","sigma_text":"title: Suspicious Driver Load from Temp\ndescription: Detects a driver load from a temporary directory\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 6\n        ImageLoaded: '*\\Temp\\*'\n    condition: selection\nfalsepositives:\n    - there is a relevant set of false positives depending on applications in the environment \nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_driver_load.yml","hash":"dd27e1d591dfd4dff32734db8df45a35b19eb5bd40684a4f43965bc15639d890","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"B1bKm2YByorp5hYiaf2S","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.744927","user_id":null,"author":"jmallette","title":"Cmdkey Cached Credentials Recon","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Cmdkey Cached Credentials Recon","released":"2018-10-22T12:40:25.744925","sigma_text":"title: Cmdkey Cached Credentials Recon\nstatus: experimental\ndescription: Detects usage of cmdkey to look for cached credentials\nreference: \n    - https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\n    - https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx\nauthor: jmallette\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\cmdkey.exe'\n        CommandLine: '* /list *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\nfalsepositives:\n    - Legitimate administrative tasks.\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_cmdkey_recon.yml","hash":"d4a8342cbf318afe8b330501e54c435e313b71b241b47c91f70f1a13960c9c1f","author_keyword":"jmallette","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"DVbKm2YByorp5hYiaf3o","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:25.831084","user_id":null,"author":"Florian Roth","title":"Webshell Detection With Command Line Keywords","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Webshell Detection With Command Line Keywords","released":"2018-10-22T12:40:25.831081","sigma_text":"title: Webshell Detection With Command Line Keywords\ndescription: Detects certain command line parameters often used during reconnaissance activity via web shells\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n          - '*\\apache*'\n          - '*\\tomcat*'\n          - '*\\w3wp.exe'\n          - '*\\php-cgi.exe'\n          - '*\\nginx.exe'\n          - '*\\httpd.exe'\n        CommandLine:\n          - 'whoami'\n          - 'net user'\n          - 'ping -n'\n          - 'systeminfo'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1100\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_webshell_detection.yml","hash":"2956fcfd173c6bbd9f7bb5b36bce9bc38dd14efe643dcacab6e6ef55b927adfa","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"EFbKm2YByorp5hYiav0Q","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.870591","user_id":null,"author":"Florian Roth","title":"Scheduled Task Creation","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Scheduled Task Creation","released":"2018-10-22T12:40:25.870588","sigma_text":"title: Scheduled Task Creation\nstatus: experimental\ndescription: Detects the creation of scheduled tasks in user session \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\schtasks.exe'\n        CommandLine: '* /create *'\n    filter:\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.privelege_escalation\n    - attack.t1053\n    - attack.s0111\nfalsepositives:\n    - Administrative activity\n    - Software installation\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_susp_schtask_creation.yml","hash":"406381faf539307ad29a47397b482eb5aad058f7f7f559d7592c5abf534ad6f8","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"FFbKm2YByorp5hYia_14","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:26.231354","user_id":null,"author":"Florian Roth","title":"Suspicious PowerShell Invocation based on Parent Process","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious PowerShell Invocation based on Parent Process","released":"2018-10-22T12:40:26.231352","sigma_text":"title: Suspicious PowerShell Invocation based on Parent Process\nstatus: experimental\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\nauthor: Florian Roth\nreferences:\n    - https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        Image:\n            - '*\\powershell.exe'\n    falsepositive:\n        CurrentDirectory: '*\\Health Service State\\*'\n    condition: selection and not falsepositive\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Microsoft Operations Manager (MOM)\n    - Other scripts\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_powershell_parent_combo.yml","hash":"cf44db7087aa705a1af7964a7ea1cac0f44e00e813c720f57735532a2573c80e","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"F1bKm2YByorp5hYia_23","_score":1,"_source":{"status":"","category":10,"updated":"2018-10-22T12:40:26.292427","user_id":null,"author":null,"title":"Multiple Modsecurity Blocks","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Multiple Modsecurity Blocks","released":"2018-10-22T12:40:26.292425","sigma_text":"title: Multiple Modsecurity Blocks\ndescription: Detects multiple blocks by the mod_security module (Web Application Firewall) \nlogsource:\n    product: linux\n    service: modsecurity\ndetection:\n    selection:\n        - 'mod_security: Access denied'\n        - 'ModSecurity: Access denied'\n        - 'mod_security-message: Access denied'\n    timeframe: 120m \n    condition: selection | count() > 6\nfalsepositives:\n    - Vulnerability scanners\n    - Frequent attacks if system faces Internet\nlevel: medium\n","git_filepath":"/linux/modsecurity/modsec_mulitple_blocks.yml","hash":"c5cf7aabef064bce0c70368a8755b1b63ae4ca5949a718b08f423d494f38b4ce","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"GVbKm2YByorp5hYia_3P","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.317954","user_id":null,"author":"Florian Roth","title":"Suspicious SSHD Error","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious SSHD Error","released":"2018-10-22T12:40:26.317952","sigma_text":"title: Suspicious SSHD Error\ndescription: Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/openssh/openssh-portable/blob/master/ssherr.c\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml\nauthor: Florian Roth\ndate: 2017/06/30\nlogsource:\n    product: linux\n    service: sshd\ndetection:\n    keywords:\n        - '*unexpected internal error*'\n        - '*unknown or unsupported key type*'\n        - '*invalid certificate signing key*'\n        - '*invalid elliptic curve value*'\n        - '*incorrect signature*'\n        - '*error in libcrypto*'\n        - '*unexpected bytes remain after decoding*'\n        - '*fatal: buffer_get_string: bad string*'\n        - '*Local: crc32 compensation attack*'\n        - '*bad client public DH value*'\n        - '*Corrupted MAC on input*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/linux/lnx_susp_ssh.yml","hash":"5d7cbf03995553e77db9da9118dedb7a7d979b9905bb7b16e1ffab537150ecd1","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"HFbKm2YByorp5hYia_3k","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.339448","user_id":null,"author":null,"title":"Relevant ClamAV Message","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Relevant ClamAV Message","released":"2018-10-22T12:40:26.339445","sigma_text":"title: Relevant ClamAV Message\ndescription: Detects relevant ClamAV messages\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml\nlogsource:\n    product: linux\n    service: clamav\ndetection:\n    keywords:\n        - 'Trojan*FOUND'\n        - 'VirTool*FOUND'\n        - 'Webshell*FOUND'\n        - 'Rootkit*FOUND'\n        - 'Htran*FOUND'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/linux/lnx_clamav.yml","hash":"7225a68b5e89ab9e53df07628b078cede7cad3330c8881aa15dbf841bf4d6103","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"HlbKm2YByorp5hYia_30","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.355140","user_id":null,"author":"Florian Roth","title":"Suspicious VSFTPD Error Messages","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious VSFTPD Error Messages","released":"2018-10-22T12:40:26.355137","sigma_text":"title: Suspicious VSFTPD Error Messages\ndescription: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/dagwieers/vsftpd/\nauthor: Florian Roth\ndate: 2017/07/05\nlogsource:\n    product: linux\n    service: vsftpd\ndetection:\n    keywords:\n        - 'Connection refused: too many sessions for this address.'\n        - 'Connection refused: tcp_wrappers denial.'\n        - 'Bad HTTP verb.'\n        - 'port and pasv both active'\n        - 'pasv and port both active'\n        - 'Transfer done (but failed to open directory).'\n        - 'Could not set file modification time.'\n        - 'bug: pid active in ptrace_sandbox_free'\n        - 'PTRACE_SETOPTIONS failure'\n        - 'weird status:'\n        - \"couldn't handle sandbox event\"\n        - 'syscall * out of bounds'\n        - 'syscall not permitted:'\n        - 'syscall validate failed:'\n        - 'Input line too long.'\n        - 'poor buffer accounting in str_netfd_alloc'\n        - 'vsf_sysutil_read_loop'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/linux/lnx_susp_vsftp.yml","hash":"f032d1128d52f2af5f2a11d18e75401074f6ff22482c57c84d76e5b8125602b4","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"JVbKm2YByorp5hYibP05","_score":1,"_source":{"status":"","category":1,"updated":"2018-10-22T12:40:26.423722","user_id":null,"author":"Thomas Patzke","title":"Django framework exceptions","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Django framework exceptions","released":"2018-10-22T12:40:26.423720","sigma_text":"title: Django framework exceptions\ndescription: Detects suspicious Django web application framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.djangoproject.com/en/1.11/ref/exceptions/\n    - https://docs.djangoproject.com/en/1.11/topics/logging/#django-security\nlogsource:\n    category: application\n    product: django\ndetection:\n    keywords:\n        - SuspiciousOperation\n        # Subclasses of SuspiciousOperation\n        - DisallowedHost\n        - DisallowedModelAdminLookup\n        - DisallowedModelAdminToField\n        - DisallowedRedirect\n        - InvalidSessionKey\n        - RequestDataTooBig\n        - SuspiciousFileOperation\n        - SuspiciousMultipartForm\n        - SuspiciousSession\n        - TooManyFieldsSent\n        # Further security-related exceptions\n        - PermissionDenied\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n","git_filepath":"/application/appframework_django_exceptions.yml","hash":"b63d176cddd09eba823355eb2ee8dbdebe25492b29f9c0ccceab31527a93d0c4","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"MlbKm2YByorp5hYibf0H","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.629407","user_id":null,"author":"Florian Roth","title":"ZxShell Malware","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"ZxShell Malware","released":"2018-10-22T12:40:26.629404","sigma_text":"title: ZxShell Malware\ndescription: Detects a ZxShell start by the called and well-known function name   \nauthor: Florian Roth\nreferences:\n    - https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\ntags:\n    - attack.g0001\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Command: \n            - 'rundll32.exe *,zxFunction*'\n            - 'rundll32.exe *,RemoteDiskXXXXX'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/apt/apt_zxshell.yml","hash":"34f89e7e42a4815e8065b651433e0b52da976a3109c56a6dcc52a94002f361b9","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"M1bKm2YByorp5hYibf0e","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.653177","user_id":null,"author":"Florian Roth","title":"Equation Group Indicators","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Equation Group Indicators","released":"2018-10-22T12:40:26.653174","sigma_text":"title: Equation Group Indicators\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\nreferences:\n    - https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\ntags:\n    - attack.execution\n    - attack.g0020\n    - attack.t1059\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # evolvingstrategy, elgingamble, estesfox\n        - 'chown root*chmod 4777 '\n        - 'cp /bin/sh .;chown'\n        # tmpwatch\n        - 'chmod 4777 /tmp/.scsi/dev/bin/gsh'\n        - 'chown root:root /tmp/.scsi/dev/bin/'\n        # estesfox\n        - 'chown root:root x;'\n        # ratload\n        - '/bin/telnet locip locport < /dev/console | /bin/sh'\n        - '/tmp/ratload'\n        # ewok\n        - 'ewok -t '\n        # xspy\n        - 'xspy -display '\n        # elatedmonkey\n        - 'cat > /dev/tcp/127.0.0.1/80 <<END'\n        # ftshell\n        - 'rm -f /current/tmp/ftshell.latest'\n        # ghost\n        - 'ghost_* -v '\n        # morerats client\n        - ' --wipe > /dev/null'\n        # noclient\n        - 'ping -c 2 *; grep * /proc/net/arp >/tmp/gx'\n        - 'iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;'\n        # auditcleaner\n        - '> /var/log/audit/audit.log; rm -f .'\n        - 'cp /var/log/audit/audit.log .tmp'\n        # reverse shell\n        - 'sh >/dev/tcp/* <&1 2>&1'\n        # packrat\n        - 'ncat -vv -l -p * <'\n        - 'nc -vv -l -p * <'\n        # empty bowl\n        - '< /dev/console | uudecode && uncompress'\n        - 'sendmail -osendmail;chmod +x sendmail'\n        # echowrecker\n        - '/usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron'\n        # dubmoat\n        - 'chmod 666 /var/run/utmp~'\n        # poptop\n        - 'chmod 700 nscd crond'\n        # abopscript\n        - 'cp /etc/shadow /tmp/.'\n        # ys\n        - '</dev/console |uudecode > /dev/null 2>&1 && uncompress'\n        # jacktelnet\n        - 'chmod 700 jp&&netstat -an|grep'\n        # others\n        - 'uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755'\n        - 'chmod 700 crond'\n        - 'wget http*; chmod +x /tmp/sendmail'\n        - 'chmod 700 fp sendmail pt'\n        - 'chmod 755 /usr/vmsys/bin/pipe'\n        - 'chmod -R 755 /usr/vmsys'\n        - 'chmod 755 $opbin/*tunnel'\n        - '< /dev/console | uudecode && uncompress'\n        - 'chmod 700 sendmail'\n        - 'chmod 0700 sendmail'\n        - '/usr/bin/wget http*sendmail;chmod +x sendmail;'\n        - '&& telnet * 2>&1 </dev/console'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/apt/apt_equationgroup_lnx.yml","hash":"7b582832e51a5c50fb8f4fa1a7acdd14964bcefc436e453db61ec401afd604d3","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"NFbKm2YByorp5hYibf0w","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.670949","user_id":null,"author":"Florian Roth","title":"WMIExec VBS Script","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"WMIExec VBS Script","released":"2018-10-22T12:40:26.670947","sigma_text":"title: WMIExec VBS Script\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Florian Roth\nreferences:\n    - https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\ntags:\n    - attack.execution\n    - attack.g0045\n    - attack.t1064\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\cscript.exe'\n        CommandLine: '*.vbs /shell *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/apt/apt_cloudhopper.yml","hash":"7d6ca9081e7e4e1cf6b3badabef2d57dbcde2b59afdca649f98a2049a6587a76","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"NVbKm2YByorp5hYibf05","_score":1,"_source":{"status":"experimental","category":2,"updated":"2018-10-22T12:40:26.679730","user_id":null,"author":"Florian Roth","title":"Fireball Archer Install","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Fireball Archer Install","released":"2018-10-22T12:40:26.679728","sigma_text":"title: Fireball Archer Install\nstatus: experimental\ndescription: Detects Archer malware invocation via rundll32\nauthor: Florian Roth\ndate: 2017/06/03\nreferences:\n    - https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\n    - https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/apt/crime_fireball.yml","hash":"ae054c30ecf260e694d9ac1c20884b19f6b5e89192bbd323476ecd0472ce3cff","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"OVbKm2YByorp5hYibf1y","_score":1,"_source":{"status":"","category":6,"updated":"2018-10-22T12:40:26.736077","user_id":null,"author":"Thomas Patzke","title":"Multiple suspicious Response Codes caused by Single Client","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Multiple suspicious Response Codes caused by Single Client","released":"2018-10-22T12:40:26.736075","sigma_text":"title: Multiple suspicious Response Codes caused by Single Client\ndescription: Detects possible exploitation activity or bugs in a web application\nauthor: Thomas Patzke\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        response:\n          - 400\n          - 401\n          - 403\n          - 500\n    timeframe: 10m\n    condition: selection | count() by clientip > 10\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Unstable application\n    - Application that misuses the response codes\nlevel: medium\n","git_filepath":"/web/web_multiple_suspicious_resp_codes_single_source.yml","hash":"f794f2ae6d817e5bc12f0a777ad30baa0f1d6868907cf037ebb23fc65a53e778","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"PVbKm2YByorp5hYibf3I","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.822640","user_id":null,"author":"Florian Roth","title":"Download EXE from Suspicious TLD","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Download EXE from Suspicious TLD","released":"2018-10-22T12:40:26.822636","sigma_text":"title: Download EXE from Suspicious TLD\nstatus: experimental\ndescription: Detects executable downloads from suspicious remote systems\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n    filter:\n        r-dns: \n            - '*.com'\n            - '*.org'\n            - '*.net'\n            - '*.edu'\n            - '*.gov'\n            - '*.uk'\n            - '*.ca'\n            - '*.de'\n            - '*.jp'\n            - '*.fr'\n            - '*.au'\n            - '*.us'\n            - '*.ch'\n            - '*.it'\n            - '*.nl'\n            - '*.se'\n            - '*.no'\n            - '*.es'\n            # Extend this list as needed\n    condition: selection and not filter\nfields:\n    - ClientIP\n    - URL\nfalsepositives:\n    - All kind of software downloads\nlevel: low\n","git_filepath":"/proxy/proxy_download_susp_tlds_whitelist.yml","hash":"d47acbf1f4d2ffb60a3ccf8b5b45fcc2e9860176006e2a5b6d61d51faee9962f","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"QFbKm2YByorp5hYibv0L","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.889908","user_id":null,"author":"Florian Roth","title":"Windows WebDAV User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Windows WebDAV User Agent","released":"2018-10-22T12:40:26.889905","sigma_text":"title: Windows WebDAV User Agent\nstatus: experimental\ndescription: Detects WebDav DownloadCradle\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 2018/04/06\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent: 'Microsoft-WebDAV-MiniRedir/*'\n      HttpMethod: 'GET'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\n    - HttpMethod\nfalsepositives:\n    - Administrative scripts that download files from the Internet\n    - Administrative scripts that retrieve certain website contents\n    - Legitimate WebDAV administration\nlevel: high\n","git_filepath":"/proxy/proxy_downloadcradle_webdav.yml","hash":"60a727fd29684a1b7e7c363f51a4637135e26ff08b16526613e99f61ac4d9298","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"iFbKm2YByorp5hYiX_xp","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.138948","user_id":null,"author":null,"title":"Password Dumper Activity on LSASS","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Password Dumper Activity on LSASS","released":"2018-10-22T12:40:23.138945","sigma_text":"title: Password Dumper Activity on LSASS\ndescription: Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN\nstatus: experimental\nreferences:\n    - https://twitter.com/jackcr/status/807385668833968128\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4656\n        ProcessName: 'C:\\Windows\\System32\\lsass.exe'\n        AccessMask: '0x705'\n        ObjectType: 'SAM_DOMAIN'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_lsass_dump.yml","hash":"e6a7c2d1ddfd0ca5d2960742af98540ab168dcb1f6c94f57c2fc252dae585643","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"ilbKm2YByorp5hYiX_yd","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.196203","user_id":null,"author":"Dimitrios Slamaris","title":"DHCP Server Loaded the CallOut DLL","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"DHCP Server Loaded the CallOut DLL","released":"2018-10-22T12:40:23.196200","sigma_text":"title: DHCP Server Loaded the CallOut DLL\nstatus: experimental\ndescription: This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\ntags:\n    - attack.defense_evasion\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 1033\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n","git_filepath":"/windows/builtin/win_susp_dhcp_config.yml","hash":"9d50e0b8e48b1249218f6166e808f9a2bfa2bf7d82e890eefd234b9d0687b0cd","author_keyword":"Dimitrios Slamaris","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"i1bKm2YByorp5hYiX_y_","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.228413","user_id":null,"author":"Florian Roth","title":"Multiple Failed Logins with Different Accounts from Single Source System","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Multiple Failed Logins with Different Accounts from Single Source System","released":"2018-10-22T12:40:23.228410","sigma_text":"title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system \nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529\n            - 4625\n        UserName: '*'\n        WorkstationName: '*'\n    selection2:\n        EventID: 4776\n        UserName: '*'\n        Workstation: '*'\n    timeframe: 24h \n    condition:\n        - selection1 | count(UserName) by WorkstationName > 3\n        - selection2 | count(UserName) by Workstation > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Other multiuser systems like Citrix server farms\n    - Workstations with frequently changing users \nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_failed_logons_single_source.yml","hash":"027f506eeeba324da0055822bf0a179e4aea3b41ba0cc85e07d007671b034592","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"j1bKm2YByorp5hYiYPwP","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.309448","user_id":null,"author":"Florian Roth","title":"Access to ADMIN$ Share","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Access to ADMIN$ Share","released":"2018-10-22T12:40:23.309446","sigma_text":"title: Access to ADMIN$ Share\ndescription: Detects access to $ADMIN share\ntags:\n    - attack.lateral_movement\n    - attack.t1077\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5140\n        ShareName: Admin$\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and not filter\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n","git_filepath":"/windows/builtin/win_admin_share_access.yml","hash":"bb5fc10f8869ded88e713fbbcf72bf7fa889649525a8973114b52f850e44d302","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"kFbKm2YByorp5hYiYPwg","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.326831","user_id":null,"author":null,"title":"Suspicious Kerberos RC4 Ticket Encryption","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious Kerberos RC4 Ticket Encryption","released":"2018-10-22T12:40:23.326828","sigma_text":"title: Suspicious Kerberos RC4 Ticket Encryption\nstatus: experimental\nreferences:\n    - https://adsecurity.org/?p=3458\n    - https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\ntags:\n    - attack.credential_access\n    - attack.t1208\ndescription: Detects service ticket requests using RC4 encryption type\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769\n        TicketOptions: '0x40810000'\n        TicketEncryptionType: '0x17'\n    reduction:\n        - ServiceName: '$*'\n    condition: selection and not reduction\nfalsepositives:\n    - Service accounts used on legacy systems (e.g. NetApp)\n    - Windows Domains with DFL 2003 and legacy systems\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_rc4_kerberos.yml","hash":"e6d308fe9568559c81315e918037c33747fe18ce42925d1845df0cc218f15466","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"klbKm2YByorp5hYiYPxd","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.387303","user_id":null,"author":"Roberto Rodriguez (source), Dominik Schaudel (rule)","title":"Successful Overpass the Hash Attempt","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Successful Overpass the Hash Attempt","released":"2018-10-22T12:40:23.387300","sigma_text":"title: Successful Overpass the Hash Attempt\nstatus: experimental\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\nreferences: \n    - https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\nauthor: Roberto Rodriguez (source), Dominik Schaudel (rule)\ndate: 2018/02/12\ntags:\n    - attack.lateral_movement\n    - attack.t1075\n    - attack.s0002\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 9\n        LogonProcessName: seclogo\n        AuthenticationPackageName: Negotiate\n    condition: selection\nfalsepositives:\n    - Runas command-line tool using /netonly parameter\nlevel: high\n","git_filepath":"/windows/builtin/win_overpass_the_hash.yml","hash":"115d68531154218c30cb6f5f918c53495ab7d9f5f30d2470e20ed7f55258d01a","author_keyword":"Roberto Rodriguez (source), Dominik Schaudel (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"lFbKm2YByorp5hYiYPyA","_score":1,"_source":{"status":"stable","category":11,"updated":"2018-10-22T12:40:23.423348","user_id":null,"author":"Thomas Patzke","title":"Addition of SID History to Active Directory Object","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Addition of SID History to Active Directory Object","released":"2018-10-22T12:40:23.423345","sigma_text":"title: Addition of SID History to Active Directory Object\nstatus: stable\ndescription: An attacker can use the SID history attribute to gain additional privileges.\nreferences:\n    - https://adsecurity.org/?p=1772\nauthor: Thomas Patzke\ntags:\n    - attack.privilege_escalation\n    - attack.t1178\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4765\n            - 4766\n    condition: selection\nfalsepositives:\n    - Migration of an account into a new domain\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_add_sid_history.yml","hash":"62412daaea088252c6809e79ad28484737eb0952daaef908138591cddb0ec2d4","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"mFbKm2YByorp5hYiYPzU","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.507279","user_id":null,"author":"Florian Roth","title":"SAM Dump to AppData","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"SAM Dump to AppData","released":"2018-10-22T12:40:23.507277","sigma_text":"title: SAM Dump to AppData\nstatus: experimental\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers\ntags:\n    - attack.credential_access\n    - attack.t1003\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\n    description: The source of this type of event is Kernel-General\ndetection:\n    selection:\n        EventID: 16\n    keywords:\n        - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\n    condition: all of them\nfalsepositives:\n    - Penetration testing\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_sam_dump.yml","hash":"1b34439e532a7781a2d9667a8897617320a10d7e25961f8060a598c3b67642b0","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"m1bKm2YByorp5hYiYPz_","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.549754","user_id":null,"author":"Thomas Patzke","title":"Secure Deletion with SDelete","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Secure Deletion with SDelete","released":"2018-10-22T12:40:23.549751","sigma_text":"title: Secure Deletion with SDelete\nstatus: experimental\ndescription: Detects renaming of file while deletion with SDelete tool\nauthor: Thomas Patzke\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\ntags:\n    - attack.defense_evasion\n    - attack.t1107\n    - attack.t1116\n    - attack.s0195\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n            - 4658\n        ObjectName:\n            - '*.AAA'\n            - '*.ZZZ'\n    condition: selection\nfalsepositives:\n    - Legitime usage of SDelete\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_sdelete.yml","hash":"a2cb33efe08836f3f8872825e1bb1bd370233075607ab488639bd024c2d2b316","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"nVbKm2YByorp5hYiYfwd","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.579690","user_id":null,"author":"@neu5ron","title":"Disabling Windows Event Auditing","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Disabling Windows Event Auditing","released":"2018-10-22T12:40:23.579687","sigma_text":"title: Disabling Windows Event Auditing\ndescription: >\n    Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario\n    where an entity would want to bypass local logging to evade detection when windows event logging is enabled and\n    reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure\n    that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\".\n    Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off\n    specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.\nreferences:\n    - https://bit.ly/WinLogsZero2Hero\ntags:\n    - attack.defense_evasion\n    - attack.t1054\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change'\ndetection:\n    selection:\n        EventID: 4719\n        AuditPolicyChanges: 'removed'\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_disable_event_logging.yml","hash":"7e9bfe5208064abd98b3a1d41c2dc9bf7e6ccbe46fd6ffa0014bb6180ca8eeeb","author_keyword":"@neu5ron","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"oVbKm2YByorp5hYiYfxZ","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.639558","user_id":null,"author":"juju4","title":"Admin User Remote Logon","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Admin User Remote Logon","released":"2018-10-22T12:40:23.639554","sigma_text":"title: Admin User Remote Logon\ndescription: Detect remote login by Administrator user depending on internal pattern\nreferences:\n    - https://car.mitre.org/wiki/CAR-2016-04-005\ntags:\n    - attack.lateral_movement\n    - attack.t1078\nstatus: experimental\nauthor: juju4\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account'\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 10\n        AuthenticationPackageName: Negotiate\n        AccountName: 'Admin-*'\n    condition: selection\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n","git_filepath":"/windows/builtin/win_admin_rdp_login.yml","hash":"64539e2f5f382c0dc84d3db2ea9d74efe4f67f4e214283d2dcee7e1c75b900e0","author_keyword":"juju4","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"pFbKm2YByorp5hYiYfx7","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.674230","user_id":null,"author":"Florian Roth","title":"Rare Service Installs","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Rare Service Installs","released":"2018-10-22T12:40:23.674228","sigma_text":"title: Rare Service Installs\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services \nstatus: experimental\nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    timeframe: 7d\n    condition: selection | count(ServiceFileName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n","git_filepath":"/windows/builtin/win_rare_service_installs.yml","hash":"cc3d6f0714a57ef14068b253df8b3b95d5fb5b9278a1a7d193a5b19553d8650e","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"pVbKm2YByorp5hYiYfyM","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.691132","user_id":null,"author":"John Lambert (rule)","title":"Malicious Base64 encoded PowerShell Keywords in command lines","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Malicious Base64 encoded PowerShell Keywords in command lines","released":"2018-10-22T12:40:23.691130","sigma_text":"title: Malicious Base64 encoded PowerShell Keywords in command lines\nstatus: experimental\ndescription: Detects base64 encoded strings used in hidden malicious PowerShell command lines \nreferences:\n    - http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: John Lambert (rule)\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\ndetection:\n    encoded:\n        EventID: 4688\n        Image: '*\\powershell.exe'\n        CommandLine: '* hidden *'\n    selection:\n        EventID: 4688\n        CommandLine:\n            # bitsadmin transfer\n            - '*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*'\n            - '*aXRzYWRtaW4gL3RyYW5zZmVy*'\n            - '*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*'\n            - '*JpdHNhZG1pbiAvdHJhbnNmZX*'\n            - '*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*'\n            - '*Yml0c2FkbWluIC90cmFuc2Zlc*'\n            # chunk_size\n            - '*AGMAaAB1AG4AawBfAHMAaQB6AGUA*'\n            - '*JABjAGgAdQBuAGsAXwBzAGkAegBlA*'\n            - '*JGNodW5rX3Npem*'\n            - '*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*'\n            - '*RjaHVua19zaXpl*'\n            - '*Y2h1bmtfc2l6Z*'\n            # IO.Compression\n            - '*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*'\n            - '*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*'\n            - '*lPLkNvbXByZXNzaW9u*'\n            - '*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*'\n            - '*SU8uQ29tcHJlc3Npb2*'\n            - '*Ty5Db21wcmVzc2lvb*'\n            # IO.MemoryStream\n            - '*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*'\n            - '*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*'\n            - '*lPLk1lbW9yeVN0cmVhb*'\n            - '*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*'\n            - '*SU8uTWVtb3J5U3RyZWFt*'\n            - '*Ty5NZW1vcnlTdHJlYW*'\n            # GetChunk\n            - '*4ARwBlAHQAQwBoAHUAbgBrA*'\n            - '*5HZXRDaHVua*'\n            - '*AEcAZQB0AEMAaAB1AG4Aaw*'\n            - '*LgBHAGUAdABDAGgAdQBuAGsA*'\n            - '*LkdldENodW5r*'\n            - '*R2V0Q2h1bm*'\n            # THREAD INFO64\n            - '*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*'\n            - '*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*'\n            - '*RIUkVBRF9JTkZPNj*'\n            - '*SFJFQURfSU5GTzY0*'\n            - '*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*'\n            - '*VEhSRUFEX0lORk82N*'\n            # CreateRemoteThread\n            - '*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*'\n            - '*cmVhdGVSZW1vdGVUaHJlYW*'\n            - '*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*'\n            - '*NyZWF0ZVJlbW90ZVRocmVhZ*'\n            - '*Q3JlYXRlUmVtb3RlVGhyZWFk*'\n            - '*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*'\n            # memmove\n            - '*0AZQBtAG0AbwB2AGUA*'\n            - '*1lbW1vdm*'\n            - '*AGUAbQBtAG8AdgBlA*'\n            - '*bQBlAG0AbQBvAHYAZQ*'\n            - '*bWVtbW92Z*'\n            - '*ZW1tb3Zl*'  \n    condition: encoded and selection\nfalsepositives:\n    - Penetration tests\nlevel: high\n","git_filepath":"/windows/builtin/win_susp_powershell_hidden_b64_cmd.yml","hash":"10dbbe3b6bef16a6475c335733dad5d73f8faad6f007c476df4e2226dd0e25e5","author_keyword":"John Lambert (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"p1bKm2YByorp5hYiYfyk","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.715113","user_id":null,"author":"Thomas Patzke","title":"WCE wceaux.dll Access","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"WCE wceaux.dll Access","released":"2018-10-22T12:40:23.715111","sigma_text":"title: WCE wceaux.dll Access\nstatus: experimental\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\nauthor: Thomas Patzke\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4658\n            - 4660\n            - 4663\n        ObjectName: '*\\wceaux.dll'\n    condition: selection\nfalsepositives: \n    - Penetration testing\nlevel: critical\n","git_filepath":"/windows/builtin/win_mal_wceaux_dll.yml","hash":"4cb204f4744ef7ea4b28ebc7c281c9acc613d0f0b10afe47abae3c916ba5b605","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"qVbKm2YByorp5hYiYfy-","_score":1,"_source":{"status":"","category":11,"updated":"2018-10-22T12:40:23.740821","user_id":null,"author":"Florian Roth","title":"Eventlog Cleared","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Eventlog Cleared","released":"2018-10-22T12:40:23.740818","sigma_text":"title: Eventlog Cleared\ndescription: One of the Windows Eventlogs has been cleared\nreferences:\n    - https://twitter.com/deviouspolack/status/832535435960209408\nauthor: Florian Roth\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/windows/builtin/win_susp_eventlog_cleared.yml","hash":"ff738bf2eaefb1ced59a88b1d1a7b90032a0bf7232a52d352e7f4951df3bf24f","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"q1bKm2YByorp5hYiYfzm","_score":1,"_source":{"status":"experimental","category":11,"updated":"2018-10-22T12:40:23.780607","user_id":null,"author":"Florian Roth","title":"Executable used by PlugX in Uncommon Location","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Executable used by PlugX in Uncommon Location","released":"2018-10-22T12:40:23.780603","sigma_text":"title: Executable used by PlugX in Uncommon Location\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - 'http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/'\n    - 'https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/'\nauthor: Florian Roth\ndate: 2017/06/12\ntags:\n    - attack.s0013\nlogsource:\n    product: windows\n    service: security\ndetection:\n    # CamMute\n    selection_cammute:\n        EventID: 4688\n        CommandLine: '*\\CamMute.exe'\n    filter_cammute:\n        EventID: 4688\n        CommandLine: '*\\Lenovo\\Communication Utility\\*'\n    # Chrome Frame Helper\n    selection_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\Google\\Chrome\\application\\*'    \n    # Microsoft Device Emulator\n    selection_devemu:\n        EventID: 4688\n        CommandLine: '*\\dvcemumanager.exe'\n    filter_devemu:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Device Emulator\\*'   \n    # Windows Media Player Gadget\n    selection_gadget:\n        EventID: 4688\n        CommandLine: '*\\Gadget.exe'\n    filter_gadget:\n        EventID: 4688\n        CommandLine: '*\\Windows Media Player\\*'\n    # HTML Help Workshop\n    selection_hcc:\n        EventID: 4688\n        CommandLine: '*\\hcc.exe'\n    filter_hcc:\n        EventID: 4688\n        CommandLine: '*\\HTML Help Workshop\\*'\n    # Hotkey Command Module for Intel Graphics Contollers\n    selection_hkcmd:\n        EventID: 4688\n        CommandLine: '*\\hkcmd.exe'\n    filter_hkcmd:\n        EventID: 4688\n        CommandLine: \n            - '*\\System32\\*'\n            - '*\\SysNative\\*'\n            - '*\\SysWowo64\\*'\n    # McAfee component\n    selection_mc:\n        EventID: 4688\n        CommandLine: '*\\Mc.exe'\n    filter_mc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    # MsMpEng - Microsoft Malware Protection Engine\n    selection_msmpeng:\n        EventID: 4688\n        CommandLine: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Security Client\\*'\n            - '*\\Windows Defender\\*'\n            - '*\\AntiMalware\\*'\n    # Microsoft Security Center\n    selection_msseces:\n        EventID: 4688\n        CommandLine: '*\\msseces.exe'\n    filter_msseces:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Security Center\\*'\n    # Microsoft Office 2003 OInfo\n    selection_oinfo:\n        EventID: 4688\n        CommandLine: '*\\OInfoP11.exe'\n    filter_oinfo:\n        EventID: 4688\n        CommandLine: '*\\Common Files\\Microsoft Shared\\*'      \n    # OLE View\n    selection_oleview:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_oleview:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n    # RC\n    selection_rc:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_rc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n            - '*\\Microsoft.NET\\*'  \n    condition: ( selection_cammute and not filter_cammute ) or  \n                ( selection_chrome_frame and not filter_chrome_frame ) or\n                ( selection_devemu and not filter_devemu ) or\n                ( selection_gadget and not filter_gadget ) or \n                ( selection_hcc and not filter_hcc ) or \n                ( selection_hkcmd and not filter_hkcmd ) or \n                ( selection_mc and not filter_mc ) or\n                ( selection_msmpeng and not filter_msmpeng ) or\n                ( selection_msseces and not filter_msseces ) or\n                ( selection_oinfo and not filter_oinfo ) or \n                ( selection_oleview and not filter_oleview ) or \n                ( selection_rc and not filter_rc ) \nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/builtin/win_plugx_susp_exe_locations.yml","hash":"bea693f0c6ee0691d6182b0a58a2fbbd85e8dc48f88c0b51204e924d68fed872","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"tVbKm2YByorp5hYiYvzg","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.031592","user_id":null,"author":"Florian Roth (rule), Lee Holmes (idea)","title":"PowerShell Downgrade Attack","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"PowerShell Downgrade Attack","released":"2018-10-22T12:40:24.031590","sigma_text":"title: PowerShell Downgrade Attack\nstatus: experimental\ndescription: Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0\nreferences:\n    - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule), Lee Holmes (idea)\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection:\n        EventID: 400\n        EngineVersion: '2.*'\n    filter:\n        HostVersion: '2.*' \n    condition: selection and not filter\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: medium\n","git_filepath":"/windows/powershell/powershell_downgrade_attack.yml","hash":"eca980aba52db6f5f6c4ba61f6b69c438a41053e341b98e57b0197a5ee797dfd","author_keyword":"Florian Roth (rule), Lee Holmes (idea)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"uVbKm2YByorp5hYiY_xf","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.158480","user_id":null,"author":"Sean Metcalf (source), Florian Roth (rule)","title":"PowerShell PSAttack","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"PowerShell PSAttack","released":"2018-10-22T12:40:24.158477","sigma_text":"title: PowerShell PSAttack \nstatus: experimental\ndescription: Detects the use of PSAttack PowerShell hack tool\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    selection:\n        EventID: 4103\n    keyword: \n        - 'PS ATTACK!!!'\n    condition: all of them\nfalsepositives:\n    - Pentesters\nlevel: high\n","git_filepath":"/windows/powershell/powershell_psattack.yml","hash":"b0a256cbb1e84766de1ab5a6aab3cff5e9a6be1850daa5ecf1943a5ea6e4904e","author_keyword":"Sean Metcalf (source), Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"u1bKm2YByorp5hYiY_x8","_score":1,"_source":{"status":"experimental","category":14,"updated":"2018-10-22T12:40:24.187445","user_id":null,"author":"Florian Roth (rule)","title":"Suspicious PowerShell Invocations - Specific","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious PowerShell Invocations - Specific","released":"2018-10-22T12:40:24.187442","sigma_text":"title: Suspicious PowerShell Invocations - Specific\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - ' -nop -w hidden -c * [Convert]::FromBase64String'\n        - ' -w hidden -noni -nop -c \"iex(New-Object'\n        - ' -w hidden -ep bypass -Enc'\n        - 'powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run'\n        - 'bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download'\n        - 'iex(New-Object Net.WebClient).Download'\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n","git_filepath":"/windows/powershell/powershell_suspicious_invocation_specific.yml","hash":"900ab9eba563d7838f775317afb369a9920f6ecfc128848a686479ca2766d2ad","author_keyword":"Florian Roth (rule)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"vlbKm2YByorp5hYiY_yl","_score":1,"_source":{"status":"experimental","category":12,"updated":"2018-10-22T12:40:24.227743","user_id":null,"author":"Florian Roth (rule), Tom U. @c_APT_ure (collection)","title":"WannaCry Ransomware via Sysmon","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"WannaCry Ransomware via Sysmon","released":"2018-10-22T12:40:24.227740","sigma_text":"title: WannaCry Ransomware via Sysmon\nstatus: experimental\ndescription: Detects WannaCry ransomware activity via Sysmon\nreferences:\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection) \nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image:\n            - '*\\tasksche.exe'\n            - '*\\mssecsvc.exe'\n            - '*\\taskdl.exe'\n            - '*\\@WanaDecryptor@*'\n            - '*\\taskhsvc.exe'\n            - '*\\taskse.exe'\n            - '*\\111.exe'\n            - '*\\lhdfrgui.exe'\n            - '*\\diskpart.exe'  # Rare, but can be false positive\n            - '*\\linuxnew.exe'\n            - '*\\wannacry.exe'\n    selection2:\n        EventID: 1\n        CommandLine:\n            - '*vssadmin delete shadows*'\n            - '*icacls * /grant Everyone:F /T /C /Q*'\n            - '*bcdedit /set {default} recoveryenabled no*'\n            - '*wbadmin delete catalog -quiet*'\n            - '*@Please_Read_Me@.txt*'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Diskpart.exe usage to manage partitions on the local hard drive\nlevel: critical\n","git_filepath":"/windows/malware/sysmon_malware_wannacry.yml","hash":"126ead32731230767fd59fee01e807097b7ee1f0e9a14a6c3404e1dba747f00d","author_keyword":"Florian Roth (rule), Tom U. @c_APT_ure (collection)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"wVbKm2YByorp5hYiY_zR","_score":1,"_source":{"status":"experimental","category":12,"updated":"2018-10-22T12:40:24.272394","user_id":null,"author":"Florian Roth, Tom Ueltschi","title":"NotPetya Ransomware Activity","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"NotPetya Ransomware Activity","released":"2018-10-22T12:40:24.272391","sigma_text":"title: NotPetya Ransomware Activity\nstatus: experimental\ndescription: Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil\nauthor: Florian Roth, Tom Ueltschi\nreferences:\n    - https://securelist.com/schroedingers-petya/78870/\n    - https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100\ntags:\n    - attack.execution\n    - attack.credential_access\n    - attack.defense_evasion\n    - attack.t1085\n    - attack.t1070\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    fsutil_clean_journal:\n        EventID: 1\n        Image: '*\\fsutil.exe'\n        CommandLine: '* deletejournal *'        \n    pipe_com:\n        EventID: 1\n        CommandLine: '*\\AppData\\Local\\Temp\\* \\\\.\\pipe\\*'\n    event_clean:\n        EventID: 1\n        Image: '*\\wevtutil.exe'\n        CommandLine: '* cl *'\n    rundll32_dash1:\n        EventID: 1\n        Image: '*\\rundll32.exe'\n        CommandLine: '*.dat,#1'       \n    perfc_keyword:\n        - '*\\perfc.dat*'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Admin activity\nlevel: critical\n","git_filepath":"/windows/malware/sysmon_malware_notpetya.yml","hash":"32eaf941c3fc4192fca55c7e6e90d99f3fc95901856224be075d6398408d4c84","author_keyword":"Florian Roth, Tom Ueltschi","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"yVbKm2YByorp5hYiZPwn","_score":1,"_source":{"status":"stable","category":15,"updated":"2018-10-22T12:40:24.358457","user_id":null,"author":"Nik Seetharaman","title":"CMSTP Execution","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"CMSTP Execution","released":"2018-10-22T12:40:24.358454","sigma_text":"title: CMSTP Execution\nstatus: stable\ndescription: Detects various indicators of Microsoft Connection Manager Profile Installer execution\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1191\n    - attack.g0069\nauthor: Nik Seetharaman\nreferences:\n    - http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # CMSTP Spawning Child Process\n    selection1:\n        EventID: 1\n        ParentImage: '*\\cmstp.exe'\n    # Registry Object Add\n    selection2:\n        EventID: 12\n        TargetObject: '*\\cmmgr32.exe*'\n    # Registry Object Value Set\n    selection3:\n        EventID: 13\n        TargetObject: '*\\cmmgr32.exe*'\n    # Process Access Call Trace\n    selection4:\n        EventID: 10\n        CallTrace: '*cmlua.dll*'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - Details\nfalsepositives:\n    - Legitimate CMSTP use (unlikely in modern enterprise environments)\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_cmstp_execution.yml","hash":"d1bda8c17d24c0a8ab6cb983a8e20537f66fa6aefb2ad4b1a19f7cc78767fa88","author_keyword":"Nik Seetharaman","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"y1bKm2YByorp5hYiZPw9","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.380019","user_id":null,"author":"Florian Roth","title":"Suspicious Svchost Process","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Svchost Process","released":"2018-10-22T12:40:24.380016","sigma_text":"title: Suspicious Svchost Process\nstatus: experimental\ndescription: Detects a suspicious svchost process start \nauthor: Florian Roth\ndate: 2017/08/15\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\svchost.exe'\n    filter:\n        ParentImage: \n            - '*\\services.exe'\n            - '*\\MsMpEng.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_svchost.yml","hash":"c59bac43ab6ac7d0fc18c67594dab510e9f2b543910355cc529efd474ce5f7f7","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"zVbKm2YByorp5hYiZPxT","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.400721","user_id":null,"author":"Florian Roth","title":"Regsvr32 Anomaly","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Regsvr32 Anomaly","released":"2018-10-22T12:40:24.400719","sigma_text":"title: Regsvr32 Anomaly\nstatus: experimental\ndescription: Detects various anomalies in relation to regsvr32.exe\nauthor: Florian Roth\nreferences:\n    - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html\ntags:\n    - attack.t1117\n    - attack.defense_evasion\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # Loads from Temp folder\n    selection1:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        CommandLine: '*\\Temp\\*'\n    # Loaded by powershell\n    selection2:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\powershell.exe'\n    # Regsvr32.exe used with http(s) address\n    selection3:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        CommandLine: \n            - '*/i:http* scrobj.dll'\n            - '*/i:ftp* scrobj.dll'\n    # Regsvr32.exe spawned wscript.exe process - indicator of COM scriptlet\n    # https://www.hybrid-analysis.com/sample/f34da6d84a9663928606894fbc494cd9bf2f03c98cf0c775462802558d3a50ef?environmentId=100\n    selection4:\n        EventID: 1\n        Image: '*\\wscript.exe'\n        ParentImage: '*\\regsvr32.exe'\n    # https://twitter.com/danielhbohannon/status/974321840385531904\n    selection5:\n        EventID: 1\n        Image: '*\\EXCEL.EXE'\n        CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_regsvr32_anomalies.yml","hash":"6a7db5ef49fd91a0847748ac978fbcf6aa965f40f3e3a5693c68b52b9670f85d","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"0FbKm2YByorp5hYiZPyA","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.445949","user_id":null,"author":"Markus Neis","title":"Default PowerSploit Schtasks Persistence","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Default PowerSploit Schtasks Persistence","released":"2018-10-22T12:40:24.445946","sigma_text":"title: Default PowerSploit Schtasks Persistence \nstatus: experimental\ndescription: Detects the creation of a schtask via PowerSploit Default Configuration \nreferences:\n    - https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1\nauthor: Markus Neis\ndate: 2018/03/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        ParentImage:\n            - '*\\Powershell.exe'\n        CommandLine:\n            - '*\\schtasks.exe*/Create*/RU*system*/SC*ONLOGON*'\n            - '*\\schtasks.exe*/Create*/RU*system*/SC*DAILY*'\n            - '*\\schtasks.exe*/Create*/RU*system*/SC*ONIDLE*'\n            - '*\\schtasks.exe*/Create*/RU*system*/SC*HOURLY*'\n    condition: selection\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.privelege_escalation\n    - attack.t1053\n    - attack.t1086\n    - attack.s0111\n    - attack.g0022\n    - attack.g0060\nfalsepositives:\n    - False positives are possible, depends on organisation and processes\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_powersploit_schtasks.yml","hash":"5d9ebf841389250ebf15ed83db6aa7a565b3d2c9081f98f94911434c5e37bea5","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"1FbKm2YByorp5hYiZPzO","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.524842","user_id":null,"author":"Florian Roth","title":"Suspicious Control Panel DLL Load","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious Control Panel DLL Load","released":"2018-10-22T12:40:24.524839","sigma_text":"title: Suspicious Control Panel DLL Load\nstatus: experimental\ndescription: Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits\nauthor: Florian Roth\ndate: 2017/04/15\nreferences:\n    - https://twitter.com/rikvduijn/status/853251879320662017\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\System32\\control.exe'\n        CommandLine: '*\\rundll32.exe *'\n    filter:\n        CommandLine: '*Shell32.dll*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_control_dll_load.yml","hash":"c663daa714c776e4f56652af353d10e9855999d53027ca8aab6d5ca8be6a2855","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"1VbKm2YByorp5hYiZPzc","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.538595","user_id":null,"author":"Florian Roth","title":"Registry Persistence via Explorer Run Key","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Registry Persistence via Explorer Run Key","released":"2018-10-22T12:40:24.538593","sigma_text":"title: Registry Persistence via Explorer Run Key\nstatus: experimental\ndescription: Detects a possible persistence mechanism using RUN key for Windows Explorer and poiting to a suspicious folder\nauthor: Florian Roth\ndate: 2018/07/18\nreference:\n    - https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: '*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run'\n        Details: \n            - 'C:\\Windows\\Temp\\*'\n            - 'C:\\ProgramData\\*'\n            - '*\\AppData\\*'\n            - 'C:\\$Recycle.bin\\*'\n            - 'C:\\Temp\\*'\n            - 'C:\\Users\\Public\\*'\n            - 'C:\\Users\\Default\\*'\n    condition: selection\ntags:\n    - attack.persistence\n    - attack.t1060\n    - capec.270\nfields:\n    - Image\n    - ParentImage\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_reg_persist_explorer_run.yml","hash":"eccd3fa8c68f70ccceedd98bcbf6e0c26a31fe3789f2d6b40a6c3e96fe3900db","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"21bKm2YByorp5hYiZfwt","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.619404","user_id":null,"author":"Dimitrios Slamaris","title":"DHCP Callout DLL installation","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"DHCP Callout DLL installation","released":"2018-10-22T12:40:24.619402","sigma_text":"title: DHCP Callout DLL installation\nstatus: experimental\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: \n            - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\n            - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_dhcp_calloutdll.yml","hash":"5917acc25b583d9a831e063ad6f134e45963a5c08925d3671e245d64b6c2fc03","author_keyword":"Dimitrios Slamaris","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"3FbKm2YByorp5hYiZfw_","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.637286","user_id":null,"author":"Florian Roth","title":"Suspicious Reconnaissance Activity","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious Reconnaissance Activity","released":"2018-10-22T12:40:24.637283","sigma_text":"title: Suspicious Reconnaissance Activity\nstatus: experimental\ndescription: Detects suspicious command line activity on Windows systems\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            - 'net group \"domain admins\" /domain'\n            - 'net localgroup administrators'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Inventory tool runs\n    - Penetration tests\n    - Administrative activity\nanalysis:\n    recommendation: Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_recon_activity.yml","hash":"26a9c2938e5c5d25a21bce564049170a32dadc920e237a47e92417ddf64172a5","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"5lbKm2YByorp5hYiZvxj","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:24.929655","user_id":null,"author":"Michael Haag, Florian Roth, Markus Neis","title":"Microsoft Office Product Spawning Windows Shell","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Microsoft Office Product Spawning Windows Shell","released":"2018-10-22T12:40:24.929652","sigma_text":"title: Microsoft Office Product Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.\nreferences:\n    - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1059\n    - attack.T1202\nauthor: Michael Haag, Florian Roth, Markus Neis\ndate: 2018/04/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n            - '*\\POWERPNT.exe'\n            - '*\\MSPUB.exe'\n            - '*\\VISIO.exe'\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\scrcons.exe'\n            - '*\\schtasks.exe'  # see https://www.hybrid-analysis.com/sample/b409538c99f99b94a5035d9fa44a506b41be0feb23e89b7e4d272ba791aa6002?environmentId=100\n            - '*\\regsvr32.exe'  # see https://twitter.com/subTee/status/899283365647458305\n            - '*\\hh.exe'  # see https://www.hybrid-analysis.com/sample/6abc2b63f1865a847ff7f5a9d49bb944397b36f5503b9718d6f91f93d60f7cd7?environmentId=100\n            - '*\\wmic.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\mshta.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\rundll32.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\msiexec.exe'  # see https://twitter.com/DissectMalware/status/984252467474026497\n            - '*\\forfiles.exe' # see https://twitter.com/danielhbohannon/status/896057910123347969?lang=en\n            - '*\\scriptrunner.exe' # see https://twitter.com/KyleHanslovan/status/914800377580503040\n            - '*\\mftrace.exe' # see https://github.com/api0cradle/LOLBAS/blob/763d0b115cd702780ca042a8beb6ee684ef7823f/OtherMSBinaries/Mftrace.md\n            - '*\\AppVLP.exe' # see https://twitter.com/moo_hax/status/892388990686347264\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_office_shell.yml","hash":"58f01a4a1dd35af47e946337849b157fb3dc4610224fc24b13efcea6ac0acf33","author_keyword":"Michael Haag, Florian Roth, Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"6FbKm2YByorp5hYiZvx7","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:24.954744","user_id":null,"author":"Florian Roth","title":"Ping Hex IP","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Ping Hex IP","released":"2018-10-22T12:40:24.954742","sigma_text":"title: Ping Hex IP\ndescription: Detects a ping command that uses a hex encoded IP address\nreferences:\n    - https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna\n    - https://twitter.com/vysecurity/status/977198418354491392\nauthor: Florian Roth\ndate: 2018/03/23\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            - '*\\ping.exe 0x*'\n            - '*\\ping 0x*'\n    condition: selection\nfields:\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely, because no sane admin pings IP addresses in a hexadecimal form\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_susp_ping_hex_ip.yml","hash":"6a72e5da63c4e1398c0b4b15b0c67ef16c4886e19d040152415b539b697f996a","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"7FbKm2YByorp5hYiZvzz","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.074582","user_id":null,"author":"Omer Yampel","title":"UAC Bypass via sdclt","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"UAC Bypass via sdclt","released":"2018-10-22T12:40:25.074580","sigma_text":"title: UAC Bypass via sdclt\nstatus: experimental\ndescription: Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\nreferences:\n    - https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/\nauthor: Omer Yampel\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13 \n        TargetObject: 'HKEY_USERS\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand'\n    condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1088\nfalsepositives:\n    - unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_uac_bypass_sdclt.yml","hash":"cfbac84c1ab2f7837bba06c65fc2e8d18e2430d1ac86b68c3ffb274dba80bcf7","author_keyword":"Omer Yampel","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"7VbKm2YByorp5hYiZvz_","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.086014","user_id":null,"author":null,"title":"Processes created by MMC","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Processes created by MMC","released":"2018-10-22T12:40:25.086012","sigma_text":"title: Processes created by MMC \nstatus: experimental\ndescription: Processes started by MMC could be a sign of lateral movement using MMC application COM object \nreferences:\n    - https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mmc.exe'\n        Image: '*\\cmd.exe'\n    exclusion:\n        CommandLine: '*\\RunCmd.cmd'\n    condition: selection and not exclusion\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_mmc_source.yml","hash":"c28153a609c1b3dcbb65f3bb834db198f295bccfb9e0581c434eb10b35c2d947","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"7lbKm2YByorp5hYiZ_wF","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.092453","user_id":null,"author":"Florian Roth","title":"QuarksPwDump Dump File","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"QuarksPwDump Dump File","released":"2018-10-22T12:40:25.092451","sigma_text":"title: QuarksPwDump Dump File\nstatus: experimental\ndescription: Detects a dump file written by QuarksPwDump password dumper\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm\nauthor: Florian Roth\ndate: 2018/02/10\nlevel: critical\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        # Sysmon: File Creation (ID 11)\n        EventID: 11\n        TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\n    condition: selection\nfalsepositives:\n    - Unknown\n","git_filepath":"/windows/sysmon/sysmon_quarkspw_filedump.yml","hash":"cb8c6ceb101148f1c983ea3059920e3c4180725c2a633e5992d7ee539c24d16c","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"8VbKm2YByorp5hYiZ_wu","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.133598","user_id":null,"author":"Florian Roth","title":"Rundll32 Internet Connection","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Rundll32 Internet Connection","released":"2018-10-22T12:40:25.133596","sigma_text":"title: Rundll32 Internet Connection\nstatus: experimental\ndescription: Detects a rundll32 that communicates with public IP addresses\nreferences:\n    - https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100\nauthor: Florian Roth\ndate: 2017/11/04\ntags:\n    - attack.t1085\n    - attack.defense_evasion\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\rundll32.exe'\n    filter:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.*'\n    condition: selection and not filter\nfalsepositives:\n    - Communication to other corporate systems that use IP addresses from public address spaces\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_rundll32_net_connections.yml","hash":"cadb73e072084614f75d7ee6c6b5671d4562ec72cb530625724974381385d609","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"-VbKm2YByorp5hYiaPxc","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.435275","user_id":null,"author":"Florian Roth","title":"Taskmgr as Parent","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Taskmgr as Parent","released":"2018-10-22T12:40:25.435272","sigma_text":"title: Taskmgr as Parent\nstatus: experimental\ndescription: Detects the creation of a process from Windows task manager\nauthor: Florian Roth\ndate: 2018/03/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\taskmgr.exe'\n    filter:\n        Image: \n            - 'resmon.exe'\n            - 'mmc.exe'\n    condition: selection and not filter\nfields:\n    - Image\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\nlevel: low\n","git_filepath":"/windows/sysmon/sysmon_susp_taskmgr_parent.yml","hash":"691dd40f77028c4773c47a82c097303b4b008796ac8f1a78abcb0c593dc48a12","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"_lbKm2YByorp5hYiaPzY","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.558991","user_id":null,"author":"Florian Roth (rule), Daniel Bohannon (idea)","title":"Suspicious PowerShell Parameter Substring","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious PowerShell Parameter Substring","released":"2018-10-22T12:40:25.558989","sigma_text":"title: Suspicious PowerShell Parameter Substring\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation with a parameter substring\nreferences:\n    - http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule), Daniel Bohannon (idea)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    keywords:\n        Image: '*\\powershell.exe'\n    substrings:\n        - ' -windowstyle h '\n        - ' -windowstyl h'\n        - ' -windowsty h'\n        - ' -windowst h'\n        - ' -windows h'\n        - ' -windo h'\n        - ' -wind h'\n        - ' -win h'\n        - ' -wi h'\n        - ' -win h '\n        - ' -win hi '\n        - ' -win hid '\n        - ' -win hidd '\n        - ' -win hidde '\n        - ' -NoPr '\n        - ' -NoPro '\n        - ' -NoProf '\n        - ' -NoProfi '\n        - ' -NoProfil ' \n        - ' -nonin '\n        - ' -nonint '\n        - ' -noninte '\n        - ' -noninter '\n        - ' -nonintera '\n        - ' -noninterac '\n        - ' -noninteract '\n        - ' -noninteracti '\n        - ' -noninteractiv '\n        - ' -ec '\n        - ' -encodedComman '\n        - ' -encodedComma '\n        - ' -encodedComm '\n        - ' -encodedCom '\n        - ' -encodedCo '\n        - ' -encodedC '\n        - ' -encoded '\n        - ' -encode '\n        - ' -encod '\n        - ' -enco '\n        - ' -en '\n    condition: all of them\nfalsepositives:\n    - Penetration tests\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_powershell_suspicious_parameter_variation.yml","hash":"30d0ceb83e984a13306ae22882261ca13766a5bf395511bcff7232769542d8b5","author_keyword":"Florian Roth (rule), Daniel Bohannon (idea)","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"AVbKm2YByorp5hYiaP39","_score":1,"_source":{"status":"stable","category":15,"updated":"2018-10-22T12:40:25.594686","user_id":null,"author":"Nik Seetharaman","title":"CMSTP UAC Bypass via COM Object Access","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"CMSTP UAC Bypass via COM Object Access","released":"2018-10-22T12:40:25.594684","sigma_text":"title: CMSTP UAC Bypass via COM Object Access\nstatus: stable\ndescription: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.execution\n    - attack.t1088\n    - attack.t1191\n    - attack.g0069\nauthor: Nik Seetharaman\nreferences:\n    - http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\n    - https://twitter.com/hFireF0X/status/897640081053364225\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # CMSTP Spawning Child Process\n    selection1:\n        EventID: 1\n        ParentCommandLine: '*\\DllHost.exe'\n    selection2:\n        ParentCommandLine:\n            - '*\\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}' #CMSTPLUA\n            - '*\\{3E000D72-A845-4CD9-BD83-80C07C3B881F}' #CMLUAUTIL, see https://twitter.com/hFireF0X/status/897640081053364225\n    condition: selection1 and selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - Hashes\nfalsepositives:\n    - Legitimate CMSTP use (unlikely in modern enterprise environments)\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_cmstp_com_object_access.yml","hash":"7ca6945fb820232a4c5bf3ac024a690e2b79f1aaf878cf09ea553f5419db04ee","author_keyword":"Nik Seetharaman","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"BFbKm2YByorp5hYiaf0f","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.627889","user_id":null,"author":"Florian Roth","title":"Command Line Execution with suspicious URL and AppData Strings","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Command Line Execution with suspicious URL and AppData Strings","released":"2018-10-22T12:40:25.627887","sigma_text":"title: Command Line Execution with suspicious URL and AppData Strings\nstatus: experimental\ndescription: Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)\nreferences:\n    - 'https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100'\n    - 'https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100'\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: \n            - 'cmd.exe /c *http://*%AppData%'\n            - 'cmd.exe /c *https://*%AppData%'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - High\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_susp_cmd_http_appdata.yml","hash":"ee8980e63cc6f6e36a6c38ce73331635fb8f20cf6f436cf21155274a44d423f1","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"BVbKm2YByorp5hYiaf01","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.652256","user_id":null,"author":"Florian Roth","title":"Suspicious Typical Malware Back Connect Ports","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Suspicious Typical Malware Back Connect Ports","released":"2018-10-22T12:40:25.652253","sigma_text":"title: Suspicious Typical Malware Back Connect Ports\nstatus: experimental\ndescription: Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\nauthor: Florian Roth\ndate: 2017/03/19\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 3\n        DestinationPort:\n            - '4443'\n            - '2448'\n            - '8143'\n            - '1777'\n            - '1443'\n            - '243'\n            - '65535'\n            - '13506'\n            - '3360'\n            - '200'\n            - '198'\n            - '49180'\n            - '13507'\n            - '6625'\n            - '4444'\n            - '4438'\n            - '1904'\n            - '13505'\n            - '13504'\n            - '12102'\n            - '9631'\n            - '5445'\n            - '2443'\n            - '777'\n            - '13394'\n            - '13145'\n            - '12103'\n            - '5552'\n            - '3939'\n            - '3675'\n            - '666'\n            - '473'\n            - '5649'\n            - '4455'\n            - '4433'\n            - '1817'\n            - '100'\n            - '65520'\n            - '1960'\n            - '1515'\n            - '743'\n            - '700'\n            - '14154'\n            - '14103'\n            - '14102'\n            - '12322'\n            - '10101'\n            - '7210'\n            - '4040'\n            - '9943'\n    filter:\n        Image: '*\\Program Files*'\n    condition: selection and not filter\nfalsepositives:\n    - unknown\nlevel: medium\n","git_filepath":"/windows/sysmon/sysmon_malware_backconnect_ports.yml","hash":"daea254d2275937768c289e31eb85c788b93f9c856a9071215143bbe1c1bafeb","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"BlbKm2YByorp5hYiaf2H","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.733539","user_id":null,"author":"Markus Neis","title":"Detection of SafetyKatz","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Detection of SafetyKatz","released":"2018-10-22T12:40:25.733537","sigma_text":"title: Detection of SafetyKatz\nstatus: experimental\ndescription: Detects possible SafetyKatz Behaviour\nreferences:\n    - https://github.com/GhostPack/SafetyKatz\ntags:\n    - attack.credential_access\n    - attack.T1003\nauthor: Markus Neis\ndate: 2018/24/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename: '*\\Temp\\debug.bin'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_ghostpack_safetykatz.yml","hash":"632cc6a6ae2a73366009b09bf265437766004343c46cfcd0c6b444d9c09406f1","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"CVbKm2YByorp5hYiaf25","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.783700","user_id":null,"author":"Florian Roth","title":"Executable used by PlugX in Uncommon Location","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Executable used by PlugX in Uncommon Location","released":"2018-10-22T12:40:25.783698","sigma_text":"title: Executable used by PlugX in Uncommon Location\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - 'http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/'\n    - 'https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/'\nauthor: Florian Roth\ndate: 2017/06/12\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # CamMute\n    selection_cammute:\n        EventID: 1\n        Image: '*\\CamMute.exe'\n    filter_cammute:\n        EventID: 1\n        Image: '*\\Lenovo\\Communication Utility\\*'\n    # Chrome Frame Helper\n    selection_chrome_frame:\n        EventID: 1\n        Image: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        EventID: 1\n        Image: '*\\Google\\Chrome\\application\\*'    \n    # Microsoft Device Emulator\n    selection_devemu:\n        EventID: 1\n        Image: '*\\dvcemumanager.exe'\n    filter_devemu:\n        EventID: 1\n        Image: '*\\Microsoft Device Emulator\\*'   \n    # Windows Media Player Gadget\n    selection_gadget:\n        EventID: 1\n        Image: '*\\Gadget.exe'\n    filter_gadget:\n        EventID: 1\n        Image: '*\\Windows Media Player\\*'\n    # HTML Help Workshop\n    selection_hcc:\n        EventID: 1\n        Image: '*\\hcc.exe'\n    filter_hcc:\n        EventID: 1\n        Image: '*\\HTML Help Workshop\\*'\n    # Hotkey Command Module for Intel Graphics Contollers\n    selection_hkcmd:\n        EventID: 1\n        Image: '*\\hkcmd.exe'\n    filter_hkcmd:\n        EventID: 1\n        Image: \n            - '*\\System32\\*'\n            - '*\\SysNative\\*'\n            - '*\\SysWowo64\\*'\n    # McAfee component\n    selection_mc:\n        EventID: 1\n        Image: '*\\Mc.exe'\n    filter_mc:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    # MsMpEng - Microsoft Malware Protection Engine\n    selection_msmpeng:\n        EventID: 1\n        Image: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Security Client\\*'\n            - '*\\Windows Defender\\*'\n            - '*\\AntiMalware\\*'\n    # Microsoft Security Center\n    selection_msseces:\n        EventID: 1\n        Image: '*\\msseces.exe'\n    filter_msseces:\n        EventID: 1\n        Image: '*\\Microsoft Security Center\\*'\n    # Microsoft Office 2003 OInfo\n    selection_oinfo:\n        EventID: 1\n        Image: '*\\OInfoP11.exe'\n    filter_oinfo:\n        EventID: 1\n        Image: '*\\Common Files\\Microsoft Shared\\*'      \n    # OLE View\n    selection_oleview:\n        EventID: 1\n        Image: '*\\OleView.exe'\n    filter_oleview:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n    # RC\n    selection_rc:\n        EventID: 1\n        Image: '*\\OleView.exe'\n    filter_rc:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n            - '*\\Microsoft.NET\\*'  \n    condition: ( selection_cammute and not filter_cammute ) or  \n                ( selection_chrome_frame and not filter_chrome_frame ) or\n                ( selection_devemu and not filter_devemu ) or\n                ( selection_gadget and not filter_gadget ) or \n                ( selection_hcc and not filter_hcc ) or \n                ( selection_hkcmd and not filter_hkcmd ) or \n                ( selection_mc and not filter_mc ) or\n                ( selection_msmpeng and not filter_msmpeng ) or\n                ( selection_msseces and not filter_msseces ) or\n                ( selection_oinfo and not filter_oinfo ) or \n                ( selection_oleview and not filter_oleview ) or \n                ( selection_rc and not filter_rc ) \nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/windows/sysmon/sysmon_plugx_susp_exe_locations.yml","hash":"84336fd7c6949020d5f9451f71ae9a0665a42aa8d5b83a25ef8d01c0edb43555","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"C1bKm2YByorp5hYiaf3R","_score":1,"_source":{"status":"","category":15,"updated":"2018-10-22T12:40:25.808013","user_id":null,"author":"Florian Roth, @twjackomo","title":"Sticky Key Like Backdoor Usage","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Sticky Key Like Backdoor Usage","released":"2018-10-22T12:40:25.808010","sigma_text":"title: Sticky Key Like Backdoor Usage\ndescription: Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen\nreferences:\n    - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1015\nauthor: Florian Roth, @twjackomo\ndate: 2018/03/15\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_process:\n        EventID: 1\n        ParentImage:\n            - '*\\winlogon.exe'\n        CommandLine:\n            - '*\\cmd.exe sethc.exe *'\n            - '*\\cmd.exe utilman.exe *'\n            - '*\\cmd.exe osk.exe *'\n            - '*\\cmd.exe Magnify.exe *'\n            - '*\\cmd.exe Narrator.exe *'\n            - '*\\cmd.exe DisplaySwitch.exe *'\n    selection_registry:\n        EventID: 13\n        TargetObject: \n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger'\n        EventType: 'SetValue'\n    condition: 1 of them\nfalsepositives:\n    - Unlikely\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_stickykey_like_backdoor.yml","hash":"248c5de0514de592fa089c6583ea193867c04522de1d1309750278ff0f2e0644","author_keyword":"Florian Roth, @twjackomo","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"D1bKm2YByorp5hYiav0C","_score":1,"_source":{"status":"experimental","category":15,"updated":"2018-10-22T12:40:25.856374","user_id":null,"author":"Florian Roth","title":"UAC Bypass via Event Viewer","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"UAC Bypass via Event Viewer","released":"2018-10-22T12:40:25.856371","sigma_text":"title: UAC Bypass via Event Viewer\nstatus: experimental\ndescription: Detects UAC bypass method using Windows event viewer\nreferences:\n    - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\n    - https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    methregistry:\n        EventID: 13\n        TargetObject: 'HKEY_USERS\\*\\mscfile\\shell\\open\\command'\n    methprocess:\n        EventID: 1\n        ParentImage: '*\\eventvwr.exe'\n    filterprocess:\n        Image: '*\\mmc.exe'\n    condition: methregistry or ( methprocess and not filterprocess )\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1088\nfalsepositives:\n    - unknown\nlevel: critical\n","git_filepath":"/windows/sysmon/sysmon_uac_bypass_eventvwr.yml","hash":"5d8d20c1ab984d76ae61dc3711243d4731dda8d83f794f981b82eaf484d62b62","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"FlbKm2YByorp5hYia_2r","_score":1,"_source":{"status":"experimental","category":9,"updated":"2018-10-22T12:40:26.281865","user_id":null,"author":"Florian Roth","title":"Detects Suspicious Commands on Linux systems","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Detects Suspicious Commands on Linux systems","released":"2018-10-22T12:40:26.281863","sigma_text":"title: Detects Suspicious Commands on Linux systems\nstatus: experimental\ndescription: Detects relevant commands often related to malware or hacking activity\nreferences:\n    - 'Internal Research - mostly derived from exploit code including code in MSF'\ndate: 2017/12/12\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    cmds:\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: '777'\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: 'u+s'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/ksh'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/sh'\n    condition: 1 of cmds\nfalsepositives:\n    - Admin activity\nlevel: medium","git_filepath":"/linux/auditd/lnx_auditd_susp_cmds.yml","hash":"49a979f8fb5a88e134325306b4f619db31c33eeb987815b3372e55fc71b18d1b","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"GlbKm2YByorp5hYia_3V","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.324277","user_id":null,"author":null,"title":"Shellshock Expression","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Shellshock Expression","released":"2018-10-22T12:40:26.324275","sigma_text":"title: Shellshock Expression\ndescription: Detects shellshock expressions in log files\nreferences:\n    - http://rubular.com/r/zxBfjWfFYs\nlogsource:\n    product: linux\ndetection:\n    expression:\n        - /\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/\n    condition: expression\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/linux/lnx_shellshock.yml","hash":"c5635163777ca02f1c3ebf0f4dd838ed6bbd9993a7fb21223705d06f48ac7527","author_keyword":null,"is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"G1bKm2YByorp5hYia_3c","_score":1,"_source":{"status":"","category":3,"updated":"2018-10-22T12:40:26.331290","user_id":null,"author":"Florian Roth","title":"SSHD Error Message CVE-2018-15473","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"SSHD Error Message CVE-2018-15473","released":"2018-10-22T12:40:26.331287","sigma_text":"title: SSHD Error Message CVE-2018-15473\ndescription: Detects exploitation attempt using public exploit code for CVE-2018-15473\nreferences:\n    - https://github.com/Rhynorater/CVE-2018-15473-Exploit\nauthor: Florian Roth\ndate: 2017/08/24\nlogsource:\n    product: linux\n    service: sshd\ndetection:\n    keywords:\n        - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n","git_filepath":"/linux/lnx_ssh_cve_2018_15473.yml","hash":"3fd8340bf447828cea089da87a1137d60ed0257a2f864349430695ac192afa22","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"IlbKm2YByorp5hYibP0c","_score":1,"_source":{"status":"","category":1,"updated":"2018-10-22T12:40:26.395357","user_id":null,"author":"Thomas Patzke","title":"Python SQL Exceptions","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Python SQL Exceptions","released":"2018-10-22T12:40:26.395354","sigma_text":"title: Python SQL Exceptions\ndescription: Generic rule for SQL exceptions in Python according to PEP 249\nauthor: Thomas Patzke\nreferences:\n    - https://www.python.org/dev/peps/pep-0249/#exceptions\nlogsource:\n    category: application\n    product: python\ndetection:\n    exceptions:\n        - DataError\n        - IntegrityError\n        - ProgrammingError\n        - OperationalError\n    condition: exceptions\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n","git_filepath":"/application/app_python_sql_exceptions.yml","hash":"728818f710d6f0a4e5639fa6e9fa8a238157a574f63bb9ce1dcb502b30d5575b","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"JFbKm2YByorp5hYibP0s","_score":1,"_source":{"status":"","category":1,"updated":"2018-10-22T12:40:26.411533","user_id":null,"author":"Thomas Patzke","title":"Spring framework exceptions","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Spring framework exceptions","released":"2018-10-22T12:40:26.411530","sigma_text":"title: Spring framework exceptions\ndescription: Detects suspicious Spring framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html\nlogsource:\n    category: application\n    product: spring\ndetection:\n    keywords:\n        - AccessDeniedException\n        - CsrfException\n        - InvalidCsrfTokenException\n        - MissingCsrfTokenException\n        - CookieTheftException\n        - InvalidCookieException\n        - RequestRejectedException\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n","git_filepath":"/application/appframework_spring_exceptions.yml","hash":"19d5740e125674961f46163228bfc8c942ea9e6280f3975adc8459c7406284ce","author_keyword":"Thomas Patzke","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"JlbKm2YByorp5hYibP1B","_score":1,"_source":{"status":"experimental","category":1,"updated":"2018-10-22T12:40:26.432238","user_id":null,"author":"Bjoern Kimminich","title":"Suspicious SQL Error Messages","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Suspicious SQL Error Messages","released":"2018-10-22T12:40:26.432235","sigma_text":"title: Suspicious SQL Error Messages\nstatus: experimental\ndescription: Detects SQL error messages that indicate probing for an injection attack\nauthor: Bjoern Kimminich\nreferences:\n    - http://www.sqlinjection.net/errors\nlogsource:\n    category: application\n    product: sql\ndetection:\n    keywords:\n        # Oracle\n        - quoted string not properly terminated\n        # MySQL\n        - You have an error in your SQL syntax\n        # SQL Server\n        - Unclosed quotation mark\n        # SQLite\n        - 'near \"*\": syntax error'\n        - SELECTs to the left and right of UNION do not have the same number of result columns\n    condition: keywords\nfalsepositives:\n    - Application bugs\nlevel: high\n","git_filepath":"/application/app_sqlinjection_errors.yml","hash":"3bce53860ef6c21e6ee41c60c8935ea2a193a43bd96d14d9bd3ffd9f5c628dd9","author_keyword":"Bjoern Kimminich","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"KVbKm2YByorp5hYibP1Z","_score":1,"_source":{"status":"experimental","category":4,"updated":"2018-10-22T12:40:26.456311","user_id":null,"author":"Florian Roth","title":"Cobalt Strike DNS Beaconing","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Cobalt Strike DNS Beaconing","released":"2018-10-22T12:40:26.456308","sigma_text":"title: Cobalt Strike DNS Beaconing\nstatus: experimental\ndescription: Detects suspicious DNS queries known from Cobalt Strike beacons\nreferences:\n    - https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns\nauthor: Florian Roth\ndate: 2018/05/10\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - 'aaa.stage.*' \n            - 'post.1*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/network/net_mal_dns_cobaltstrike.yml","hash":"bfa739b787efbac5537f2383772dcac6a9edfd4be171c812aa6a8defb8e21def","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"KlbKm2YByorp5hYibP1j","_score":1,"_source":{"status":"experimental","category":4,"updated":"2018-10-22T12:40:26.466590","user_id":null,"author":"Markus Neis","title":"DNS TXT Answer with possible execution strings","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"DNS TXT Answer with possible execution strings","released":"2018-10-22T12:40:26.466587","sigma_text":"title: DNS TXT Answer with possible execution strings    \nstatus: experimental\ndescription: Detects strings used in command execution in DNS TXT Answer \nreferences:\n    - https://twitter.com/stvemillertime/status/1024707932447854592\n    - https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1\ntags:\n    - attack.t1071\nauthor: Markus Neis\ndate: 2018/08/08\nlogsource:\n    category: dns\ndetection:\n    selection:\n        answer:\n            - '*IEX*'\n            - '*Invoke-Expression*'\n            - '*cmd.exe*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/network/net_susp_dns_txt_exec_strings.yml","hash":"afb603ee20d60788d5b0f7eec68201f9c71e7ce6258125f93c9eb3dcefee5423","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"LVbKm2YByorp5hYibP26","_score":1,"_source":{"status":"experimental","category":2,"updated":"2018-10-22T12:40:26.496429","user_id":null,"author":"Florian Roth","title":"Elise Backdoor","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Elise Backdoor","released":"2018-10-22T12:40:26.496427","sigma_text":"title: Elise Backdoor\nstatus: experimental\ndescription: Detects Elise backdoor acitivty as used by APT32 \nreferences: \n    - https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting\ntags:\n    - attack.g0030\n    - attack.g0050\n    - attack.s0081\nauthor: Florian Roth\ndate: 2018/01/31\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image: 'C:\\Windows\\SysWOW64\\cmd.exe'\n        CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\n    selection2:\n        EventID: 1\n        CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n","git_filepath":"/apt/apt_elise.yml","hash":"02b03ffa716d3cce7b8a065fd850a5e8833f0069795a8ba9ead99ec1d07b79ca","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"LlbKm2YByorp5hYibP3J","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.568116","user_id":null,"author":"Florian Roth","title":"Equation Group C2 Communication","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Equation Group C2 Communication","released":"2018-10-22T12:40:26.568114","sigma_text":"title: Equation Group C2 Communication\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools\nreferences:\n    - 'https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation'\n    - 'https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195'\ntags:\n    - attack.command_and_control\n    - attack.g0020\nauthor: Florian Roth\nlogsource:\n    category: firewall\ndetection:\n    outgoing:\n        dst_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    incoming:\n        src_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/apt/apt_equationgroup_c2.yml","hash":"5861e2f5877bd8e408d8de3eb709c06539cf63753a238a9447cea6896211437d","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"L1bKm2YByorp5hYibP3W","_score":1,"_source":{"status":"experimental","category":2,"updated":"2018-10-22T12:40:26.580783","user_id":null,"author":"Markus Neis","title":"Turla Group Named Pipes","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Turla Group Named Pipes","released":"2018-10-22T12:40:26.580781","sigma_text":"title: Turla Group Named Pipes \nstatus: experimental\ndescription: Detects a named pipe used by Turla group samples\nreferences:\n    - Internal Research\ndate: 2017/11/06\ntags:\n    - attack.g0010\nauthor: Markus Neis\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n    selection:\n        EventID: \n            - 17\n            - 18\n        PipeName: \n            - '\\atctl' # https://www.virustotal.com/#/file/a4ddb2664a6c87a1d3c5da5a5a32a5df9a0b0c8f2e951811bd1ec1d44d42ccf1/detection\n            - '\\userpipe' # ruag apt case\n            - '\\iehelper' # ruag apt case\n            - '\\sdlrpc' # project cobra https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            - '\\comnap' # https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            # - '\\rpc'  # may cause too many false positives : http://kb.palisade.com/index.php?pg=kb.page&id=483\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n","git_filepath":"/apt/apt_turla_namedpipes.yml","hash":"9a5f31d4764788fd85a41fe5bc64b7b2c97da59ad40bd3983857ed31ab2e0bd7","author_keyword":"Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"MVbKm2YByorp5hYibP30","_score":1,"_source":{"status":"","category":2,"updated":"2018-10-22T12:40:26.611047","user_id":null,"author":"Florian Roth","title":"Ps.exe Renamed SysInternals Tool","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Ps.exe Renamed SysInternals Tool","released":"2018-10-22T12:40:26.611044","sigma_text":"title: Ps.exe Renamed SysInternals Tool\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report\nreferences:\n    - https://www.us-cert.gov/ncas/alerts/TA17-293A\ntags:\n    - attack.defense_evasion\n    - attack.g0035\n    - attack.t1036\nauthor: Florian Roth\ndate: 2017/10/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: 'ps.exe -accepteula'\n    condition: selection\nfalsepositives:\n    - Renamed SysInternals tool\nlevel: high","git_filepath":"/apt/apt_ta17_293a_ps.yml","hash":"490aa039afb3ea27bfeb3a0520507d5311bcbc3fea9afa525636d2c1278014e5","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"NlbKm2YByorp5hYibf1H","_score":1,"_source":{"status":"experimental","category":2,"updated":"2018-10-22T12:40:26.691931","user_id":null,"author":"Florian Roth","title":"Pandemic Registry Key","permission_id":3,"level":"critical","mitre_attack":null,"title_keyword":"Pandemic Registry Key","released":"2018-10-22T12:40:26.691928","sigma_text":"title: Pandemic Registry Key\nstatus: experimental\ndescription: Detects Pandemic Windows Implant\nreferences:\n    - https://wikileaks.org/vault7/#Pandemic\n    - https://twitter.com/MalwareJake/status/870349480356454401\ntags:\n    - attack.lateral_movement\n    - attack.t1105\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 13\n        TargetObject: \n            - '\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet002\\services\\null\\Instance*'\n    selection2:\n        EventID: 1\n        Command: 'loaddll -a *'\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: critical\n","git_filepath":"/apt/apt_pandemic.yml","hash":"ff032d497af05df05df82071b5f5265826ca603fd91133110941b831a288c622","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"OlbKm2YByorp5hYibf1-","_score":1,"_source":{"status":"","category":6,"updated":"2018-10-22T12:40:26.749400","user_id":null,"author":"Florian Roth","title":"Apache Segmentation Fault","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Apache Segmentation Fault","released":"2018-10-22T12:40:26.749397","sigma_text":"title: Apache Segmentation Fault\ndescription: Detects a segmentation fault error message caused by a creashing apacke worker process \nauthor: Florian Roth\nreferences:\n    - http://www.securityfocus.com/infocus/1633\nlogsource:\n    product: apache\ndetection:\n    keywords:\n        - 'exit signal Segmentation Fault'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n","git_filepath":"/web/web_apache_segfault.yml","hash":"7b91b70b26a6849c372a058ffb811f124b545e6c2a150c32b4ba1633b221bff7","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"O1bKm2YByorp5hYibf2V","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.767875","user_id":null,"author":"Florian Roth, Markus Neis","title":"APT User Agent","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"APT User Agent","released":"2018-10-22T12:40:26.767873","sigma_text":"title: APT User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used in APT malware in proxy logs\r\nreferences:\r\n    - Internal Research\r\nauthor: Florian Roth, Markus Neis\r\nlogsource:\r\n    category: proxy\r\ndetection:\r\n    selection:\r\n      UserAgent:\r\n         # APT Related\r\n        - 'SJZJ (compatible; MSIE 6.0; Win32)'  # APT Backspace\r\n        - 'Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0'  # APT GrizzlySteppe - ChopStick - US CERT https://goo.gl/1DTHwi\r\n        - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC'  # Comment Crew Miniasp\r\n        - 'Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)'  # Comment Crew Miniasp\r\n        - 'webclient'  # Naikon APT\r\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200'  # Naikon APT\r\n        - 'Mozilla/4.0 (compatible; MSI 6.0;'  # SnowGlobe Babar - yes, it is cut\r\n        - 'Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0'  # Sofacy - Xtunnel\r\n        - 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/'  # Sofacy - Xtunnel\r\n        - 'Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2'  # Sofacy - Xtunnel\r\n        - 'Mozilla/4.0'  # Derusbi backdoor ELF https://github.com/fideliscyber/indicators/tree/master/FTA-1021\r\n        - 'Netscape'  # Unit78020 Malware \r\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7'  # Unit78020 Malware\r\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1'  # Winnti related\r\n        - 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)'  # Winnti related\r\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)'  # APT17\r\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)'  # Bronze Butler - Daserf\r\n        - 'Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)'  # Bronze Butler - Daserf\r\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Win32)'  # TSCookie https://app.any.run/tasks/0996b314-5133-491b-8d23-d431ffdec597\r\n        - 'Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1'  # Delphi downloader https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/\r\n        - 'Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)'  # VPNFilter https://blog.talosintelligence.com/2018/05/VPNFilter.html\r\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)'  # Sofacy User-Agent https://researchcenter.paloaltonetworks.com/2018/06/unit42-sofacy-groups-parallel-attacks/\r\n        - 'Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko'  # Sofacy User-Agent https://researchcenter.paloaltonetworks.com/2018/06/unit42-sofacy-groups-parallel-attacks/\r\n        - 'Mozilla v5.1 *'  # Sofacy Zebrocy samples \r\n        - 'MSIE 8.0'  # Sofacy Azzy Backdoor  from https://www.hybrid-analysis.com/sample/a80e29c0757bee05338fd5c22a542d852ad86c477068e3eb4aacc1c3e59e2eef?environmentId=100\r\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)'  # https://www.fireeye.com/blog/threat-research/2018/07/microsoft-office-vulnerabilities-used-to-distribute-felixroot-backdoor.html\r\n        - 'Mozilla/4.0 (compatible; RMS)'  # Attacks on industrial enterprises using RMS and TeamViewer https://goo.gl/GthvTw\r\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; DynGate)'  # Attacks on industrial enterprises using RMS and TeamViewer https://goo.gl/GthvTw\r\n        - 'O/9.27 (W; U; Z)' # Cmstar https://www.virustotal.com/#/file/e4328011bb2b04abc856ccd04404c9f95d67167f6c291d343e8ffa8aa2aa2099/details\r\n    condition: selection\r\nfields:\r\n    - ClientIP\r\n    - URL\r\n    - UserAgent\r\nfalsepositives:\r\n    - Old browsers\r\nlevel: high\r\n","git_filepath":"/proxy/proxy_ua_apt.yml","hash":"877cf8f14ed59849cff353659f9da1567c4cb7242b0e7541ec30d7b0cef2d15c","author_keyword":"Florian Roth, Markus Neis","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"PFbKm2YByorp5hYibf22","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.804284","user_id":null,"author":"Florian Roth","title":"Telegram API Access","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Telegram API Access","released":"2018-10-22T12:40:26.804282","sigma_text":"title: Telegram API Access\nstatus: experimental\ndescription: Detects suspicious requests to Telegram API without the usual Telegram User-Agent\nreferences:\n    - https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/\n    - https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/\n    - https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\nauthor: Florian Roth\ndate: 2018/06/05\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        r-dns: \n            - 'api.telegram.org'  # Often used by Bots\n    filter:\n        UserAgent: \n            # Used https://core.telegram.org/bots/samples for this list\n            - '*Telegram*'\n            - '*Bot*'\n    condition: selection and not filter\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Legitimate use of Telegram bots in the company\nlevel: medium\n","git_filepath":"/proxy/proxy_telegram_api.yml","hash":"c00c5ed7cdaf2245efff82b3d35c6b487f6967fe5944c0210addbe8ba6be4657","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"QVbKm2YByorp5hYibv0l","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.915397","user_id":null,"author":"Florian Roth","title":"Download from Suspicious Dyndns Hosts","permission_id":3,"level":"medium","mitre_attack":null,"title_keyword":"Download from Suspicious Dyndns Hosts","released":"2018-10-22T12:40:26.915395","sigma_text":"title: Download from Suspicious Dyndns Hosts\nstatus: experimental\ndescription: Detects download of certain file types from hosts with dynamic DNS names (selected list)\nreferences:\n    - https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats\nauthor: Florian Roth\ndate: 2017/11/08\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n        r-dns: \n            - '*.hopto.org'\n            - '*.no-ip.org'\n            - '*.no-ip.info'\n            - '*.no-ip.biz'\n            - '*.no-ip.com'\n            - '*.noip.com'\n            - '*.ddns.name'\n            - '*.myftp.org'\n            - '*.myftp.biz'\n            - '*.serveblog.net'\n            - '*.servebeer.com'\n            - '*.servemp3.com'\n            - '*.serveftp.com'\n            - '*.servequake.com'\n            - '*.servehalflife.com'\n            - '*.servehttp.com'\n            - '*.servegame.com'\n            - '*.servepics.com'\n            - '*.myvnc.com'\n            - '*.ignorelist.com'\n            - '*.jkub.com'\n            - '*.dlinkddns.com'\n            - '*.jumpingcrab.com'\n            - '*.ddns.info'\n            - '*.mooo.com'\n            - '*.dns-dns.com'\n            - '*.strangled.net'\n            - '*.ddns.info'\n            - '*.adultdns.net'\n            - '*.craftx.biz'\n            - '*.ddns01.com'\n            - '*.dns53.biz'\n            - '*.dnsapi.info'\n            - '*.dnsd.info'\n            - '*.dnsdynamic.com'\n            - '*.dnsdynamic.net'\n            - '*.dnsget.org'\n            - '*.fe100.net'\n            - '*.flashserv.net'\n            - '*.ftp21.net'\n            - '*.http01.com'\n            - '*.http80.info'\n            - '*.https443.com'\n            - '*.imap01.com'\n            - '*.kadm5.com'\n            - '*.mysq1.net'\n            - '*.ns360.info'\n            - '*.ntdll.net'\n            - '*.ole32.com'\n            - '*.proxy8080.com'\n            - '*.sql01.com'\n            - '*.ssh01.com'\n            - '*.ssh22.net'\n            - '*.tempors.com'\n            - '*.tftpd.net'\n            - '*.ttl60.com'\n            - '*.ttl60.org'\n            - '*.user32.com'\n            - '*.voip01.com'\n            - '*.wow64.net'\n            - '*.x64.me'\n            - '*.xns01.com'\n            - '*.dyndns.org'\n            - '*.dyndns.info'\n            - '*.dyndns.tv'\n            - '*.dyndns-at-home.com'\n            - '*.dnsomatic.com'\n            - '*.zapto.org'\n            - '*.webhop.net'\n            - '*.25u.com'\n            - '*.slyip.net'\n    condition: selection\nfields:\n    - cs-ip\n    - c-uri\nfalsepositives:\n    - Software downloads\nlevel: medium\n","git_filepath":"/proxy/proxy_download_susp_dyndns.yml","hash":"e4e674fe909020b018905f25dc7fe6bf019671f1f20038d58262603fca06ce9f","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"QlbKm2YByorp5hYibv0x","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.928187","user_id":null,"author":"Florian Roth","title":"Flash Player Update from Suspicious Location","permission_id":3,"level":"high","mitre_attack":null,"title_keyword":"Flash Player Update from Suspicious Location","released":"2018-10-22T12:40:26.928184","sigma_text":"title: Flash Player Update from Suspicious Location\nstatus: experimental\ndescription: Detects a flashplayer update from an unofficial location\nreferences:\n    - https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        cs-uri-query: \n            - '*/install_flash_player.exe'\n            - '*/flash_install.php*'\n    filter:\n        cs-uri-stem: '*.adobe.com/*'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown flash download locations\nlevel: high\n","git_filepath":"/proxy/proxy_susp_flash_download_loc.yml","hash":"8f80936b7f02094773b05e42c852e283ae7abd2f2985e2b8460c657280ec8aec","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
{"_index":"sigma_doc_for_app","_type":"sigma_doc","_id":"Q1bKm2YByorp5hYibv1d","_score":1,"_source":{"status":"experimental","category":5,"updated":"2018-10-22T12:40:26.944374","user_id":null,"author":"Florian Roth","title":"Download from Suspicious TLD","permission_id":3,"level":"low","mitre_attack":null,"title_keyword":"Download from Suspicious TLD","released":"2018-10-22T12:40:26.944371","sigma_text":"title: Download from Suspicious TLD\nstatus: experimental\ndescription: Detects download of certain file types from hosts in suspicious TLDs \nreferences:\n    - https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\n    - https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\n    - https://www.spamhaus.org/statistics/tlds/\n    - https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\nauthor: Florian Roth\ndate: 2018/06/13\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n        r-dns: \n            # Symantec / Chris Larsen analysis \n            - '*.country'\n            - '*.stream'\n            - '*.gdn'\n            - '*.mom'\n            - '*.xin'\n            - '*.kim'\n            - '*.men'\n            - '*.loan'\n            - '*.download'\n            - '*.racing'\n            - '*.online'\n            - '*.science'\n            - '*.ren'\n            - '*.gb'\n            - '*.win'\n            - '*.top'\n            - '*.review'\n            - '*.vip'\n            - '*.party'\n            - '*.tech'\n            - '*.tech'\n            - '*.xyz'\n            - '*.date'\n            - '*.faith'\n            - '*.zip'\n            - '*.cricket'\n            - '*.space'\n            - '*.top'\n            # McAfee report \n            - '*.info'\n            - '*.vn'\n            - '*.cm'\n            - '*.am'\n            - '*.cc'\n            - '*.asia'\n            - '*.ws'\n            - '*.tk'\n            - '*.biz'\n            - '*.su'\n            - '*.st'\n            - '*.ro'\n            - '*.ge'\n            - '*.ms'\n            - '*.pk'\n            - '*.nu'\n            - '*.me'\n            - '*.ph'\n            - '*.to'\n            - '*.tt'\n            - '*.name'\n            - '*.tv'\n            - '*.kz'\n            - '*.tc'\n            - '*.mobi'\n            # Spamhaus\n            - '*.study'\n            - '*.click'\n            - '*.link'\n            - '*.trade'\n            - '*.accountant'\n            # Spamhaus 2018 https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\n            - '*.click'\n            - '*.cf'\n            - '*.gq'\n            - '*.ml'\n            - '*.ga'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\nfalsepositives:\n    - All kinds of software downloads\nlevel: low\n","git_filepath":"/proxy/proxy_download_susp_tlds_blacklist.yml","hash":"c3bb0facdbe8f521686905feda4529fb479e66dde03348238edc80270af00f0f","author_keyword":"Florian Roth","is_verified":false,"downloads":0}}
